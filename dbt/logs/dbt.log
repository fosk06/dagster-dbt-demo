[0m00:28:31.176806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105968f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105977fd0>]}


============================== 00:28:31.179723 | 33992a53-f94d-4532-b7a7-b42d8d132ce0 ==============================
[0m00:28:31.179723 [info ] [MainThread]: Running with dbt=1.9.8
[0m00:28:31.180033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/thomastrividic/code/python/jaffle-platform/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/thomastrividic/code/python/jaffle-platform/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:28:31.327153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33992a53-f94d-4532-b7a7-b42d8d132ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d4bd0>]}
[0m00:28:31.359957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33992a53-f94d-4532-b7a7-b42d8d132ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021eca10>]}
[0m00:28:31.362181 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:28:31.432276 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /Users/thomastrividic/code/python/jaffle-platform/dbt/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in /Users/thomastrividic/code/python/jaffle-platform/dbt/dbt_packages/dbt_utils
[0m00:28:31.432775 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.29471174, "process_in_blocks": "0", "process_kernel_time": 0.207898, "process_mem_max_rss": "113967104", "process_out_blocks": "0", "process_user_time": 0.724716}
[0m00:28:31.433004 [debug] [MainThread]: Command `dbt build` failed at 00:28:31.432961 after 0.30 seconds
[0m00:28:31.433191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105907a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105907010>]}
[0m00:28:31.433368 [debug] [MainThread]: Flushing usage events
[0m00:28:31.803837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:30:01.891934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abf650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b58410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b58f90>]}


============================== 00:30:01.895100 | 87b21482-9477-4ca0-8369-b7fdf117aa70 ==============================
[0m00:30:01.895100 [info ] [MainThread]: Running with dbt=1.9.8
[0m00:30:01.895448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/thomastrividic/code/python/jaffle-platform/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/thomastrividic/code/python/jaffle-platform/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:30:02.042942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87b21482-9477-4ca0-8369-b7fdf117aa70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101350950>]}
[0m00:30:02.076190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87b21482-9477-4ca0-8369-b7fdf117aa70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1013c4990>]}
[0m00:30:02.078525 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:30:02.148100 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /Users/thomastrividic/code/python/jaffle-platform/dbt/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in /Users/thomastrividic/code/python/jaffle-platform/dbt/dbt_packages/dbt_utils
[0m00:30:02.148644 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.29584926, "process_in_blocks": "0", "process_kernel_time": 0.212323, "process_mem_max_rss": "115556352", "process_out_blocks": "0", "process_user_time": 0.720628}
[0m00:30:02.148888 [debug] [MainThread]: Command `dbt build` failed at 00:30:02.148845 after 0.30 seconds
[0m00:30:02.149103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abf090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10030e290>]}
[0m00:30:02.149303 [debug] [MainThread]: Flushing usage events
[0m00:30:02.531101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:30:34.069685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090fda50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10912bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10912bfd0>]}


============================== 00:30:34.072273 | f57d0d40-5e2f-44c6-bf95-598ff140b936 ==============================
[0m00:30:34.072273 [info ] [MainThread]: Running with dbt=1.9.8
[0m00:30:34.072593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/thomastrividic/code/python/jaffle-platform/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/thomastrividic/code/python/jaffle-platform/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:30:34.136876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f57d0d40-5e2f-44c6-bf95-598ff140b936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090bd250>]}
[0m00:30:34.152821 [debug] [MainThread]: Set downloads directory='/var/folders/4w/b965jjwj76d_mr0rkk3hj8kh0000gn/T/dbt-downloads-mdqskdwc'
[0m00:30:34.153030 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:30:34.208477 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:30:34.208933 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:30:34.222680 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:30:34.224522 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m00:30:34.251038 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m00:30:34.252586 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:30:34.491344 [info ] [MainThread]: Installed from version 1.3.0
[0m00:30:34.491606 [info ] [MainThread]: Up to date!
[0m00:30:34.491824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f57d0d40-5e2f-44c6-bf95-598ff140b936', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f66d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078be7d0>]}
[0m00:30:34.492056 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m00:30:34.679083 [info ] [MainThread]: Installed from version 0.14.1
[0m00:30:34.679487 [info ] [MainThread]: Up to date!
[0m00:30:34.679744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f57d0d40-5e2f-44c6-bf95-598ff140b936', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f5d90>]}
[0m00:30:34.680034 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-audit-helper.git
[0m00:30:34.680372 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-audit-helper.git d2deb5a374e89fe013946935cf9d0236"
[0m00:30:35.309227 [debug] [MainThread]: STDOUT: "b''"
[0m00:30:35.309875 [debug] [MainThread]: STDERR: "b"Cloning into 'd2deb5a374e89fe013946935cf9d0236'...\n""
[0m00:30:35.310291 [debug] [MainThread]: Pulling new dependency d2deb5a374e89fe013946935cf9d0236.
[0m00:30:35.310498 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m00:30:35.325337 [debug] [MainThread]: STDOUT: "b'b8f3a3348ce0ff8afc3aa4b9ade2123b00772473\n'"
[0m00:30:35.325919 [debug] [MainThread]: STDERR: "b''"
[0m00:30:35.326224 [debug] [MainThread]: Checking out revision b8f3a3348ce0ff8afc3aa4b9ade2123b00772473.
[0m00:30:35.326440 [debug] [MainThread]: Executing "git fetch origin --depth 1 b8f3a3348ce0ff8afc3aa4b9ade2123b00772473"
[0m00:30:35.803390 [debug] [MainThread]: STDOUT: "b''"
[0m00:30:35.804464 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-audit-helper\n * branch            b8f3a3348ce0ff8afc3aa4b9ade2123b00772473 -> FETCH_HEAD\n'"
[0m00:30:35.804818 [debug] [MainThread]: Executing "git reset --hard b8f3a3348ce0ff8afc3aa4b9ade2123b00772473"
[0m00:30:35.833712 [debug] [MainThread]: STDOUT: "b'HEAD is now at b8f3a33 Correct `quick_are_queries_identical` code example (#115)\n'"
[0m00:30:35.834298 [debug] [MainThread]: STDERR: "b''"
[0m00:30:35.834525 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m00:30:35.848089 [debug] [MainThread]: STDOUT: "b'b8f3a3348ce0ff8afc3aa4b9ade2123b00772473\n'"
[0m00:30:35.848585 [debug] [MainThread]: STDERR: "b''"
[0m00:30:35.848800 [debug] [MainThread]: Checked out at b8f3a33.
[0m00:30:35.849123 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m00:30:35.862230 [debug] [MainThread]: STDOUT: "b'b8f3a3348ce0ff8afc3aa4b9ade2123b00772473\n'"
[0m00:30:35.862693 [debug] [MainThread]: STDERR: "b''"
[0m00:30:35.864344 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-audit-helper.git d2deb5a374e89fe013946935cf9d0236"
[0m00:30:35.876949 [debug] [MainThread]: STDOUT: "b''"
[0m00:30:35.877500 [debug] [MainThread]: STDERR: "b"fatal: destination path 'd2deb5a374e89fe013946935cf9d0236' already exists and is not an empty directory.\n""
[0m00:30:35.877667 [debug] [MainThread]: command return code=128
[0m00:30:35.878881 [debug] [MainThread]: Updating existing dependency d2deb5a374e89fe013946935cf9d0236.
[0m00:30:35.879064 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m00:30:35.892717 [debug] [MainThread]: STDOUT: "b'b8f3a3348ce0ff8afc3aa4b9ade2123b00772473\n'"
[0m00:30:35.893167 [debug] [MainThread]: STDERR: "b''"
[0m00:30:35.893345 [debug] [MainThread]: Checking out revision b8f3a3348ce0ff8afc3aa4b9ade2123b00772473.
[0m00:30:35.893507 [debug] [MainThread]: Executing "git fetch origin --depth 1 b8f3a3348ce0ff8afc3aa4b9ade2123b00772473"
[0m00:30:36.349665 [debug] [MainThread]: STDOUT: "b''"
[0m00:30:36.350705 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-audit-helper\n * branch            b8f3a3348ce0ff8afc3aa4b9ade2123b00772473 -> FETCH_HEAD\n'"
[0m00:30:36.351047 [debug] [MainThread]: Executing "git reset --hard b8f3a3348ce0ff8afc3aa4b9ade2123b00772473"
[0m00:30:36.379784 [debug] [MainThread]: STDOUT: "b'HEAD is now at b8f3a33 Correct `quick_are_queries_identical` code example (#115)\n'"
[0m00:30:36.380356 [debug] [MainThread]: STDERR: "b''"
[0m00:30:36.380555 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m00:30:36.393659 [debug] [MainThread]: STDOUT: "b'b8f3a3348ce0ff8afc3aa4b9ade2123b00772473\n'"
[0m00:30:36.394126 [debug] [MainThread]: STDERR: "b''"
[0m00:30:36.394308 [debug] [MainThread]: Already at b8f3a33, nothing to do.
[0m00:30:36.394628 [info ] [MainThread]: Installed from revision b8f3a3348ce0ff8afc3aa4b9ade2123b00772473
[0m00:30:36.394977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f57d0d40-5e2f-44c6-bf95-598ff140b936', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109462050>]}
[0m00:30:36.396007 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.3638237, "process_in_blocks": "0", "process_kernel_time": 0.256498, "process_mem_max_rss": "109576192", "process_out_blocks": "0", "process_user_time": 0.685433}
[0m00:30:36.396288 [debug] [MainThread]: Command `dbt deps` succeeded at 00:30:36.396225 after 2.36 seconds
[0m00:30:36.396541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bfa1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d64290>]}
[0m00:30:36.396714 [debug] [MainThread]: Flushing usage events
[0m00:30:36.721876 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:01.856692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c27d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652bfd0>]}


============================== 00:31:01.859315 | fdb56134-c963-4986-885e-2ec27c16fb60 ==============================
[0m00:31:01.859315 [info ] [MainThread]: Running with dbt=1.9.8
[0m00:31:01.859617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/thomastrividic/code/python/jaffle-platform/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/thomastrividic/code/python/jaffle-platform/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:31:01.922264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdb56134-c963-4986-885e-2ec27c16fb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a9c90>]}
[0m00:31:01.960943 [debug] [MainThread]: Set downloads directory='/var/folders/4w/b965jjwj76d_mr0rkk3hj8kh0000gn/T/dbt-downloads-90vmzncf'
[0m00:31:01.961207 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:31:01.979752 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:31:01.980155 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:31:02.107362 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:31:02.110331 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m00:31:02.124958 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m00:31:02.126994 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:31:02.343825 [info ] [MainThread]: Installed from version 1.3.0
[0m00:31:02.344120 [info ] [MainThread]: Up to date!
[0m00:31:02.344343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fdb56134-c963-4986-885e-2ec27c16fb60', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbe7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e0f450>]}
[0m00:31:02.344586 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m00:31:02.525026 [info ] [MainThread]: Installed from version 0.14.1
[0m00:31:02.525428 [info ] [MainThread]: Up to date!
[0m00:31:02.525669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fdb56134-c963-4986-885e-2ec27c16fb60', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10658a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e0d8d0>]}
[0m00:31:02.525919 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-audit-helper.git
[0m00:31:02.526199 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-audit-helper.git d2deb5a374e89fe013946935cf9d0236"
[0m00:31:03.178865 [debug] [MainThread]: STDOUT: "b''"
[0m00:31:03.179580 [debug] [MainThread]: STDERR: "b"Cloning into 'd2deb5a374e89fe013946935cf9d0236'...\n""
[0m00:31:03.180061 [debug] [MainThread]: Pulling new dependency d2deb5a374e89fe013946935cf9d0236.
[0m00:31:03.180499 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m00:31:03.196065 [debug] [MainThread]: STDOUT: "b'b8f3a3348ce0ff8afc3aa4b9ade2123b00772473\n'"
[0m00:31:03.196562 [debug] [MainThread]: STDERR: "b''"
[0m00:31:03.196789 [debug] [MainThread]: Checking out revision b8f3a3348ce0ff8afc3aa4b9ade2123b00772473.
[0m00:31:03.197010 [debug] [MainThread]: Executing "git fetch origin --depth 1 b8f3a3348ce0ff8afc3aa4b9ade2123b00772473"
[0m00:31:03.669590 [debug] [MainThread]: STDOUT: "b''"
[0m00:31:03.670353 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-audit-helper\n * branch            b8f3a3348ce0ff8afc3aa4b9ade2123b00772473 -> FETCH_HEAD\n'"
[0m00:31:03.670671 [debug] [MainThread]: Executing "git reset --hard b8f3a3348ce0ff8afc3aa4b9ade2123b00772473"
[0m00:31:03.699057 [debug] [MainThread]: STDOUT: "b'HEAD is now at b8f3a33 Correct `quick_are_queries_identical` code example (#115)\n'"
[0m00:31:03.699611 [debug] [MainThread]: STDERR: "b''"
[0m00:31:03.699841 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m00:31:03.713495 [debug] [MainThread]: STDOUT: "b'b8f3a3348ce0ff8afc3aa4b9ade2123b00772473\n'"
[0m00:31:03.713972 [debug] [MainThread]: STDERR: "b''"
[0m00:31:03.714195 [debug] [MainThread]: Checked out at b8f3a33.
[0m00:31:03.714374 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m00:31:03.726633 [debug] [MainThread]: STDOUT: "b'b8f3a3348ce0ff8afc3aa4b9ade2123b00772473\n'"
[0m00:31:03.727090 [debug] [MainThread]: STDERR: "b''"
[0m00:31:03.729017 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-audit-helper.git d2deb5a374e89fe013946935cf9d0236"
[0m00:31:03.741663 [debug] [MainThread]: STDOUT: "b''"
[0m00:31:03.742070 [debug] [MainThread]: STDERR: "b"fatal: destination path 'd2deb5a374e89fe013946935cf9d0236' already exists and is not an empty directory.\n""
[0m00:31:03.742204 [debug] [MainThread]: command return code=128
[0m00:31:03.742662 [debug] [MainThread]: Updating existing dependency d2deb5a374e89fe013946935cf9d0236.
[0m00:31:03.742812 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m00:31:03.753399 [debug] [MainThread]: STDOUT: "b'b8f3a3348ce0ff8afc3aa4b9ade2123b00772473\n'"
[0m00:31:03.753746 [debug] [MainThread]: STDERR: "b''"
[0m00:31:03.753897 [debug] [MainThread]: Checking out revision b8f3a3348ce0ff8afc3aa4b9ade2123b00772473.
[0m00:31:03.754030 [debug] [MainThread]: Executing "git fetch origin --depth 1 b8f3a3348ce0ff8afc3aa4b9ade2123b00772473"
[0m00:31:04.201956 [debug] [MainThread]: STDOUT: "b''"
[0m00:31:04.202837 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-audit-helper\n * branch            b8f3a3348ce0ff8afc3aa4b9ade2123b00772473 -> FETCH_HEAD\n'"
[0m00:31:04.203140 [debug] [MainThread]: Executing "git reset --hard b8f3a3348ce0ff8afc3aa4b9ade2123b00772473"
[0m00:31:04.228012 [debug] [MainThread]: STDOUT: "b'HEAD is now at b8f3a33 Correct `quick_are_queries_identical` code example (#115)\n'"
[0m00:31:04.228458 [debug] [MainThread]: STDERR: "b''"
[0m00:31:04.228645 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m00:31:04.241348 [debug] [MainThread]: STDOUT: "b'b8f3a3348ce0ff8afc3aa4b9ade2123b00772473\n'"
[0m00:31:04.241733 [debug] [MainThread]: STDERR: "b''"
[0m00:31:04.241920 [debug] [MainThread]: Already at b8f3a33, nothing to do.
[0m00:31:04.242249 [info ] [MainThread]: Installed from revision b8f3a3348ce0ff8afc3aa4b9ade2123b00772473
[0m00:31:04.242616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fdb56134-c963-4986-885e-2ec27c16fb60', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106763310>]}
[0m00:31:04.243639 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.4242065, "process_in_blocks": "0", "process_kernel_time": 0.267072, "process_mem_max_rss": "109527040", "process_out_blocks": "0", "process_user_time": 0.687187}
[0m00:31:04.243904 [debug] [MainThread]: Command `dbt deps` succeeded at 00:31:04.243848 after 2.42 seconds
[0m00:31:04.244144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008da450>]}
[0m00:31:04.244320 [debug] [MainThread]: Flushing usage events
[0m00:31:04.570528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:07.481261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f14210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa8ed0>]}


============================== 00:31:07.484140 | 4b4c09fe-f0c2-47a7-a9a1-3d30f6984019 ==============================
[0m00:31:07.484140 [info ] [MainThread]: Running with dbt=1.9.8
[0m00:31:07.484469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/thomastrividic/code/python/jaffle-platform/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/thomastrividic/code/python/jaffle-platform/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m00:31:07.613227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fef350>]}
[0m00:31:07.646143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1018b08d0>]}
[0m00:31:07.649208 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:31:07.724425 [debug] [MainThread]: checksum: 2898e47e730fa32147e5ae95c02f42c1d51b8fd2b81922b9b731f0208caf4dff, vars: {}, profile: , target: , version: 1.9.8
[0m00:31:07.725011 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:31:07.725265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff1e10>]}
[0m00:31:08.600090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10585ba90>]}
[0m00:31:08.646718 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/thomastrividic/code/python/jaffle-platform/dbt/target/manifest.json
[0m00:31:08.648113 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/thomastrividic/code/python/jaffle-platform/dbt/target/semantic_manifest.json
[0m00:31:08.667289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f67d0>]}
[0m00:31:08.667550 [info ] [MainThread]: Found 11 models, 85 data tests, 6 sources, 736 macros
[0m00:31:08.670401 [info ] [MainThread]: 
[0m00:31:08.670586 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:31:08.670716 [info ] [MainThread]: 
[0m00:31:08.670928 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:31:08.673095 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_platform'
[0m00:31:08.724813 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_platform"
[0m00:31:08.725129 [debug] [ThreadPool]: On list_jaffle_platform: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "connection_name": "list_jaffle_platform"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_platform"'
    
  
  
[0m00:31:08.725360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:08.796196 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m00:31:08.797351 [debug] [ThreadPool]: On list_jaffle_platform: Close
[0m00:31:08.797711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_platform, now create_jaffle_platform_main)
[0m00:31:08.798107 [debug] [ThreadPool]: Creating schema "database: "jaffle_platform"
schema: "main"
"
[0m00:31:08.801422 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_platform_main"
[0m00:31:08.801594 [debug] [ThreadPool]: On create_jaffle_platform_main: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "connection_name": "create_jaffle_platform_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_platform'
        and type='sqlite'
    
  
[0m00:31:08.801726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:08.802516 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:31:08.803201 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_platform_main"
[0m00:31:08.803340 [debug] [ThreadPool]: On create_jaffle_platform_main: BEGIN
[0m00:31:08.803530 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:31:08.803643 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_platform_main"
[0m00:31:08.803760 [debug] [ThreadPool]: On create_jaffle_platform_main: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "connection_name": "create_jaffle_platform_main"} */

    
    
        create schema if not exists "jaffle_platform"."main"
    
[0m00:31:08.804302 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:31:08.804616 [debug] [ThreadPool]: On create_jaffle_platform_main: COMMIT
[0m00:31:08.804744 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_platform_main"
[0m00:31:08.804860 [debug] [ThreadPool]: On create_jaffle_platform_main: COMMIT
[0m00:31:08.805034 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:31:08.805152 [debug] [ThreadPool]: On create_jaffle_platform_main: Close
[0m00:31:08.805884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_platform_main, now list_jaffle_platform_main)
[0m00:31:08.808220 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_platform_main"
[0m00:31:08.808369 [debug] [ThreadPool]: On list_jaffle_platform_main: BEGIN
[0m00:31:08.808489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:08.808694 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:31:08.808812 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_platform_main"
[0m00:31:08.808938 [debug] [ThreadPool]: On list_jaffle_platform_main: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "connection_name": "list_jaffle_platform_main"} */
select
      'jaffle_platform' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_platform'
  
[0m00:31:08.818038 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m00:31:08.818805 [debug] [ThreadPool]: On list_jaffle_platform_main: ROLLBACK
[0m00:31:08.819472 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_platform_main'
[0m00:31:08.819623 [debug] [ThreadPool]: On list_jaffle_platform_main: Close
[0m00:31:08.820794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b8c90>]}
[0m00:31:08.821043 [debug] [MainThread]: Using duckdb connection "master"
[0m00:31:08.821171 [debug] [MainThread]: On master: BEGIN
[0m00:31:08.821283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:08.821495 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:31:08.821614 [debug] [MainThread]: On master: COMMIT
[0m00:31:08.821727 [debug] [MainThread]: Using duckdb connection "master"
[0m00:31:08.821836 [debug] [MainThread]: On master: COMMIT
[0m00:31:08.822027 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:31:08.822162 [debug] [MainThread]: On master: Close
[0m00:31:08.823578 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed
[0m00:31:08.823744 [info ] [Thread-1 (]: 1 of 96 START test source_not_null_main_raw_customers_id ....................... [RUN]
[0m00:31:08.823941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_platform_main, now test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed)
[0m00:31:08.824091 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed
[0m00:31:08.829408 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed"
[0m00:31:08.830034 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed
[0m00:31:08.837693 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed"
[0m00:31:08.838242 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed"
[0m00:31:08.838397 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed: BEGIN
[0m00:31:08.838533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:08.838814 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:08.838961 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed"
[0m00:31:08.839100 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "jaffle_platform"."main"."raw_customers"
where id is null



  
  
      
    ) dbt_internal_test
[0m00:31:08.841531 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:31:08.843360 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed: ROLLBACK
[0m00:31:08.843637 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed'
[0m00:31:08.843785 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed: Close
[0m00:31:08.844041 [info ] [Thread-1 (]: 1 of 96 PASS source_not_null_main_raw_customers_id ............................. [[32mPASS[0m in 0.02s]
[0m00:31:08.844278 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed
[0m00:31:08.844425 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168
[0m00:31:08.844692 [info ] [Thread-1 (]: 2 of 96 START test source_not_null_main_raw_items_id ........................... [RUN]
[0m00:31:08.844975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed, now test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168)
[0m00:31:08.845148 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168
[0m00:31:08.847281 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168"
[0m00:31:08.847657 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168
[0m00:31:08.848754 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168"
[0m00:31:08.849068 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168"
[0m00:31:08.849202 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168: BEGIN
[0m00:31:08.849323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:08.849569 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:08.849704 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168"
[0m00:31:08.849845 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "jaffle_platform"."main"."raw_items"
where id is null



  
  
      
    ) dbt_internal_test
[0m00:31:08.850404 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:08.851008 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168: ROLLBACK
[0m00:31:08.851229 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168'
[0m00:31:08.851373 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168: Close
[0m00:31:08.851611 [info ] [Thread-1 (]: 2 of 96 PASS source_not_null_main_raw_items_id ................................. [[32mPASS[0m in 0.01s]
[0m00:31:08.851833 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168
[0m00:31:08.851994 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515
[0m00:31:08.852193 [info ] [Thread-1 (]: 3 of 96 START test source_not_null_main_raw_orders_id .......................... [RUN]
[0m00:31:08.852370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168, now test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515)
[0m00:31:08.852510 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515
[0m00:31:08.854317 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515"
[0m00:31:08.854604 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515
[0m00:31:08.855553 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515"
[0m00:31:08.855816 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515"
[0m00:31:08.855951 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515: BEGIN
[0m00:31:08.856071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:08.856338 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:08.856529 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515"
[0m00:31:08.856693 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "jaffle_platform"."main"."raw_orders"
where id is null



  
  
      
    ) dbt_internal_test
[0m00:31:08.857161 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:08.857980 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515: ROLLBACK
[0m00:31:08.858262 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515'
[0m00:31:08.858413 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515: Close
[0m00:31:08.858630 [info ] [Thread-1 (]: 3 of 96 PASS source_not_null_main_raw_orders_id ................................ [[32mPASS[0m in 0.01s]
[0m00:31:08.858834 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515
[0m00:31:08.858981 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121
[0m00:31:08.859252 [info ] [Thread-1 (]: 4 of 96 START test source_not_null_main_raw_products_sku ....................... [RUN]
[0m00:31:08.859517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515, now test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121)
[0m00:31:08.859712 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121
[0m00:31:08.861399 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121"
[0m00:31:08.861707 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121
[0m00:31:08.862646 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121"
[0m00:31:08.862948 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121"
[0m00:31:08.863083 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121: BEGIN
[0m00:31:08.863205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:08.863486 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:08.863714 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121"
[0m00:31:08.863893 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sku
from "jaffle_platform"."main"."raw_products"
where sku is null



  
  
      
    ) dbt_internal_test
[0m00:31:08.864387 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:08.864980 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121: ROLLBACK
[0m00:31:08.865172 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121'
[0m00:31:08.865301 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121: Close
[0m00:31:08.865505 [info ] [Thread-1 (]: 4 of 96 PASS source_not_null_main_raw_products_sku ............................. [[32mPASS[0m in 0.01s]
[0m00:31:08.865697 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121
[0m00:31:08.865841 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c
[0m00:31:08.866057 [info ] [Thread-1 (]: 5 of 96 START test source_not_null_main_raw_stores_id .......................... [RUN]
[0m00:31:08.866302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121, now test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c)
[0m00:31:08.866462 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c
[0m00:31:08.868027 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c"
[0m00:31:08.868283 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c
[0m00:31:08.870042 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c"
[0m00:31:08.870301 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c"
[0m00:31:08.870431 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c: BEGIN
[0m00:31:08.870553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:08.870762 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:08.870884 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c"
[0m00:31:08.871015 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "jaffle_platform"."main"."raw_stores"
where id is null



  
  
      
    ) dbt_internal_test
[0m00:31:08.871413 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:08.872146 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c: ROLLBACK
[0m00:31:08.872429 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c'
[0m00:31:08.872581 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c: Close
[0m00:31:08.872789 [info ] [Thread-1 (]: 5 of 96 PASS source_not_null_main_raw_stores_id ................................ [[32mPASS[0m in 0.01s]
[0m00:31:08.872982 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c
[0m00:31:08.873129 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5
[0m00:31:08.873334 [info ] [Thread-1 (]: 6 of 96 START test source_not_null_main_raw_supplies_id ........................ [RUN]
[0m00:31:08.873568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c, now test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5)
[0m00:31:08.873733 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5
[0m00:31:08.875521 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5"
[0m00:31:08.875795 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5
[0m00:31:08.876796 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5"
[0m00:31:08.877050 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5"
[0m00:31:08.877181 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5: BEGIN
[0m00:31:08.877304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:08.877539 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:08.877678 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5"
[0m00:31:08.877821 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "jaffle_platform"."main"."raw_supplies"
where id is null



  
  
      
    ) dbt_internal_test
[0m00:31:08.878214 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:08.878783 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5: ROLLBACK
[0m00:31:08.879001 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5'
[0m00:31:08.879143 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5: Close
[0m00:31:08.879347 [info ] [Thread-1 (]: 6 of 96 PASS source_not_null_main_raw_supplies_id .............................. [[32mPASS[0m in 0.01s]
[0m00:31:08.879545 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5
[0m00:31:08.879688 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b
[0m00:31:08.879931 [info ] [Thread-1 (]: 7 of 96 START test source_unique_main_raw_customers_id ......................... [RUN]
[0m00:31:08.880289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5, now test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b)
[0m00:31:08.880476 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b
[0m00:31:08.883423 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b"
[0m00:31:08.883851 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b
[0m00:31:08.885035 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b"
[0m00:31:08.885311 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b"
[0m00:31:08.885443 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b: BEGIN
[0m00:31:08.885561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:08.885775 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:08.886047 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b"
[0m00:31:08.886185 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."raw_customers"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:08.892265 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m00:31:08.893153 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b: ROLLBACK
[0m00:31:08.893469 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b'
[0m00:31:08.893646 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b: Close
[0m00:31:08.893923 [info ] [Thread-1 (]: 7 of 96 PASS source_unique_main_raw_customers_id ............................... [[32mPASS[0m in 0.01s]
[0m00:31:08.894158 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b
[0m00:31:08.894372 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588
[0m00:31:08.894641 [info ] [Thread-1 (]: 8 of 96 START test source_unique_main_raw_items_id ............................. [RUN]
[0m00:31:08.894985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b, now test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588)
[0m00:31:08.895184 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588
[0m00:31:08.897178 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588"
[0m00:31:08.897558 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588
[0m00:31:08.898659 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588"
[0m00:31:08.898960 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588"
[0m00:31:08.899106 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588: BEGIN
[0m00:31:08.899242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:08.899535 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:08.899697 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588"
[0m00:31:08.899852 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."raw_items"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:08.945628 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m00:31:08.946558 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588: ROLLBACK
[0m00:31:08.946832 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588'
[0m00:31:08.946983 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588: Close
[0m00:31:08.947259 [info ] [Thread-1 (]: 8 of 96 PASS source_unique_main_raw_items_id ................................... [[32mPASS[0m in 0.05s]
[0m00:31:08.947503 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588
[0m00:31:08.947681 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7
[0m00:31:08.948029 [info ] [Thread-1 (]: 9 of 96 START test source_unique_main_raw_orders_id ............................ [RUN]
[0m00:31:08.948332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588, now test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7)
[0m00:31:08.948495 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7
[0m00:31:08.950384 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7"
[0m00:31:08.950744 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7
[0m00:31:08.952760 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7"
[0m00:31:08.953052 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7"
[0m00:31:08.953189 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7: BEGIN
[0m00:31:08.953315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:08.953574 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:08.953698 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7"
[0m00:31:08.953832 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."raw_orders"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:08.975374 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m00:31:08.976242 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7: ROLLBACK
[0m00:31:08.976505 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7'
[0m00:31:08.976667 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7: Close
[0m00:31:08.976922 [info ] [Thread-1 (]: 9 of 96 PASS source_unique_main_raw_orders_id .................................. [[32mPASS[0m in 0.03s]
[0m00:31:08.977149 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7
[0m00:31:08.977310 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94
[0m00:31:08.977527 [info ] [Thread-1 (]: 10 of 96 START test source_unique_main_raw_products_sku ........................ [RUN]
[0m00:31:08.977696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7, now test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94)
[0m00:31:08.977833 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94
[0m00:31:08.979611 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94"
[0m00:31:08.979983 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94
[0m00:31:08.981026 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94"
[0m00:31:08.981336 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94"
[0m00:31:08.981470 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94: BEGIN
[0m00:31:08.981592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:08.981879 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:08.982012 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94"
[0m00:31:08.982151 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    sku as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."raw_products"
where sku is not null
group by sku
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:08.983597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:08.984288 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94: ROLLBACK
[0m00:31:08.984522 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94'
[0m00:31:08.984667 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94: Close
[0m00:31:08.984891 [info ] [Thread-1 (]: 10 of 96 PASS source_unique_main_raw_products_sku .............................. [[32mPASS[0m in 0.01s]
[0m00:31:08.985101 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94
[0m00:31:08.985257 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6
[0m00:31:08.985451 [info ] [Thread-1 (]: 11 of 96 START test source_unique_main_raw_stores_id ........................... [RUN]
[0m00:31:08.985615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94, now test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6)
[0m00:31:08.985756 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6
[0m00:31:08.987582 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6"
[0m00:31:08.987957 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6
[0m00:31:08.989045 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6"
[0m00:31:08.989329 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6"
[0m00:31:08.989464 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6: BEGIN
[0m00:31:08.989590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:08.989851 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:08.989974 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6"
[0m00:31:08.990107 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."raw_stores"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:08.991276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:08.992112 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6: ROLLBACK
[0m00:31:08.992370 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6'
[0m00:31:08.992504 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6: Close
[0m00:31:08.992724 [info ] [Thread-1 (]: 11 of 96 PASS source_unique_main_raw_stores_id ................................. [[32mPASS[0m in 0.01s]
[0m00:31:08.992923 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6
[0m00:31:08.993072 [debug] [Thread-1 (]: Began running node model.jaffle_platform.stg_supplies
[0m00:31:08.993404 [info ] [Thread-1 (]: 12 of 96 START sql view model main.stg_supplies ................................ [RUN]
[0m00:31:08.993687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6, now model.jaffle_platform.stg_supplies)
[0m00:31:08.993884 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.stg_supplies
[0m00:31:08.995288 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.stg_supplies"
[0m00:31:08.995569 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.stg_supplies
[0m00:31:09.007667 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.stg_supplies"
[0m00:31:09.008165 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_supplies"
[0m00:31:09.008339 [debug] [Thread-1 (]: On model.jaffle_platform.stg_supplies: BEGIN
[0m00:31:09.008484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.008799 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.008935 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_supplies"
[0m00:31:09.009085 [debug] [Thread-1 (]: On model.jaffle_platform.stg_supplies: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_supplies"} */

  
  create view "jaffle_platform"."main"."stg_supplies__dbt_tmp" as (
    with source as (

    select * from "jaffle_platform"."main"."raw_supplies"

),

renamed as (

    select
        ----------  ids
        id as supply_id,
        sku as product_id,

        ----------  strings
        name as supply_name,

        ----------  numerics
        cost as supply_cost,

        ----------  booleans
        perishable

    from source

)

select * from renamed
  );

[0m00:31:09.009540 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.012539 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_supplies"
[0m00:31:09.012759 [debug] [Thread-1 (]: On model.jaffle_platform.stg_supplies: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_supplies"} */
alter view "jaffle_platform"."main"."stg_supplies" rename to "stg_supplies__dbt_backup"
[0m00:31:09.013438 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.016007 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_supplies"
[0m00:31:09.016188 [debug] [Thread-1 (]: On model.jaffle_platform.stg_supplies: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_supplies"} */
alter view "jaffle_platform"."main"."stg_supplies__dbt_tmp" rename to "stg_supplies"
[0m00:31:09.016492 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.021085 [debug] [Thread-1 (]: On model.jaffle_platform.stg_supplies: COMMIT
[0m00:31:09.021266 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_supplies"
[0m00:31:09.021403 [debug] [Thread-1 (]: On model.jaffle_platform.stg_supplies: COMMIT
[0m00:31:09.022433 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:09.024675 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_supplies"
[0m00:31:09.024857 [debug] [Thread-1 (]: On model.jaffle_platform.stg_supplies: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_supplies"} */
drop view if exists "jaffle_platform"."main"."stg_supplies__dbt_backup" cascade
[0m00:31:09.025182 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.025698 [debug] [Thread-1 (]: On model.jaffle_platform.stg_supplies: Close
[0m00:31:09.026987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508acd0>]}
[0m00:31:09.027285 [info ] [Thread-1 (]: 12 of 96 OK created sql view model main.stg_supplies ........................... [[32mOK[0m in 0.03s]
[0m00:31:09.027525 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.stg_supplies
[0m00:31:09.027684 [debug] [Thread-1 (]: Began running node model.jaffle_platform.stg_customers
[0m00:31:09.027959 [info ] [Thread-1 (]: 13 of 96 START sql view model main.stg_customers ............................... [RUN]
[0m00:31:09.028135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.stg_supplies, now model.jaffle_platform.stg_customers)
[0m00:31:09.028284 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.stg_customers
[0m00:31:09.029503 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.stg_customers"
[0m00:31:09.029812 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.stg_customers
[0m00:31:09.031221 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.stg_customers"
[0m00:31:09.031492 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_customers"
[0m00:31:09.031625 [debug] [Thread-1 (]: On model.jaffle_platform.stg_customers: BEGIN
[0m00:31:09.031758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.031976 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.032112 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_customers"
[0m00:31:09.032248 [debug] [Thread-1 (]: On model.jaffle_platform.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_customers"} */

  
  create view "jaffle_platform"."main"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "jaffle_platform"."main"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        name as customer_name

    from source

)

select * from renamed
  );

[0m00:31:09.032557 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.033844 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_customers"
[0m00:31:09.034006 [debug] [Thread-1 (]: On model.jaffle_platform.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_customers"} */
alter view "jaffle_platform"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m00:31:09.034368 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.035674 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_customers"
[0m00:31:09.035835 [debug] [Thread-1 (]: On model.jaffle_platform.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_customers"} */
alter view "jaffle_platform"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m00:31:09.036081 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.036525 [debug] [Thread-1 (]: On model.jaffle_platform.stg_customers: COMMIT
[0m00:31:09.036672 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_customers"
[0m00:31:09.036798 [debug] [Thread-1 (]: On model.jaffle_platform.stg_customers: COMMIT
[0m00:31:09.037070 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.038027 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_customers"
[0m00:31:09.038172 [debug] [Thread-1 (]: On model.jaffle_platform.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_customers"} */
drop view if exists "jaffle_platform"."main"."stg_customers__dbt_backup" cascade
[0m00:31:09.038438 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.038894 [debug] [Thread-1 (]: On model.jaffle_platform.stg_customers: Close
[0m00:31:09.039097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105003010>]}
[0m00:31:09.039325 [info ] [Thread-1 (]: 13 of 96 OK created sql view model main.stg_customers .......................... [[32mOK[0m in 0.01s]
[0m00:31:09.039536 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.stg_customers
[0m00:31:09.039683 [debug] [Thread-1 (]: Began running node model.jaffle_platform.stg_order_items
[0m00:31:09.039861 [info ] [Thread-1 (]: 14 of 96 START sql view model main.stg_order_items ............................. [RUN]
[0m00:31:09.040037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.stg_customers, now model.jaffle_platform.stg_order_items)
[0m00:31:09.040229 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.stg_order_items
[0m00:31:09.042440 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.stg_order_items"
[0m00:31:09.042796 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.stg_order_items
[0m00:31:09.044217 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.stg_order_items"
[0m00:31:09.044557 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_order_items"
[0m00:31:09.044765 [debug] [Thread-1 (]: On model.jaffle_platform.stg_order_items: BEGIN
[0m00:31:09.044923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.045227 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.045419 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_order_items"
[0m00:31:09.045565 [debug] [Thread-1 (]: On model.jaffle_platform.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_order_items"} */

  
  create view "jaffle_platform"."main"."stg_order_items__dbt_tmp" as (
    with source as (

    select * from "jaffle_platform"."main"."raw_items"

),

renamed as (

    select
        ----------  ids
        id as order_item_id,
        order_id,
        sku as product_id

    from source

)

select * from renamed
  );

[0m00:31:09.045897 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.047240 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_order_items"
[0m00:31:09.047393 [debug] [Thread-1 (]: On model.jaffle_platform.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_order_items"} */
alter view "jaffle_platform"."main"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m00:31:09.047630 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.048782 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_order_items"
[0m00:31:09.048923 [debug] [Thread-1 (]: On model.jaffle_platform.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_order_items"} */
alter view "jaffle_platform"."main"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m00:31:09.049148 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.049574 [debug] [Thread-1 (]: On model.jaffle_platform.stg_order_items: COMMIT
[0m00:31:09.049709 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_order_items"
[0m00:31:09.049872 [debug] [Thread-1 (]: On model.jaffle_platform.stg_order_items: COMMIT
[0m00:31:09.050316 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.051738 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_order_items"
[0m00:31:09.051917 [debug] [Thread-1 (]: On model.jaffle_platform.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_order_items"} */
drop view if exists "jaffle_platform"."main"."stg_order_items__dbt_backup" cascade
[0m00:31:09.052323 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.052783 [debug] [Thread-1 (]: On model.jaffle_platform.stg_order_items: Close
[0m00:31:09.052991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8f550>]}
[0m00:31:09.053239 [info ] [Thread-1 (]: 14 of 96 OK created sql view model main.stg_order_items ........................ [[32mOK[0m in 0.01s]
[0m00:31:09.053438 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.stg_order_items
[0m00:31:09.053578 [debug] [Thread-1 (]: Began running node model.jaffle_platform.stg_orders
[0m00:31:09.053890 [info ] [Thread-1 (]: 15 of 96 START sql view model main.stg_orders .................................. [RUN]
[0m00:31:09.054129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.stg_order_items, now model.jaffle_platform.stg_orders)
[0m00:31:09.054289 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.stg_orders
[0m00:31:09.055711 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.stg_orders"
[0m00:31:09.056076 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.stg_orders
[0m00:31:09.057566 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.stg_orders"
[0m00:31:09.057861 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_orders"
[0m00:31:09.058058 [debug] [Thread-1 (]: On model.jaffle_platform.stg_orders: BEGIN
[0m00:31:09.058183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.058433 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.058573 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_orders"
[0m00:31:09.058713 [debug] [Thread-1 (]: On model.jaffle_platform.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_orders"} */

  
  create view "jaffle_platform"."main"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "jaffle_platform"."main"."raw_orders"

),

renamed as (

    select
        id as order_id,
        customer as customer_id,
        ordered_at as order_date,
        store_id,
        subtotal,
        tax_paid,
        order_total,
        'completed' as status  -- Assuming all orders are completed since we don't have status in raw data

    from source

)

select * from renamed
  );

[0m00:31:09.059057 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.060496 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_orders"
[0m00:31:09.060646 [debug] [Thread-1 (]: On model.jaffle_platform.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_orders"} */
alter view "jaffle_platform"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m00:31:09.060859 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.062001 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_orders"
[0m00:31:09.062137 [debug] [Thread-1 (]: On model.jaffle_platform.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_orders"} */
alter view "jaffle_platform"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m00:31:09.062347 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.063829 [debug] [Thread-1 (]: On model.jaffle_platform.stg_orders: COMMIT
[0m00:31:09.064052 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_orders"
[0m00:31:09.064245 [debug] [Thread-1 (]: On model.jaffle_platform.stg_orders: COMMIT
[0m00:31:09.064632 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.065757 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_orders"
[0m00:31:09.065905 [debug] [Thread-1 (]: On model.jaffle_platform.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_orders"} */
drop view if exists "jaffle_platform"."main"."stg_orders__dbt_backup" cascade
[0m00:31:09.066243 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.066782 [debug] [Thread-1 (]: On model.jaffle_platform.stg_orders: Close
[0m00:31:09.067705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805db50>]}
[0m00:31:09.068058 [info ] [Thread-1 (]: 15 of 96 OK created sql view model main.stg_orders ............................. [[32mOK[0m in 0.01s]
[0m00:31:09.068322 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.stg_orders
[0m00:31:09.068503 [debug] [Thread-1 (]: Began running node model.jaffle_platform.stg_products
[0m00:31:09.068790 [info ] [Thread-1 (]: 16 of 96 START sql view model main.stg_products ................................ [RUN]
[0m00:31:09.069101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.stg_orders, now model.jaffle_platform.stg_products)
[0m00:31:09.069255 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.stg_products
[0m00:31:09.070554 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.stg_products"
[0m00:31:09.070881 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.stg_products
[0m00:31:09.072232 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.stg_products"
[0m00:31:09.072497 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_products"
[0m00:31:09.072623 [debug] [Thread-1 (]: On model.jaffle_platform.stg_products: BEGIN
[0m00:31:09.072742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.073008 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.073193 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_products"
[0m00:31:09.073342 [debug] [Thread-1 (]: On model.jaffle_platform.stg_products: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_products"} */

  
  create view "jaffle_platform"."main"."stg_products__dbt_tmp" as (
    with source as (

    select * from "jaffle_platform"."main"."raw_products"

),

renamed as (

    select
        ----------  ids
        sku as product_id,

        ----------  strings
        name as product_name,
        type as product_type,
        description,

        ----------  numerics
        price as product_price,

        ----------  booleans
        type = 'food' as is_food_item,
        type = 'drink' as is_drink_item

    from source

)

select * from renamed
  );

[0m00:31:09.073767 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.075115 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_products"
[0m00:31:09.075269 [debug] [Thread-1 (]: On model.jaffle_platform.stg_products: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_products"} */
alter view "jaffle_platform"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m00:31:09.075503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.076595 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_products"
[0m00:31:09.076732 [debug] [Thread-1 (]: On model.jaffle_platform.stg_products: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_products"} */
alter view "jaffle_platform"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m00:31:09.077094 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.077512 [debug] [Thread-1 (]: On model.jaffle_platform.stg_products: COMMIT
[0m00:31:09.077642 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_products"
[0m00:31:09.077761 [debug] [Thread-1 (]: On model.jaffle_platform.stg_products: COMMIT
[0m00:31:09.078105 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.079473 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_products"
[0m00:31:09.079635 [debug] [Thread-1 (]: On model.jaffle_platform.stg_products: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_products"} */
drop view if exists "jaffle_platform"."main"."stg_products__dbt_backup" cascade
[0m00:31:09.079993 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.080559 [debug] [Thread-1 (]: On model.jaffle_platform.stg_products: Close
[0m00:31:09.080862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105545510>]}
[0m00:31:09.081160 [info ] [Thread-1 (]: 16 of 96 OK created sql view model main.stg_products ........................... [[32mOK[0m in 0.01s]
[0m00:31:09.081407 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.stg_products
[0m00:31:09.081571 [debug] [Thread-1 (]: Began running node model.jaffle_platform.stg_stores
[0m00:31:09.081864 [info ] [Thread-1 (]: 17 of 96 START sql view model main.stg_stores .................................. [RUN]
[0m00:31:09.082077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.stg_products, now model.jaffle_platform.stg_stores)
[0m00:31:09.082279 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.stg_stores
[0m00:31:09.083550 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.stg_stores"
[0m00:31:09.083837 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.stg_stores
[0m00:31:09.086110 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.stg_stores"
[0m00:31:09.086396 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_stores"
[0m00:31:09.086526 [debug] [Thread-1 (]: On model.jaffle_platform.stg_stores: BEGIN
[0m00:31:09.086646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.086891 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.087075 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_stores"
[0m00:31:09.087277 [debug] [Thread-1 (]: On model.jaffle_platform.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_stores"} */

  
  create view "jaffle_platform"."main"."stg_stores__dbt_tmp" as (
    with source as (

    select * from "jaffle_platform"."main"."raw_stores"

),

renamed as (

    select
        ----------  ids
        id as store_id,

        ----------  strings
        name as store_name,

        ----------  timestamps
        opened_at as opened_at,

        ----------  numerics
        tax_rate

    from source

)

select * from renamed
  );

[0m00:31:09.087592 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.088814 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_stores"
[0m00:31:09.088963 [debug] [Thread-1 (]: On model.jaffle_platform.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_stores"} */
alter view "jaffle_platform"."main"."stg_stores" rename to "stg_stores__dbt_backup"
[0m00:31:09.089228 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.090409 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_stores"
[0m00:31:09.090548 [debug] [Thread-1 (]: On model.jaffle_platform.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_stores"} */
alter view "jaffle_platform"."main"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m00:31:09.090753 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.091160 [debug] [Thread-1 (]: On model.jaffle_platform.stg_stores: COMMIT
[0m00:31:09.091301 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_stores"
[0m00:31:09.091420 [debug] [Thread-1 (]: On model.jaffle_platform.stg_stores: COMMIT
[0m00:31:09.091732 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.092643 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_stores"
[0m00:31:09.092791 [debug] [Thread-1 (]: On model.jaffle_platform.stg_stores: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_stores"} */
drop view if exists "jaffle_platform"."main"."stg_stores__dbt_backup" cascade
[0m00:31:09.093119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.093744 [debug] [Thread-1 (]: On model.jaffle_platform.stg_stores: Close
[0m00:31:09.094035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b0b90>]}
[0m00:31:09.094277 [info ] [Thread-1 (]: 17 of 96 OK created sql view model main.stg_stores ............................. [[32mOK[0m in 0.01s]
[0m00:31:09.094473 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.stg_stores
[0m00:31:09.094619 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2
[0m00:31:09.094929 [info ] [Thread-1 (]: 18 of 96 START test dbt_utils_accepted_range_stg_supplies_supply_cost__0 ....... [RUN]
[0m00:31:09.095193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.stg_stores, now test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2)
[0m00:31:09.095363 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2
[0m00:31:09.097390 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2"
[0m00:31:09.097794 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2
[0m00:31:09.098824 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2"
[0m00:31:09.099167 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2"
[0m00:31:09.099313 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2: BEGIN
[0m00:31:09.099445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.099785 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.099944 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2"
[0m00:31:09.100144 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."stg_supplies"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not supply_cost >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:09.101037 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:09.101770 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2: ROLLBACK
[0m00:31:09.102040 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2'
[0m00:31:09.102200 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2: Close
[0m00:31:09.102435 [info ] [Thread-1 (]: 18 of 96 PASS dbt_utils_accepted_range_stg_supplies_supply_cost__0 ............. [[32mPASS[0m in 0.01s]
[0m00:31:09.102635 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2
[0m00:31:09.102782 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801
[0m00:31:09.102990 [info ] [Thread-1 (]: 19 of 96 START test not_null_stg_supplies_perishable ........................... [RUN]
[0m00:31:09.103232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2, now test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801)
[0m00:31:09.103389 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801
[0m00:31:09.105131 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801"
[0m00:31:09.105470 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801
[0m00:31:09.106451 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801"
[0m00:31:09.106765 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801"
[0m00:31:09.106905 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801: BEGIN
[0m00:31:09.107033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.107308 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.107473 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801"
[0m00:31:09.107616 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select perishable
from "jaffle_platform"."main"."stg_supplies"
where perishable is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.108097 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.108776 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801: ROLLBACK
[0m00:31:09.109032 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801'
[0m00:31:09.109216 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801: Close
[0m00:31:09.109439 [info ] [Thread-1 (]: 19 of 96 PASS not_null_stg_supplies_perishable ................................. [[32mPASS[0m in 0.01s]
[0m00:31:09.109647 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801
[0m00:31:09.109796 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471
[0m00:31:09.110008 [info ] [Thread-1 (]: 20 of 96 START test not_null_stg_supplies_product_id ........................... [RUN]
[0m00:31:09.110264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801, now test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471)
[0m00:31:09.110424 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471
[0m00:31:09.113111 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471"
[0m00:31:09.113437 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471
[0m00:31:09.114419 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471"
[0m00:31:09.114698 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471"
[0m00:31:09.114834 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471: BEGIN
[0m00:31:09.114954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.115229 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.115459 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471"
[0m00:31:09.115620 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "jaffle_platform"."main"."stg_supplies"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.116154 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.116892 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471: ROLLBACK
[0m00:31:09.117154 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471'
[0m00:31:09.117308 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471: Close
[0m00:31:09.117588 [info ] [Thread-1 (]: 20 of 96 PASS not_null_stg_supplies_product_id ................................. [[32mPASS[0m in 0.01s]
[0m00:31:09.117816 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471
[0m00:31:09.117979 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d
[0m00:31:09.118159 [info ] [Thread-1 (]: 21 of 96 START test not_null_stg_supplies_supply_cost .......................... [RUN]
[0m00:31:09.118331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471, now test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d)
[0m00:31:09.118476 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d
[0m00:31:09.120192 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d"
[0m00:31:09.120506 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d
[0m00:31:09.121506 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d"
[0m00:31:09.121790 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d"
[0m00:31:09.121924 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d: BEGIN
[0m00:31:09.122046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.122303 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.122496 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d"
[0m00:31:09.122648 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supply_cost
from "jaffle_platform"."main"."stg_supplies"
where supply_cost is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.123247 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.123846 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d: ROLLBACK
[0m00:31:09.124071 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d'
[0m00:31:09.124227 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d: Close
[0m00:31:09.124448 [info ] [Thread-1 (]: 21 of 96 PASS not_null_stg_supplies_supply_cost ................................ [[32mPASS[0m in 0.01s]
[0m00:31:09.124734 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d
[0m00:31:09.124891 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962
[0m00:31:09.125104 [info ] [Thread-1 (]: 22 of 96 START test not_null_stg_supplies_supply_id ............................ [RUN]
[0m00:31:09.125353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d, now test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962)
[0m00:31:09.125522 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962
[0m00:31:09.127473 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962"
[0m00:31:09.127818 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962
[0m00:31:09.128892 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962"
[0m00:31:09.129195 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962"
[0m00:31:09.129337 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962: BEGIN
[0m00:31:09.129465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.129710 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.129850 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962"
[0m00:31:09.129987 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supply_id
from "jaffle_platform"."main"."stg_supplies"
where supply_id is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.130471 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.131053 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962: ROLLBACK
[0m00:31:09.131273 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962'
[0m00:31:09.131402 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962: Close
[0m00:31:09.131614 [info ] [Thread-1 (]: 22 of 96 PASS not_null_stg_supplies_supply_id .................................. [[32mPASS[0m in 0.01s]
[0m00:31:09.131845 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962
[0m00:31:09.132011 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2
[0m00:31:09.132182 [info ] [Thread-1 (]: 23 of 96 START test not_null_stg_supplies_supply_name .......................... [RUN]
[0m00:31:09.132346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962, now test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2)
[0m00:31:09.132484 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2
[0m00:31:09.134269 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2"
[0m00:31:09.134628 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2
[0m00:31:09.135794 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2"
[0m00:31:09.136078 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2"
[0m00:31:09.136209 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2: BEGIN
[0m00:31:09.136338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.136555 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.136676 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2"
[0m00:31:09.136805 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supply_name
from "jaffle_platform"."main"."stg_supplies"
where supply_name is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.137307 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.137928 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2: ROLLBACK
[0m00:31:09.138137 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2'
[0m00:31:09.138277 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2: Close
[0m00:31:09.138502 [info ] [Thread-1 (]: 23 of 96 PASS not_null_stg_supplies_supply_name ................................ [[32mPASS[0m in 0.01s]
[0m00:31:09.138751 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2
[0m00:31:09.138924 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96
[0m00:31:09.139169 [info ] [Thread-1 (]: 24 of 96 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m00:31:09.139393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2, now test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96)
[0m00:31:09.139552 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96
[0m00:31:09.141321 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96"
[0m00:31:09.141649 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96
[0m00:31:09.143742 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96"
[0m00:31:09.144089 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96"
[0m00:31:09.144222 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m00:31:09.144347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.144611 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.144762 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96"
[0m00:31:09.144908 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "jaffle_platform"."main"."stg_order_items"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.145376 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.146064 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m00:31:09.146306 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96'
[0m00:31:09.146457 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96: Close
[0m00:31:09.146695 [info ] [Thread-1 (]: 24 of 96 PASS not_null_stg_order_items_order_id ................................ [[32mPASS[0m in 0.01s]
[0m00:31:09.146924 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96
[0m00:31:09.147079 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m00:31:09.147237 [info ] [Thread-1 (]: 25 of 96 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m00:31:09.147406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96, now test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m00:31:09.147547 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m00:31:09.149327 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m00:31:09.149693 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m00:31:09.150898 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m00:31:09.151257 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m00:31:09.151439 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m00:31:09.151590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.151883 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.152029 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m00:31:09.152250 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from "jaffle_platform"."main"."stg_order_items"
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.152918 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.153483 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m00:31:09.153713 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m00:31:09.153854 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m00:31:09.154081 [info ] [Thread-1 (]: 25 of 96 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.01s]
[0m00:31:09.154290 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m00:31:09.154438 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6
[0m00:31:09.154656 [info ] [Thread-1 (]: 26 of 96 START test not_null_stg_order_items_product_id ........................ [RUN]
[0m00:31:09.154889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6)
[0m00:31:09.155050 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6
[0m00:31:09.156754 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6"
[0m00:31:09.157054 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6
[0m00:31:09.158147 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6"
[0m00:31:09.158451 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6"
[0m00:31:09.158582 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6: BEGIN
[0m00:31:09.158704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.158907 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.159033 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6"
[0m00:31:09.159165 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "jaffle_platform"."main"."stg_order_items"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.159578 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.160309 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6: ROLLBACK
[0m00:31:09.160531 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6'
[0m00:31:09.160674 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6: Close
[0m00:31:09.160880 [info ] [Thread-1 (]: 26 of 96 PASS not_null_stg_order_items_product_id .............................. [[32mPASS[0m in 0.01s]
[0m00:31:09.161078 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6
[0m00:31:09.161222 [debug] [Thread-1 (]: Began running node test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108
[0m00:31:09.161438 [info ] [Thread-1 (]: 27 of 96 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m00:31:09.161672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6, now test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108)
[0m00:31:09.161832 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108
[0m00:31:09.163522 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108"
[0m00:31:09.163879 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108
[0m00:31:09.164910 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108"
[0m00:31:09.165211 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108"
[0m00:31:09.165355 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108: BEGIN
[0m00:31:09.165482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.165765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.165897 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108"
[0m00:31:09.166034 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."stg_order_items"
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:09.188132 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m00:31:09.189008 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108: ROLLBACK
[0m00:31:09.189261 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108'
[0m00:31:09.189415 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108: Close
[0m00:31:09.189660 [info ] [Thread-1 (]: 27 of 96 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 0.03s]
[0m00:31:09.189975 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108
[0m00:31:09.190264 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64
[0m00:31:09.190496 [info ] [Thread-1 (]: 28 of 96 START test not_null_stg_orders_order_id ............................... [RUN]
[0m00:31:09.190826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108, now test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64)
[0m00:31:09.191037 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64
[0m00:31:09.192860 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:31:09.193263 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64
[0m00:31:09.195354 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:31:09.195729 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:31:09.195871 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m00:31:09.196011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.196287 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.196416 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:31:09.196548 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "jaffle_platform"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.197124 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.197882 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m00:31:09.198139 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64'
[0m00:31:09.198282 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m00:31:09.198529 [info ] [Thread-1 (]: 28 of 96 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.01s]
[0m00:31:09.198754 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64
[0m00:31:09.198912 [debug] [Thread-1 (]: Began running node test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m00:31:09.199081 [info ] [Thread-1 (]: 29 of 96 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m00:31:09.199260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m00:31:09.199404 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m00:31:09.201783 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m00:31:09.202202 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m00:31:09.203300 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m00:31:09.203647 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m00:31:09.203800 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m00:31:09.203940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.204213 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.204354 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m00:31:09.204524 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "jaffle_platform"."main"."stg_order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "jaffle_platform"."main"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.250778 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m00:31:09.252930 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m00:31:09.253241 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m00:31:09.253416 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m00:31:09.253701 [info ] [Thread-1 (]: 29 of 96 PASS relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.05s]
[0m00:31:09.253943 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m00:31:09.254119 [debug] [Thread-1 (]: Began running node test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a
[0m00:31:09.254308 [info ] [Thread-1 (]: 30 of 96 START test unique_stg_orders_order_id ................................. [RUN]
[0m00:31:09.254487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a)
[0m00:31:09.254637 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a
[0m00:31:09.256626 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a"
[0m00:31:09.256968 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a
[0m00:31:09.258078 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a"
[0m00:31:09.258380 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a"
[0m00:31:09.258526 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m00:31:09.258658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.258946 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.259088 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a"
[0m00:31:09.259243 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:09.274994 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m00:31:09.275839 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m00:31:09.276110 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a'
[0m00:31:09.276256 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a: Close
[0m00:31:09.276514 [info ] [Thread-1 (]: 30 of 96 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m00:31:09.276757 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a
[0m00:31:09.276917 [debug] [Thread-1 (]: Began running node test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e
[0m00:31:09.277111 [info ] [Thread-1 (]: 31 of 96 START test accepted_values_stg_products_product_type__beverage__jaffle  [RUN]
[0m00:31:09.277311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a, now test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e)
[0m00:31:09.277448 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e
[0m00:31:09.279353 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e"
[0m00:31:09.279769 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e
[0m00:31:09.280739 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e"
[0m00:31:09.281083 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e"
[0m00:31:09.281243 [debug] [Thread-1 (]: On test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e: BEGIN
[0m00:31:09.281378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.281651 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.281789 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e"
[0m00:31:09.281932 [debug] [Thread-1 (]: On test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        product_type as value_field,
        count(*) as n_records

    from "jaffle_platform"."main"."stg_products"
    group by product_type

)

select *
from all_values
where value_field not in (
    'beverage','jaffle'
)



  
  
      
    ) dbt_internal_test
[0m00:31:09.283288 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:09.284084 [debug] [Thread-1 (]: On test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e: ROLLBACK
[0m00:31:09.284414 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e'
[0m00:31:09.284582 [debug] [Thread-1 (]: On test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e: Close
[0m00:31:09.284845 [info ] [Thread-1 (]: 31 of 96 PASS accepted_values_stg_products_product_type__beverage__jaffle ...... [[32mPASS[0m in 0.01s]
[0m00:31:09.285056 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e
[0m00:31:09.285208 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2
[0m00:31:09.285435 [info ] [Thread-1 (]: 32 of 96 START test dbt_utils_accepted_range_stg_products_product_price__0 ..... [RUN]
[0m00:31:09.285700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e, now test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2)
[0m00:31:09.285879 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2
[0m00:31:09.287679 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2"
[0m00:31:09.288001 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2
[0m00:31:09.290121 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2"
[0m00:31:09.290463 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2"
[0m00:31:09.290670 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2: BEGIN
[0m00:31:09.290856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.291129 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.291264 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2"
[0m00:31:09.291416 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."stg_products"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not product_price >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:09.292180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:09.292846 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2: ROLLBACK
[0m00:31:09.293086 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2'
[0m00:31:09.293230 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2: Close
[0m00:31:09.293470 [info ] [Thread-1 (]: 32 of 96 PASS dbt_utils_accepted_range_stg_products_product_price__0 ........... [[32mPASS[0m in 0.01s]
[0m00:31:09.293690 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2
[0m00:31:09.293837 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d
[0m00:31:09.294046 [info ] [Thread-1 (]: 33 of 96 START test not_null_stg_products_is_drink_item ........................ [RUN]
[0m00:31:09.294251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2, now test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d)
[0m00:31:09.294392 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d
[0m00:31:09.296177 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d"
[0m00:31:09.296557 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d
[0m00:31:09.297581 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d"
[0m00:31:09.297900 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d"
[0m00:31:09.298036 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d: BEGIN
[0m00:31:09.298156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.298393 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.298517 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d"
[0m00:31:09.298648 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_drink_item
from "jaffle_platform"."main"."stg_products"
where is_drink_item is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.299200 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.299941 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d: ROLLBACK
[0m00:31:09.300221 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d'
[0m00:31:09.300370 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d: Close
[0m00:31:09.300703 [info ] [Thread-1 (]: 33 of 96 PASS not_null_stg_products_is_drink_item .............................. [[32mPASS[0m in 0.01s]
[0m00:31:09.300993 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d
[0m00:31:09.301167 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1
[0m00:31:09.301352 [info ] [Thread-1 (]: 34 of 96 START test not_null_stg_products_is_food_item ......................... [RUN]
[0m00:31:09.301538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d, now test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1)
[0m00:31:09.301702 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1
[0m00:31:09.303461 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1"
[0m00:31:09.303777 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1
[0m00:31:09.304850 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1"
[0m00:31:09.305171 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1"
[0m00:31:09.305314 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1: BEGIN
[0m00:31:09.305437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.305696 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.305841 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1"
[0m00:31:09.305985 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_food_item
from "jaffle_platform"."main"."stg_products"
where is_food_item is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.306577 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.307205 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1: ROLLBACK
[0m00:31:09.307438 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1'
[0m00:31:09.307584 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1: Close
[0m00:31:09.307792 [info ] [Thread-1 (]: 34 of 96 PASS not_null_stg_products_is_food_item ............................... [[32mPASS[0m in 0.01s]
[0m00:31:09.307995 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1
[0m00:31:09.308144 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3
[0m00:31:09.308368 [info ] [Thread-1 (]: 35 of 96 START test not_null_stg_products_product_id ........................... [RUN]
[0m00:31:09.308668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1, now test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3)
[0m00:31:09.308844 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3
[0m00:31:09.310911 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3"
[0m00:31:09.311191 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3
[0m00:31:09.312299 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3"
[0m00:31:09.312555 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3"
[0m00:31:09.312683 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m00:31:09.312807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.313008 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.313136 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3"
[0m00:31:09.313272 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "jaffle_platform"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.313826 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.314596 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m00:31:09.314864 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3'
[0m00:31:09.315020 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3: Close
[0m00:31:09.315296 [info ] [Thread-1 (]: 35 of 96 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.01s]
[0m00:31:09.315516 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3
[0m00:31:09.315683 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939
[0m00:31:09.315855 [info ] [Thread-1 (]: 36 of 96 START test not_null_stg_products_product_name ......................... [RUN]
[0m00:31:09.316031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3, now test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939)
[0m00:31:09.316185 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939
[0m00:31:09.318125 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939"
[0m00:31:09.318408 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939
[0m00:31:09.320486 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939"
[0m00:31:09.320759 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939"
[0m00:31:09.320895 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939: BEGIN
[0m00:31:09.321019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.321284 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.321476 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939"
[0m00:31:09.321633 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "jaffle_platform"."main"."stg_products"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.322239 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.322845 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939: ROLLBACK
[0m00:31:09.323049 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939'
[0m00:31:09.323178 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939: Close
[0m00:31:09.323379 [info ] [Thread-1 (]: 36 of 96 PASS not_null_stg_products_product_name ............................... [[32mPASS[0m in 0.01s]
[0m00:31:09.323580 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939
[0m00:31:09.323717 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e
[0m00:31:09.323912 [info ] [Thread-1 (]: 37 of 96 START test not_null_stg_products_product_price ........................ [RUN]
[0m00:31:09.324137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939, now test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e)
[0m00:31:09.324291 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e
[0m00:31:09.326273 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e"
[0m00:31:09.326700 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e
[0m00:31:09.327863 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e"
[0m00:31:09.328141 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e"
[0m00:31:09.328274 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e: BEGIN
[0m00:31:09.328398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.328661 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.328854 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e"
[0m00:31:09.329009 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_price
from "jaffle_platform"."main"."stg_products"
where product_price is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.329618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.330389 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e: ROLLBACK
[0m00:31:09.330683 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e'
[0m00:31:09.330845 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e: Close
[0m00:31:09.331094 [info ] [Thread-1 (]: 37 of 96 PASS not_null_stg_products_product_price .............................. [[32mPASS[0m in 0.01s]
[0m00:31:09.331319 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e
[0m00:31:09.331476 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8
[0m00:31:09.331635 [info ] [Thread-1 (]: 38 of 96 START test not_null_stg_products_product_type ......................... [RUN]
[0m00:31:09.331796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e, now test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8)
[0m00:31:09.331934 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8
[0m00:31:09.333757 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8"
[0m00:31:09.334125 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8
[0m00:31:09.335236 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8"
[0m00:31:09.335569 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8"
[0m00:31:09.335716 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8: BEGIN
[0m00:31:09.335909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.336173 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.336356 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8"
[0m00:31:09.336517 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_type
from "jaffle_platform"."main"."stg_products"
where product_type is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.337043 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.337762 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8: ROLLBACK
[0m00:31:09.338004 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8'
[0m00:31:09.338142 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8: Close
[0m00:31:09.338367 [info ] [Thread-1 (]: 38 of 96 PASS not_null_stg_products_product_type ............................... [[32mPASS[0m in 0.01s]
[0m00:31:09.338599 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8
[0m00:31:09.338767 [debug] [Thread-1 (]: Began running node test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m00:31:09.338952 [info ] [Thread-1 (]: 39 of 96 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m00:31:09.339145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8, now test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m00:31:09.339310 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m00:31:09.341413 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m00:31:09.341781 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m00:31:09.342873 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m00:31:09.343173 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m00:31:09.343307 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: BEGIN
[0m00:31:09.343432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.343640 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.343776 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m00:31:09.343931 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "jaffle_platform"."main"."stg_order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "jaffle_platform"."main"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.347207 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:31:09.348146 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: ROLLBACK
[0m00:31:09.348420 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c'
[0m00:31:09.348587 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: Close
[0m00:31:09.348848 [info ] [Thread-1 (]: 39 of 96 PASS relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.01s]
[0m00:31:09.349081 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m00:31:09.349248 [debug] [Thread-1 (]: Began running node test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a
[0m00:31:09.349439 [info ] [Thread-1 (]: 40 of 96 START test relationships_stg_supplies_product_id__product_id__ref_stg_products_  [RUN]
[0m00:31:09.349619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a)
[0m00:31:09.349769 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a
[0m00:31:09.352258 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a"
[0m00:31:09.352554 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a
[0m00:31:09.353614 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a"
[0m00:31:09.353892 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a"
[0m00:31:09.354031 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a: BEGIN
[0m00:31:09.354158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.354377 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.354506 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a"
[0m00:31:09.354652 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "jaffle_platform"."main"."stg_supplies"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "jaffle_platform"."main"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.355840 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:09.357921 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a: ROLLBACK
[0m00:31:09.358199 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a'
[0m00:31:09.358363 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a: Close
[0m00:31:09.358624 [info ] [Thread-1 (]: 40 of 96 PASS relationships_stg_supplies_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.01s]
[0m00:31:09.358852 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a
[0m00:31:09.359023 [debug] [Thread-1 (]: Began running node test.jaffle_platform.unique_stg_products_product_id.7d950a1467
[0m00:31:09.359188 [info ] [Thread-1 (]: 41 of 96 START test unique_stg_products_product_id ............................. [RUN]
[0m00:31:09.359361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a, now test.jaffle_platform.unique_stg_products_product_id.7d950a1467)
[0m00:31:09.359506 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.unique_stg_products_product_id.7d950a1467
[0m00:31:09.392439 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.unique_stg_products_product_id.7d950a1467"
[0m00:31:09.392985 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.unique_stg_products_product_id.7d950a1467
[0m00:31:09.394033 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.unique_stg_products_product_id.7d950a1467"
[0m00:31:09.394387 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_stg_products_product_id.7d950a1467"
[0m00:31:09.394544 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_products_product_id.7d950a1467: BEGIN
[0m00:31:09.394682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.394999 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.395139 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_stg_products_product_id.7d950a1467"
[0m00:31:09.395293 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:09.396405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:09.397121 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m00:31:09.397380 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.unique_stg_products_product_id.7d950a1467'
[0m00:31:09.397525 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_products_product_id.7d950a1467: Close
[0m00:31:09.397760 [info ] [Thread-1 (]: 41 of 96 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.04s]
[0m00:31:09.398004 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.unique_stg_products_product_id.7d950a1467
[0m00:31:09.398177 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520
[0m00:31:09.398404 [info ] [Thread-1 (]: 42 of 96 START test dbt_utils_accepted_range_stg_stores_tax_rate__1__0 ......... [RUN]
[0m00:31:09.398574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.unique_stg_products_product_id.7d950a1467, now test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520)
[0m00:31:09.398720 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520
[0m00:31:09.400349 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520"
[0m00:31:09.400710 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520
[0m00:31:09.401747 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520"
[0m00:31:09.402081 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520"
[0m00:31:09.402230 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520: BEGIN
[0m00:31:09.402368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.402600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.402737 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520"
[0m00:31:09.402901 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."stg_stores"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not tax_rate >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not tax_rate <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:09.403633 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:09.404281 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520: ROLLBACK
[0m00:31:09.404516 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520'
[0m00:31:09.404657 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520: Close
[0m00:31:09.404876 [info ] [Thread-1 (]: 42 of 96 PASS dbt_utils_accepted_range_stg_stores_tax_rate__1__0 ............... [[32mPASS[0m in 0.01s]
[0m00:31:09.405077 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520
[0m00:31:09.405219 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64
[0m00:31:09.405447 [info ] [Thread-1 (]: 43 of 96 START test not_null_stg_stores_opened_at .............................. [RUN]
[0m00:31:09.405737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520, now test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64)
[0m00:31:09.405896 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64
[0m00:31:09.407553 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64"
[0m00:31:09.407890 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64
[0m00:31:09.408918 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64"
[0m00:31:09.409221 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64"
[0m00:31:09.409356 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64: BEGIN
[0m00:31:09.409476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.409724 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.409847 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64"
[0m00:31:09.409979 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select opened_at
from "jaffle_platform"."main"."stg_stores"
where opened_at is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.410484 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.411143 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64: ROLLBACK
[0m00:31:09.411370 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64'
[0m00:31:09.411507 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64: Close
[0m00:31:09.411719 [info ] [Thread-1 (]: 43 of 96 PASS not_null_stg_stores_opened_at .................................... [[32mPASS[0m in 0.01s]
[0m00:31:09.411913 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64
[0m00:31:09.412059 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6
[0m00:31:09.412261 [info ] [Thread-1 (]: 44 of 96 START test not_null_stg_stores_store_id ............................... [RUN]
[0m00:31:09.412500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64, now test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6)
[0m00:31:09.412660 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6
[0m00:31:09.414529 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6"
[0m00:31:09.414863 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6
[0m00:31:09.415907 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6"
[0m00:31:09.416225 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6"
[0m00:31:09.416426 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6: BEGIN
[0m00:31:09.416552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.416775 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.416899 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6"
[0m00:31:09.417031 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "jaffle_platform"."main"."stg_stores"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.417469 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.418185 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6: ROLLBACK
[0m00:31:09.418456 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6'
[0m00:31:09.418605 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6: Close
[0m00:31:09.418846 [info ] [Thread-1 (]: 44 of 96 PASS not_null_stg_stores_store_id ..................................... [[32mPASS[0m in 0.01s]
[0m00:31:09.419121 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6
[0m00:31:09.419284 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7
[0m00:31:09.419492 [info ] [Thread-1 (]: 45 of 96 START test not_null_stg_stores_store_name ............................. [RUN]
[0m00:31:09.419698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6, now test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7)
[0m00:31:09.419851 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7
[0m00:31:09.422637 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7"
[0m00:31:09.422971 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7
[0m00:31:09.423990 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7"
[0m00:31:09.424272 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7"
[0m00:31:09.424415 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7: BEGIN
[0m00:31:09.424579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.424907 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.425124 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7"
[0m00:31:09.425279 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "jaffle_platform"."main"."stg_stores"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.425727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.426426 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7: ROLLBACK
[0m00:31:09.426665 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7'
[0m00:31:09.426813 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7: Close
[0m00:31:09.427046 [info ] [Thread-1 (]: 45 of 96 PASS not_null_stg_stores_store_name ................................... [[32mPASS[0m in 0.01s]
[0m00:31:09.427308 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7
[0m00:31:09.427472 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6
[0m00:31:09.427642 [info ] [Thread-1 (]: 46 of 96 START test not_null_stg_stores_tax_rate ............................... [RUN]
[0m00:31:09.427815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7, now test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6)
[0m00:31:09.427959 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6
[0m00:31:09.429533 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6"
[0m00:31:09.429843 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6
[0m00:31:09.430870 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6"
[0m00:31:09.431181 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6"
[0m00:31:09.431358 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6: BEGIN
[0m00:31:09.431520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.431804 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.431945 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6"
[0m00:31:09.432105 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tax_rate
from "jaffle_platform"."main"."stg_stores"
where tax_rate is null



  
  
      
    ) dbt_internal_test
[0m00:31:09.432686 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.433333 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6: ROLLBACK
[0m00:31:09.433557 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6'
[0m00:31:09.433698 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6: Close
[0m00:31:09.433917 [info ] [Thread-1 (]: 46 of 96 PASS not_null_stg_stores_tax_rate ..................................... [[32mPASS[0m in 0.01s]
[0m00:31:09.434118 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6
[0m00:31:09.434261 [debug] [Thread-1 (]: Began running node test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2
[0m00:31:09.434477 [info ] [Thread-1 (]: 47 of 96 START test unique_stg_stores_store_id ................................. [RUN]
[0m00:31:09.434730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6, now test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2)
[0m00:31:09.434886 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2
[0m00:31:09.436604 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2"
[0m00:31:09.436933 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2
[0m00:31:09.437916 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2"
[0m00:31:09.438197 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2"
[0m00:31:09.438329 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2: BEGIN
[0m00:31:09.438450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.438667 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.438789 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2"
[0m00:31:09.438922 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    store_id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."stg_stores"
where store_id is not null
group by store_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:09.439994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:09.440806 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2: ROLLBACK
[0m00:31:09.441084 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2'
[0m00:31:09.441247 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2: Close
[0m00:31:09.441455 [info ] [Thread-1 (]: 47 of 96 PASS unique_stg_stores_store_id ....................................... [[32mPASS[0m in 0.01s]
[0m00:31:09.441645 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2
[0m00:31:09.441789 [debug] [Thread-1 (]: Began running node model.jaffle_platform.supplies
[0m00:31:09.442072 [info ] [Thread-1 (]: 48 of 96 START sql table model main.supplies ................................... [RUN]
[0m00:31:09.442297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2, now model.jaffle_platform.supplies)
[0m00:31:09.442449 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.supplies
[0m00:31:09.443916 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.supplies"
[0m00:31:09.444305 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.supplies
[0m00:31:09.480344 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.supplies"
[0m00:31:09.483025 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.supplies"
[0m00:31:09.483964 [debug] [Thread-1 (]: On model.jaffle_platform.supplies: BEGIN
[0m00:31:09.484895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.486875 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:31:09.487938 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.supplies"
[0m00:31:09.489398 [debug] [Thread-1 (]: On model.jaffle_platform.supplies: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.supplies"} */

  
    
    

    create  table
      "jaffle_platform"."main"."supplies__dbt_tmp"
  
    as (
      select * from "jaffle_platform"."main"."stg_supplies"
    );
  
  
[0m00:31:09.494745 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:31:09.509696 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.supplies"
[0m00:31:09.511505 [debug] [Thread-1 (]: On model.jaffle_platform.supplies: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.supplies"} */
alter table "jaffle_platform"."main"."supplies" rename to "supplies__dbt_backup"
[0m00:31:09.514074 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:31:09.520420 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.supplies"
[0m00:31:09.520656 [debug] [Thread-1 (]: On model.jaffle_platform.supplies: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.supplies"} */
alter table "jaffle_platform"."main"."supplies__dbt_tmp" rename to "supplies"
[0m00:31:09.521120 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.523526 [debug] [Thread-1 (]: On model.jaffle_platform.supplies: COMMIT
[0m00:31:09.523750 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.supplies"
[0m00:31:09.523909 [debug] [Thread-1 (]: On model.jaffle_platform.supplies: COMMIT
[0m00:31:09.524688 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:09.526237 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.supplies"
[0m00:31:09.526479 [debug] [Thread-1 (]: On model.jaffle_platform.supplies: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.supplies"} */
drop table if exists "jaffle_platform"."main"."supplies__dbt_backup" cascade
[0m00:31:09.526973 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.527580 [debug] [Thread-1 (]: On model.jaffle_platform.supplies: Close
[0m00:31:09.527877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d9910>]}
[0m00:31:09.528181 [info ] [Thread-1 (]: 48 of 96 OK created sql table model main.supplies .............................. [[32mOK[0m in 0.09s]
[0m00:31:09.528485 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.supplies
[0m00:31:09.528673 [debug] [Thread-1 (]: Began running node model.jaffle_platform.order_items
[0m00:31:09.528905 [info ] [Thread-1 (]: 49 of 96 START sql table model main.order_items ................................ [RUN]
[0m00:31:09.529103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.supplies, now model.jaffle_platform.order_items)
[0m00:31:09.529252 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.order_items
[0m00:31:09.531241 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.order_items"
[0m00:31:09.531646 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.order_items
[0m00:31:09.533458 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.order_items"
[0m00:31:09.533770 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.order_items"
[0m00:31:09.533908 [debug] [Thread-1 (]: On model.jaffle_platform.order_items: BEGIN
[0m00:31:09.534033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:09.534268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:09.534898 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.order_items"
[0m00:31:09.535271 [debug] [Thread-1 (]: On model.jaffle_platform.order_items: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.order_items"} */

  
    
    

    create  table
      "jaffle_platform"."main"."order_items__dbt_tmp"
  
    as (
      with order_items as (

    select * from "jaffle_platform"."main"."stg_order_items"

),

orders as (

    select * from "jaffle_platform"."main"."stg_orders"

),

products as (

    select * from "jaffle_platform"."main"."stg_products"

),

supplies as (

    select * from "jaffle_platform"."main"."stg_supplies"

),

order_supplies_summary as (

    select
        product_id,
        sum(supply_cost) as supply_cost
    from supplies
    group by 1

),

joined as (

    select
        order_items.*,

        orders.order_date,
        orders.store_id,

        products.product_name,
        
    round(1.0 * products.product_price / 100, 2)
 as product_price,
        products.is_food_item,
        products.is_drink_item,

        
    round(1.0 * order_supplies_summary.supply_cost / 100, 2)
 as supply_cost,

        -- calculated fields
        
    round(1.0 * products.product_price - coalesce(order_supplies_summary.supply_cost, 0) / 100, 2)
 as gross_profit_per_item

    from order_items

    left join orders on order_items.order_id = orders.order_id

    left join products on order_items.product_id = products.product_id

    left join order_supplies_summary
        on order_items.product_id = order_supplies_summary.product_id

)

select * from joined
    );
  
  
[0m00:31:10.356379 [debug] [Thread-1 (]: SQL status: OK in 0.821 seconds
[0m00:31:10.357963 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.order_items"
[0m00:31:10.358133 [debug] [Thread-1 (]: On model.jaffle_platform.order_items: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.order_items"} */
alter table "jaffle_platform"."main"."order_items" rename to "order_items__dbt_backup"
[0m00:31:10.358454 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.359677 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.order_items"
[0m00:31:10.359821 [debug] [Thread-1 (]: On model.jaffle_platform.order_items: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.order_items"} */
alter table "jaffle_platform"."main"."order_items__dbt_tmp" rename to "order_items"
[0m00:31:10.360048 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.360542 [debug] [Thread-1 (]: On model.jaffle_platform.order_items: COMMIT
[0m00:31:10.360678 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.order_items"
[0m00:31:10.360799 [debug] [Thread-1 (]: On model.jaffle_platform.order_items: COMMIT
[0m00:31:10.469257 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m00:31:10.470507 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.order_items"
[0m00:31:10.470667 [debug] [Thread-1 (]: On model.jaffle_platform.order_items: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.order_items"} */
drop table if exists "jaffle_platform"."main"."order_items__dbt_backup" cascade
[0m00:31:10.471232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.471771 [debug] [Thread-1 (]: On model.jaffle_platform.order_items: Close
[0m00:31:10.472018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d9910>]}
[0m00:31:10.472294 [info ] [Thread-1 (]: 49 of 96 OK created sql table model main.order_items ........................... [[32mOK[0m in 0.94s]
[0m00:31:10.472522 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.order_items
[0m00:31:10.472679 [debug] [Thread-1 (]: Began running node model.jaffle_platform.products
[0m00:31:10.472991 [info ] [Thread-1 (]: 50 of 96 START sql table model main.products ................................... [RUN]
[0m00:31:10.473166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.order_items, now model.jaffle_platform.products)
[0m00:31:10.473307 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.products
[0m00:31:10.475582 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.products"
[0m00:31:10.475863 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.products
[0m00:31:10.477144 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.products"
[0m00:31:10.477420 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.products"
[0m00:31:10.477553 [debug] [Thread-1 (]: On model.jaffle_platform.products: BEGIN
[0m00:31:10.477684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.477914 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.478051 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.products"
[0m00:31:10.478187 [debug] [Thread-1 (]: On model.jaffle_platform.products: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.products"} */

  
    
    

    create  table
      "jaffle_platform"."main"."products__dbt_tmp"
  
    as (
      select * from "jaffle_platform"."main"."stg_products"
    );
  
  
[0m00:31:10.478949 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:10.480523 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.products"
[0m00:31:10.480839 [debug] [Thread-1 (]: On model.jaffle_platform.products: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.products"} */
alter table "jaffle_platform"."main"."products" rename to "products__dbt_backup"
[0m00:31:10.481222 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.482483 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.products"
[0m00:31:10.482656 [debug] [Thread-1 (]: On model.jaffle_platform.products: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.products"} */
alter table "jaffle_platform"."main"."products__dbt_tmp" rename to "products"
[0m00:31:10.482907 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.483366 [debug] [Thread-1 (]: On model.jaffle_platform.products: COMMIT
[0m00:31:10.483500 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.products"
[0m00:31:10.483621 [debug] [Thread-1 (]: On model.jaffle_platform.products: COMMIT
[0m00:31:10.483960 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.485306 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.products"
[0m00:31:10.485497 [debug] [Thread-1 (]: On model.jaffle_platform.products: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.products"} */
drop table if exists "jaffle_platform"."main"."products__dbt_backup" cascade
[0m00:31:10.485808 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.486340 [debug] [Thread-1 (]: On model.jaffle_platform.products: Close
[0m00:31:10.486562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b56d0>]}
[0m00:31:10.486804 [info ] [Thread-1 (]: 50 of 96 OK created sql table model main.products .............................. [[32mOK[0m in 0.01s]
[0m00:31:10.487017 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.products
[0m00:31:10.487179 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39
[0m00:31:10.487348 [info ] [Thread-1 (]: 51 of 96 START test dbt_utils_accepted_range_order_items_product_price__0 ...... [RUN]
[0m00:31:10.487521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.products, now test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39)
[0m00:31:10.487667 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39
[0m00:31:10.489354 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39"
[0m00:31:10.489722 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39
[0m00:31:10.490803 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39"
[0m00:31:10.491232 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39"
[0m00:31:10.491410 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39: BEGIN
[0m00:31:10.491541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.491819 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.492004 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39"
[0m00:31:10.492180 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."order_items"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not product_price >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:10.492872 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:10.493473 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39: ROLLBACK
[0m00:31:10.493730 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39'
[0m00:31:10.493883 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39: Close
[0m00:31:10.494109 [info ] [Thread-1 (]: 51 of 96 PASS dbt_utils_accepted_range_order_items_product_price__0 ............ [[32mPASS[0m in 0.01s]
[0m00:31:10.494310 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39
[0m00:31:10.494460 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26
[0m00:31:10.494661 [info ] [Thread-1 (]: 52 of 96 START test dbt_utils_accepted_range_order_items_supply_cost__0 ........ [RUN]
[0m00:31:10.494891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39, now test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26)
[0m00:31:10.495048 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26
[0m00:31:10.496717 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26"
[0m00:31:10.497032 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26
[0m00:31:10.499160 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26"
[0m00:31:10.499527 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26"
[0m00:31:10.499711 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26: BEGIN
[0m00:31:10.499863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.500130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.500284 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26"
[0m00:31:10.500452 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."order_items"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not supply_cost >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:10.501038 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.501685 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26: ROLLBACK
[0m00:31:10.501882 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26'
[0m00:31:10.502015 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26: Close
[0m00:31:10.502229 [info ] [Thread-1 (]: 52 of 96 PASS dbt_utils_accepted_range_order_items_supply_cost__0 .............. [[32mPASS[0m in 0.01s]
[0m00:31:10.502441 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26
[0m00:31:10.502591 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b
[0m00:31:10.502763 [info ] [Thread-1 (]: 53 of 96 START test not_null_order_items_gross_profit_per_item ................. [RUN]
[0m00:31:10.502932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26, now test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b)
[0m00:31:10.503081 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b
[0m00:31:10.504709 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b"
[0m00:31:10.505049 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b
[0m00:31:10.506023 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b"
[0m00:31:10.506321 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b"
[0m00:31:10.506454 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b: BEGIN
[0m00:31:10.506576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.506778 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.506906 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b"
[0m00:31:10.507038 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gross_profit_per_item
from "jaffle_platform"."main"."order_items"
where gross_profit_per_item is null



  
  
      
    ) dbt_internal_test
[0m00:31:10.507466 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.508357 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b: ROLLBACK
[0m00:31:10.508633 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b'
[0m00:31:10.508766 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b: Close
[0m00:31:10.508969 [info ] [Thread-1 (]: 53 of 96 PASS not_null_order_items_gross_profit_per_item ....................... [[32mPASS[0m in 0.01s]
[0m00:31:10.509168 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b
[0m00:31:10.509313 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a
[0m00:31:10.509526 [info ] [Thread-1 (]: 54 of 96 START test not_null_order_items_is_drink_item ......................... [RUN]
[0m00:31:10.509780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b, now test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a)
[0m00:31:10.509942 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a
[0m00:31:10.511757 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a"
[0m00:31:10.512061 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a
[0m00:31:10.513071 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a"
[0m00:31:10.513362 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a"
[0m00:31:10.513505 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a: BEGIN
[0m00:31:10.513646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.513933 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.514075 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a"
[0m00:31:10.514222 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_drink_item
from "jaffle_platform"."main"."order_items"
where is_drink_item is null



  
  
      
    ) dbt_internal_test
[0m00:31:10.514654 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.515426 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a: ROLLBACK
[0m00:31:10.515701 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a'
[0m00:31:10.515850 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a: Close
[0m00:31:10.516167 [info ] [Thread-1 (]: 54 of 96 PASS not_null_order_items_is_drink_item ............................... [[32mPASS[0m in 0.01s]
[0m00:31:10.516409 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a
[0m00:31:10.516584 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725
[0m00:31:10.516756 [info ] [Thread-1 (]: 55 of 96 START test not_null_order_items_is_food_item .......................... [RUN]
[0m00:31:10.516944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a, now test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725)
[0m00:31:10.517104 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725
[0m00:31:10.518861 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725"
[0m00:31:10.519217 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725
[0m00:31:10.520322 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725"
[0m00:31:10.520610 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725"
[0m00:31:10.520742 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725: BEGIN
[0m00:31:10.520864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.521107 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.521240 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725"
[0m00:31:10.521375 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_food_item
from "jaffle_platform"."main"."order_items"
where is_food_item is null



  
  
      
    ) dbt_internal_test
[0m00:31:10.521782 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.522536 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725: ROLLBACK
[0m00:31:10.522808 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725'
[0m00:31:10.522966 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725: Close
[0m00:31:10.523205 [info ] [Thread-1 (]: 55 of 96 PASS not_null_order_items_is_food_item ................................ [[32mPASS[0m in 0.01s]
[0m00:31:10.523422 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725
[0m00:31:10.523575 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_order_date.287d23d5d3
[0m00:31:10.523737 [info ] [Thread-1 (]: 56 of 96 START test not_null_order_items_order_date ............................ [RUN]
[0m00:31:10.523899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725, now test.jaffle_platform.not_null_order_items_order_date.287d23d5d3)
[0m00:31:10.524040 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_order_date.287d23d5d3
[0m00:31:10.525781 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_order_date.287d23d5d3"
[0m00:31:10.526056 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_order_date.287d23d5d3
[0m00:31:10.528022 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_order_date.287d23d5d3"
[0m00:31:10.528287 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_order_date.287d23d5d3"
[0m00:31:10.528421 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_date.287d23d5d3: BEGIN
[0m00:31:10.528544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.528774 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.528912 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_order_date.287d23d5d3"
[0m00:31:10.529049 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_date.287d23d5d3: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_order_date.287d23d5d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "jaffle_platform"."main"."order_items"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m00:31:10.529429 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.530254 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_date.287d23d5d3: ROLLBACK
[0m00:31:10.530491 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_order_date.287d23d5d3'
[0m00:31:10.530625 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_date.287d23d5d3: Close
[0m00:31:10.530832 [info ] [Thread-1 (]: 56 of 96 PASS not_null_order_items_order_date .................................. [[32mPASS[0m in 0.01s]
[0m00:31:10.531023 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_order_date.287d23d5d3
[0m00:31:10.531161 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_order_id.0207cf2b74
[0m00:31:10.531355 [info ] [Thread-1 (]: 57 of 96 START test not_null_order_items_order_id .............................. [RUN]
[0m00:31:10.531587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_order_date.287d23d5d3, now test.jaffle_platform.not_null_order_items_order_id.0207cf2b74)
[0m00:31:10.531745 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_order_id.0207cf2b74
[0m00:31:10.533679 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_order_id.0207cf2b74"
[0m00:31:10.533950 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_order_id.0207cf2b74
[0m00:31:10.534955 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_order_id.0207cf2b74"
[0m00:31:10.535226 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_order_id.0207cf2b74"
[0m00:31:10.535358 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_id.0207cf2b74: BEGIN
[0m00:31:10.535478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.535679 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.535799 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_order_id.0207cf2b74"
[0m00:31:10.535931 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_id.0207cf2b74: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_order_id.0207cf2b74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "jaffle_platform"."main"."order_items"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m00:31:10.536317 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.537017 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_id.0207cf2b74: ROLLBACK
[0m00:31:10.537224 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_order_id.0207cf2b74'
[0m00:31:10.537351 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_id.0207cf2b74: Close
[0m00:31:10.537575 [info ] [Thread-1 (]: 57 of 96 PASS not_null_order_items_order_id .................................... [[32mPASS[0m in 0.01s]
[0m00:31:10.537773 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_order_id.0207cf2b74
[0m00:31:10.537916 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd
[0m00:31:10.538058 [info ] [Thread-1 (]: 58 of 96 START test not_null_order_items_order_item_id ......................... [RUN]
[0m00:31:10.538300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_order_id.0207cf2b74, now test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd)
[0m00:31:10.538467 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd
[0m00:31:10.540252 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd"
[0m00:31:10.540593 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd
[0m00:31:10.541677 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd"
[0m00:31:10.541957 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd"
[0m00:31:10.542086 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd: BEGIN
[0m00:31:10.542204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.542424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.542570 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd"
[0m00:31:10.542708 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from "jaffle_platform"."main"."order_items"
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m00:31:10.543098 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.543779 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd: ROLLBACK
[0m00:31:10.544002 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd'
[0m00:31:10.544139 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd: Close
[0m00:31:10.544345 [info ] [Thread-1 (]: 58 of 96 PASS not_null_order_items_order_item_id ............................... [[32mPASS[0m in 0.01s]
[0m00:31:10.544535 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd
[0m00:31:10.544673 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32
[0m00:31:10.544892 [info ] [Thread-1 (]: 59 of 96 START test not_null_order_items_product_id ............................ [RUN]
[0m00:31:10.545136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd, now test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32)
[0m00:31:10.545304 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32
[0m00:31:10.547089 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32"
[0m00:31:10.547444 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32
[0m00:31:10.548472 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32"
[0m00:31:10.548770 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32"
[0m00:31:10.548913 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32: BEGIN
[0m00:31:10.549044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.549332 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.549543 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32"
[0m00:31:10.549712 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "jaffle_platform"."main"."order_items"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m00:31:10.550075 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.550835 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32: ROLLBACK
[0m00:31:10.551047 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32'
[0m00:31:10.551180 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32: Close
[0m00:31:10.551387 [info ] [Thread-1 (]: 59 of 96 PASS not_null_order_items_product_id .................................. [[32mPASS[0m in 0.01s]
[0m00:31:10.551583 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32
[0m00:31:10.551723 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d
[0m00:31:10.551916 [info ] [Thread-1 (]: 60 of 96 START test not_null_order_items_product_name .......................... [RUN]
[0m00:31:10.552140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32, now test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d)
[0m00:31:10.552291 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d
[0m00:31:10.553974 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d"
[0m00:31:10.554252 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d
[0m00:31:10.556451 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d"
[0m00:31:10.556820 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d"
[0m00:31:10.556995 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d: BEGIN
[0m00:31:10.557151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.557410 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.557554 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d"
[0m00:31:10.557745 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "jaffle_platform"."main"."order_items"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m00:31:10.558155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.558914 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d: ROLLBACK
[0m00:31:10.559202 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d'
[0m00:31:10.559356 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d: Close
[0m00:31:10.559564 [info ] [Thread-1 (]: 60 of 96 PASS not_null_order_items_product_name ................................ [[32mPASS[0m in 0.01s]
[0m00:31:10.559760 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d
[0m00:31:10.559905 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_product_price.9e29b4995d
[0m00:31:10.560134 [info ] [Thread-1 (]: 61 of 96 START test not_null_order_items_product_price ......................... [RUN]
[0m00:31:10.560387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d, now test.jaffle_platform.not_null_order_items_product_price.9e29b4995d)
[0m00:31:10.560547 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_product_price.9e29b4995d
[0m00:31:10.562278 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_product_price.9e29b4995d"
[0m00:31:10.562620 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_product_price.9e29b4995d
[0m00:31:10.563563 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_product_price.9e29b4995d"
[0m00:31:10.563842 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_product_price.9e29b4995d"
[0m00:31:10.563977 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_price.9e29b4995d: BEGIN
[0m00:31:10.564104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.564359 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.564547 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_product_price.9e29b4995d"
[0m00:31:10.564704 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_price.9e29b4995d: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_product_price.9e29b4995d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_price
from "jaffle_platform"."main"."order_items"
where product_price is null



  
  
      
    ) dbt_internal_test
[0m00:31:10.565197 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.565983 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_price.9e29b4995d: ROLLBACK
[0m00:31:10.566286 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_product_price.9e29b4995d'
[0m00:31:10.566444 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_price.9e29b4995d: Close
[0m00:31:10.566670 [info ] [Thread-1 (]: 61 of 96 PASS not_null_order_items_product_price ............................... [[32mPASS[0m in 0.01s]
[0m00:31:10.566871 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_product_price.9e29b4995d
[0m00:31:10.567014 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_store_id.dcf872af5c
[0m00:31:10.567280 [info ] [Thread-1 (]: 62 of 96 START test not_null_order_items_store_id .............................. [RUN]
[0m00:31:10.567525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_product_price.9e29b4995d, now test.jaffle_platform.not_null_order_items_store_id.dcf872af5c)
[0m00:31:10.567670 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_store_id.dcf872af5c
[0m00:31:10.569239 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_store_id.dcf872af5c"
[0m00:31:10.569494 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_store_id.dcf872af5c
[0m00:31:10.570418 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_store_id.dcf872af5c"
[0m00:31:10.570666 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_store_id.dcf872af5c"
[0m00:31:10.570798 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_store_id.dcf872af5c: BEGIN
[0m00:31:10.570921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.571164 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.571354 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_store_id.dcf872af5c"
[0m00:31:10.571511 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_store_id.dcf872af5c: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_store_id.dcf872af5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "jaffle_platform"."main"."order_items"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m00:31:10.571956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.572703 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_store_id.dcf872af5c: ROLLBACK
[0m00:31:10.572925 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_store_id.dcf872af5c'
[0m00:31:10.573055 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_store_id.dcf872af5c: Close
[0m00:31:10.573248 [info ] [Thread-1 (]: 62 of 96 PASS not_null_order_items_store_id .................................... [[32mPASS[0m in 0.01s]
[0m00:31:10.573433 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_store_id.dcf872af5c
[0m00:31:10.573572 [debug] [Thread-1 (]: Began running node test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221
[0m00:31:10.573773 [info ] [Thread-1 (]: 63 of 96 START test relationships_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m00:31:10.574029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_store_id.dcf872af5c, now test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221)
[0m00:31:10.574214 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221
[0m00:31:10.576414 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221"
[0m00:31:10.576688 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221
[0m00:31:10.577704 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221"
[0m00:31:10.577957 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221"
[0m00:31:10.578094 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221: BEGIN
[0m00:31:10.578219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.578432 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.578563 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221"
[0m00:31:10.578715 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "jaffle_platform"."main"."order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "jaffle_platform"."main"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:31:10.581720 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:31:10.582532 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221: ROLLBACK
[0m00:31:10.582801 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221'
[0m00:31:10.582964 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221: Close
[0m00:31:10.583257 [info ] [Thread-1 (]: 63 of 96 PASS relationships_order_items_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.01s]
[0m00:31:10.583488 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221
[0m00:31:10.583659 [debug] [Thread-1 (]: Began running node test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d
[0m00:31:10.583849 [info ] [Thread-1 (]: 64 of 96 START test relationships_order_items_store_id__store_id__ref_stg_stores_  [RUN]
[0m00:31:10.584060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221, now test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d)
[0m00:31:10.584233 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d
[0m00:31:10.586432 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d"
[0m00:31:10.586730 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d
[0m00:31:10.588815 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d"
[0m00:31:10.589093 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d"
[0m00:31:10.589243 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d: BEGIN
[0m00:31:10.589375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.589659 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.589855 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d"
[0m00:31:10.590017 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_id as from_field
    from "jaffle_platform"."main"."order_items"
    where store_id is not null
),

parent as (
    select store_id as to_field
    from "jaffle_platform"."main"."stg_stores"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:31:10.593521 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:31:10.594394 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d: ROLLBACK
[0m00:31:10.594659 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d'
[0m00:31:10.594799 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d: Close
[0m00:31:10.595029 [info ] [Thread-1 (]: 64 of 96 PASS relationships_order_items_store_id__store_id__ref_stg_stores_ .... [[32mPASS[0m in 0.01s]
[0m00:31:10.595254 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d
[0m00:31:10.595410 [debug] [Thread-1 (]: Began running node test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a
[0m00:31:10.595570 [info ] [Thread-1 (]: 65 of 96 START test unique_order_items_order_item_id ........................... [RUN]
[0m00:31:10.595743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d, now test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a)
[0m00:31:10.595939 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a
[0m00:31:10.597580 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a"
[0m00:31:10.597862 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a
[0m00:31:10.598809 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a"
[0m00:31:10.599094 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a"
[0m00:31:10.599227 [debug] [Thread-1 (]: On test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a: BEGIN
[0m00:31:10.599349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.599604 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.599741 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a"
[0m00:31:10.599883 [debug] [Thread-1 (]: On test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."order_items"
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:10.621471 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m00:31:10.622299 [debug] [Thread-1 (]: On test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a: ROLLBACK
[0m00:31:10.622592 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a'
[0m00:31:10.622740 [debug] [Thread-1 (]: On test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a: Close
[0m00:31:10.623022 [info ] [Thread-1 (]: 65 of 96 PASS unique_order_items_order_item_id ................................. [[32mPASS[0m in 0.03s]
[0m00:31:10.623247 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a
[0m00:31:10.623693 [debug] [Thread-1 (]: Began running node model.jaffle_platform.orders
[0m00:31:10.624038 [info ] [Thread-1 (]: 66 of 96 START sql table model main.orders ..................................... [RUN]
[0m00:31:10.624293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a, now model.jaffle_platform.orders)
[0m00:31:10.624552 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.orders
[0m00:31:10.626890 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.orders"
[0m00:31:10.627330 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.orders
[0m00:31:10.628788 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.orders"
[0m00:31:10.629122 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.orders"
[0m00:31:10.629270 [debug] [Thread-1 (]: On model.jaffle_platform.orders: BEGIN
[0m00:31:10.629467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:10.629776 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:10.629967 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.orders"
[0m00:31:10.630176 [debug] [Thread-1 (]: On model.jaffle_platform.orders: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.orders"} */

  
    
    

    create  table
      "jaffle_platform"."main"."orders__dbt_tmp"
  
    as (
      with orders as (

    select * from "jaffle_platform"."main"."stg_orders"

),

order_items as (

    select * from "jaffle_platform"."main"."order_items"

),

order_items_summary as (

    select
        order_id,
        
        sum(case when is_food_item then 1 else 0 end) as food_items_count,
        sum(case when is_drink_item then 1 else 0 end) as drink_items_count,
        count(*) as total_items_count,

        
    round(1.0 * sum(case when is_food_item then product_price * 100 else 0 end) / 100, 2)
 as food_revenue,
        
    round(1.0 * sum(case when is_drink_item then product_price * 100 else 0 end) / 100, 2)
 as drink_revenue,
        
    round(1.0 * sum(product_price * 100) / 100, 2)
 as total_revenue,

        
    round(1.0 * sum(case when is_food_item then supply_cost * 100 else 0 end) / 100, 2)
 as food_cost,
        
    round(1.0 * sum(case when is_drink_item then supply_cost * 100 else 0 end) / 100, 2)
 as drink_cost,
        
    round(1.0 * sum(supply_cost * 100) / 100, 2)
 as total_cost,

        
    round(1.0 * sum(case when is_food_item then gross_profit_per_item * 100 else 0 end) / 100, 2)
 as food_profit,
        
    round(1.0 * sum(case when is_drink_item then gross_profit_per_item * 100 else 0 end) / 100, 2)
 as drink_profit,
        
    round(1.0 * sum(gross_profit_per_item * 100) / 100, 2)
 as total_profit

    from order_items
    group by 1

),

joined as (

    select
        orders.order_id,
        orders.customer_id,
        orders.store_id,
        orders.order_date,
        orders.status,

        order_items_summary.food_items_count,
        order_items_summary.drink_items_count,
        order_items_summary.total_items_count,

        order_items_summary.food_revenue,
        order_items_summary.drink_revenue,
        order_items_summary.total_revenue,

        order_items_summary.food_cost,
        order_items_summary.drink_cost,
        order_items_summary.total_cost,

        order_items_summary.food_profit,
        order_items_summary.drink_profit,
        order_items_summary.total_profit

    from orders

    inner join order_items_summary using (order_id)

)

select * from joined
    );
  
  
[0m00:31:11.234034 [debug] [Thread-1 (]: SQL status: OK in 0.604 seconds
[0m00:31:11.235622 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.orders"
[0m00:31:11.235795 [debug] [Thread-1 (]: On model.jaffle_platform.orders: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.orders"} */
alter table "jaffle_platform"."main"."orders" rename to "orders__dbt_backup"
[0m00:31:11.236119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.237265 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.orders"
[0m00:31:11.237404 [debug] [Thread-1 (]: On model.jaffle_platform.orders: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.orders"} */
alter table "jaffle_platform"."main"."orders__dbt_tmp" rename to "orders"
[0m00:31:11.237633 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.238138 [debug] [Thread-1 (]: On model.jaffle_platform.orders: COMMIT
[0m00:31:11.238273 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.orders"
[0m00:31:11.238394 [debug] [Thread-1 (]: On model.jaffle_platform.orders: COMMIT
[0m00:31:11.284050 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m00:31:11.285297 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.orders"
[0m00:31:11.285459 [debug] [Thread-1 (]: On model.jaffle_platform.orders: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.orders"} */
drop table if exists "jaffle_platform"."main"."orders__dbt_backup" cascade
[0m00:31:11.285996 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.286541 [debug] [Thread-1 (]: On model.jaffle_platform.orders: Close
[0m00:31:11.286789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f8c90>]}
[0m00:31:11.287055 [info ] [Thread-1 (]: 66 of 96 OK created sql table model main.orders ................................ [[32mOK[0m in 0.66s]
[0m00:31:11.287276 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.orders
[0m00:31:11.287669 [debug] [Thread-1 (]: Began running node test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484
[0m00:31:11.287839 [info ] [Thread-1 (]: 67 of 96 START test accepted_values_orders_status__completed ................... [RUN]
[0m00:31:11.288014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.orders, now test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484)
[0m00:31:11.288161 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484
[0m00:31:11.291039 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484"
[0m00:31:11.291406 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484
[0m00:31:11.292355 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484"
[0m00:31:11.292689 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484"
[0m00:31:11.292829 [debug] [Thread-1 (]: On test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484: BEGIN
[0m00:31:11.292961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.293194 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.293325 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484"
[0m00:31:11.293476 [debug] [Thread-1 (]: On test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "jaffle_platform"."main"."orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed'
)



  
  
      
    ) dbt_internal_test
[0m00:31:11.294730 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:11.295473 [debug] [Thread-1 (]: On test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484: ROLLBACK
[0m00:31:11.295741 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484'
[0m00:31:11.295895 [debug] [Thread-1 (]: On test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484: Close
[0m00:31:11.296217 [info ] [Thread-1 (]: 67 of 96 PASS accepted_values_orders_status__completed ......................... [[32mPASS[0m in 0.01s]
[0m00:31:11.296551 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484
[0m00:31:11.296717 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd
[0m00:31:11.296965 [info ] [Thread-1 (]: 68 of 96 START test dbt_utils_accepted_range_orders_total_cost__0 .............. [RUN]
[0m00:31:11.297288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484, now test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd)
[0m00:31:11.297469 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd
[0m00:31:11.299281 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd"
[0m00:31:11.299594 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd
[0m00:31:11.300586 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd"
[0m00:31:11.300913 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd"
[0m00:31:11.301067 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd: BEGIN
[0m00:31:11.301203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.301443 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.301579 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd"
[0m00:31:11.301730 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_cost >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:11.302497 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:11.303150 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd: ROLLBACK
[0m00:31:11.303382 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd'
[0m00:31:11.303532 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd: Close
[0m00:31:11.303757 [info ] [Thread-1 (]: 68 of 96 PASS dbt_utils_accepted_range_orders_total_cost__0 .................... [[32mPASS[0m in 0.01s]
[0m00:31:11.303954 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd
[0m00:31:11.304099 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7
[0m00:31:11.304303 [info ] [Thread-1 (]: 69 of 96 START test dbt_utils_accepted_range_orders_total_items_count__1 ....... [RUN]
[0m00:31:11.304517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd, now test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7)
[0m00:31:11.304681 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7
[0m00:31:11.306321 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7"
[0m00:31:11.306595 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7
[0m00:31:11.307619 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7"
[0m00:31:11.308035 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7"
[0m00:31:11.308205 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7: BEGIN
[0m00:31:11.308345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.308565 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.308705 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7"
[0m00:31:11.308869 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_items_count >= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:11.309491 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.310064 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7: ROLLBACK
[0m00:31:11.310263 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7'
[0m00:31:11.310399 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7: Close
[0m00:31:11.310610 [info ] [Thread-1 (]: 69 of 96 PASS dbt_utils_accepted_range_orders_total_items_count__1 ............. [[32mPASS[0m in 0.01s]
[0m00:31:11.310804 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7
[0m00:31:11.310945 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca
[0m00:31:11.311154 [info ] [Thread-1 (]: 70 of 96 START test dbt_utils_accepted_range_orders_total_revenue__0 ........... [RUN]
[0m00:31:11.311424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7, now test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca)
[0m00:31:11.311603 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca
[0m00:31:11.313437 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca"
[0m00:31:11.313742 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca
[0m00:31:11.314890 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca"
[0m00:31:11.315168 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca"
[0m00:31:11.315304 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca: BEGIN
[0m00:31:11.315434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.315691 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.315819 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca"
[0m00:31:11.315971 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_revenue >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:11.316685 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:11.317317 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca: ROLLBACK
[0m00:31:11.317530 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca'
[0m00:31:11.317666 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca: Close
[0m00:31:11.317869 [info ] [Thread-1 (]: 70 of 96 PASS dbt_utils_accepted_range_orders_total_revenue__0 ................. [[32mPASS[0m in 0.01s]
[0m00:31:11.318068 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca
[0m00:31:11.318210 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_orders_customer_id.c5f02694af
[0m00:31:11.318412 [info ] [Thread-1 (]: 71 of 96 START test not_null_orders_customer_id ................................ [RUN]
[0m00:31:11.318649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca, now test.jaffle_platform.not_null_orders_customer_id.c5f02694af)
[0m00:31:11.318812 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_orders_customer_id.c5f02694af
[0m00:31:11.321800 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_orders_customer_id.c5f02694af"
[0m00:31:11.322239 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_orders_customer_id.c5f02694af
[0m00:31:11.323326 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_orders_customer_id.c5f02694af"
[0m00:31:11.323675 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_customer_id.c5f02694af"
[0m00:31:11.323843 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_customer_id.c5f02694af: BEGIN
[0m00:31:11.323972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.324185 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.324312 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_customer_id.c5f02694af"
[0m00:31:11.324446 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_customer_id.c5f02694af: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_orders_customer_id.c5f02694af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "jaffle_platform"."main"."orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m00:31:11.324841 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.325539 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_customer_id.c5f02694af: ROLLBACK
[0m00:31:11.325824 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_orders_customer_id.c5f02694af'
[0m00:31:11.325984 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_customer_id.c5f02694af: Close
[0m00:31:11.326252 [info ] [Thread-1 (]: 71 of 96 PASS not_null_orders_customer_id ...................................... [[32mPASS[0m in 0.01s]
[0m00:31:11.326486 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_orders_customer_id.c5f02694af
[0m00:31:11.326662 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_orders_order_date.6910a855fe
[0m00:31:11.326826 [info ] [Thread-1 (]: 72 of 96 START test not_null_orders_order_date ................................. [RUN]
[0m00:31:11.326990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_orders_customer_id.c5f02694af, now test.jaffle_platform.not_null_orders_order_date.6910a855fe)
[0m00:31:11.327129 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_orders_order_date.6910a855fe
[0m00:31:11.328905 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_orders_order_date.6910a855fe"
[0m00:31:11.329216 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_orders_order_date.6910a855fe
[0m00:31:11.330225 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_orders_order_date.6910a855fe"
[0m00:31:11.330483 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_order_date.6910a855fe"
[0m00:31:11.330614 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_order_date.6910a855fe: BEGIN
[0m00:31:11.330733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.330963 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.331109 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_order_date.6910a855fe"
[0m00:31:11.331255 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_order_date.6910a855fe: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_orders_order_date.6910a855fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "jaffle_platform"."main"."orders"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m00:31:11.331660 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.332329 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_order_date.6910a855fe: ROLLBACK
[0m00:31:11.332561 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_orders_order_date.6910a855fe'
[0m00:31:11.332740 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_order_date.6910a855fe: Close
[0m00:31:11.333048 [info ] [Thread-1 (]: 72 of 96 PASS not_null_orders_order_date ....................................... [[32mPASS[0m in 0.01s]
[0m00:31:11.333270 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_orders_order_date.6910a855fe
[0m00:31:11.333417 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_orders_order_id.cf6c17daed
[0m00:31:11.333626 [info ] [Thread-1 (]: 73 of 96 START test not_null_orders_order_id ................................... [RUN]
[0m00:31:11.333854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_orders_order_date.6910a855fe, now test.jaffle_platform.not_null_orders_order_id.cf6c17daed)
[0m00:31:11.334011 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_orders_order_id.cf6c17daed
[0m00:31:11.335848 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_orders_order_id.cf6c17daed"
[0m00:31:11.336209 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_orders_order_id.cf6c17daed
[0m00:31:11.337215 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_orders_order_id.cf6c17daed"
[0m00:31:11.337501 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_order_id.cf6c17daed"
[0m00:31:11.337643 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_order_id.cf6c17daed: BEGIN
[0m00:31:11.337771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.338087 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.338222 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_order_id.cf6c17daed"
[0m00:31:11.338364 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_order_id.cf6c17daed: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_orders_order_id.cf6c17daed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "jaffle_platform"."main"."orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m00:31:11.338821 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.339487 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_order_id.cf6c17daed: ROLLBACK
[0m00:31:11.339711 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_orders_order_id.cf6c17daed'
[0m00:31:11.339844 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_order_id.cf6c17daed: Close
[0m00:31:11.340044 [info ] [Thread-1 (]: 73 of 96 PASS not_null_orders_order_id ......................................... [[32mPASS[0m in 0.01s]
[0m00:31:11.340234 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_orders_order_id.cf6c17daed
[0m00:31:11.340379 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_orders_status.8a27272c0a
[0m00:31:11.340566 [info ] [Thread-1 (]: 74 of 96 START test not_null_orders_status ..................................... [RUN]
[0m00:31:11.340792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_orders_order_id.cf6c17daed, now test.jaffle_platform.not_null_orders_status.8a27272c0a)
[0m00:31:11.340950 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_orders_status.8a27272c0a
[0m00:31:11.342744 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_orders_status.8a27272c0a"
[0m00:31:11.343172 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_orders_status.8a27272c0a
[0m00:31:11.344248 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_orders_status.8a27272c0a"
[0m00:31:11.344562 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_status.8a27272c0a"
[0m00:31:11.344696 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_status.8a27272c0a: BEGIN
[0m00:31:11.344821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.345065 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.345211 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_status.8a27272c0a"
[0m00:31:11.345351 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_status.8a27272c0a: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_orders_status.8a27272c0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "jaffle_platform"."main"."orders"
where status is null



  
  
      
    ) dbt_internal_test
[0m00:31:11.345717 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.346478 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_status.8a27272c0a: ROLLBACK
[0m00:31:11.346725 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_orders_status.8a27272c0a'
[0m00:31:11.346861 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_status.8a27272c0a: Close
[0m00:31:11.347142 [info ] [Thread-1 (]: 74 of 96 PASS not_null_orders_status ........................................... [[32mPASS[0m in 0.01s]
[0m00:31:11.347377 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_orders_status.8a27272c0a
[0m00:31:11.347525 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04
[0m00:31:11.347737 [info ] [Thread-1 (]: 75 of 96 START test not_null_orders_store_id ................................... [RUN]
[0m00:31:11.347996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_orders_status.8a27272c0a, now test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04)
[0m00:31:11.348166 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04
[0m00:31:11.351461 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04"
[0m00:31:11.351736 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04
[0m00:31:11.352718 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04"
[0m00:31:11.352962 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04"
[0m00:31:11.353097 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04: BEGIN
[0m00:31:11.353223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.353486 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.353678 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04"
[0m00:31:11.353839 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "jaffle_platform"."main"."orders"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m00:31:11.354359 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.355075 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04: ROLLBACK
[0m00:31:11.355309 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04'
[0m00:31:11.355449 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04: Close
[0m00:31:11.355680 [info ] [Thread-1 (]: 75 of 96 PASS not_null_orders_store_id ......................................... [[32mPASS[0m in 0.01s]
[0m00:31:11.355907 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04
[0m00:31:11.356073 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_orders_total_items_count.553bda7b77
[0m00:31:11.356260 [info ] [Thread-1 (]: 76 of 96 START test not_null_orders_total_items_count .......................... [RUN]
[0m00:31:11.356458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04, now test.jaffle_platform.not_null_orders_total_items_count.553bda7b77)
[0m00:31:11.356611 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_orders_total_items_count.553bda7b77
[0m00:31:11.358492 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_orders_total_items_count.553bda7b77"
[0m00:31:11.358768 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_orders_total_items_count.553bda7b77
[0m00:31:11.359782 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_orders_total_items_count.553bda7b77"
[0m00:31:11.360030 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_total_items_count.553bda7b77"
[0m00:31:11.360159 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_items_count.553bda7b77: BEGIN
[0m00:31:11.360278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.360475 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.360600 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_total_items_count.553bda7b77"
[0m00:31:11.360738 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_items_count.553bda7b77: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_orders_total_items_count.553bda7b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_items_count
from "jaffle_platform"."main"."orders"
where total_items_count is null



  
  
      
    ) dbt_internal_test
[0m00:31:11.361156 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.361971 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_items_count.553bda7b77: ROLLBACK
[0m00:31:11.362179 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_orders_total_items_count.553bda7b77'
[0m00:31:11.362315 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_items_count.553bda7b77: Close
[0m00:31:11.362531 [info ] [Thread-1 (]: 76 of 96 PASS not_null_orders_total_items_count ................................ [[32mPASS[0m in 0.01s]
[0m00:31:11.362754 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_orders_total_items_count.553bda7b77
[0m00:31:11.362906 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60
[0m00:31:11.363085 [info ] [Thread-1 (]: 77 of 96 START test not_null_orders_total_profit ............................... [RUN]
[0m00:31:11.363285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_orders_total_items_count.553bda7b77, now test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60)
[0m00:31:11.363441 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60
[0m00:31:11.365223 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60"
[0m00:31:11.365567 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60
[0m00:31:11.366619 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60"
[0m00:31:11.366938 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60"
[0m00:31:11.367084 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60: BEGIN
[0m00:31:11.367215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.367480 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.367627 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60"
[0m00:31:11.367770 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_profit
from "jaffle_platform"."main"."orders"
where total_profit is null



  
  
      
    ) dbt_internal_test
[0m00:31:11.368214 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.368909 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60: ROLLBACK
[0m00:31:11.369112 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60'
[0m00:31:11.369247 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60: Close
[0m00:31:11.369472 [info ] [Thread-1 (]: 77 of 96 PASS not_null_orders_total_profit ..................................... [[32mPASS[0m in 0.01s]
[0m00:31:11.369677 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60
[0m00:31:11.369821 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_orders_total_revenue.280ed887b4
[0m00:31:11.369985 [info ] [Thread-1 (]: 78 of 96 START test not_null_orders_total_revenue .............................. [RUN]
[0m00:31:11.370247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60, now test.jaffle_platform.not_null_orders_total_revenue.280ed887b4)
[0m00:31:11.370408 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_orders_total_revenue.280ed887b4
[0m00:31:11.372241 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_orders_total_revenue.280ed887b4"
[0m00:31:11.372563 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_orders_total_revenue.280ed887b4
[0m00:31:11.373569 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_orders_total_revenue.280ed887b4"
[0m00:31:11.373852 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_total_revenue.280ed887b4"
[0m00:31:11.373994 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_revenue.280ed887b4: BEGIN
[0m00:31:11.374121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.374421 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.374591 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_total_revenue.280ed887b4"
[0m00:31:11.374750 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_revenue.280ed887b4: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_orders_total_revenue.280ed887b4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "jaffle_platform"."main"."orders"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m00:31:11.375414 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.376089 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_revenue.280ed887b4: ROLLBACK
[0m00:31:11.376304 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_orders_total_revenue.280ed887b4'
[0m00:31:11.376446 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_revenue.280ed887b4: Close
[0m00:31:11.376661 [info ] [Thread-1 (]: 78 of 96 PASS not_null_orders_total_revenue .................................... [[32mPASS[0m in 0.01s]
[0m00:31:11.376862 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_orders_total_revenue.280ed887b4
[0m00:31:11.377005 [debug] [Thread-1 (]: Began running node test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c
[0m00:31:11.377213 [info ] [Thread-1 (]: 79 of 96 START test relationships_orders_store_id__store_id__ref_stg_stores_ ... [RUN]
[0m00:31:11.377452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_orders_total_revenue.280ed887b4, now test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c)
[0m00:31:11.377606 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c
[0m00:31:11.380771 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c"
[0m00:31:11.381151 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c
[0m00:31:11.382208 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c"
[0m00:31:11.382584 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c"
[0m00:31:11.382763 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c: BEGIN
[0m00:31:11.382895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.383176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.383349 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c"
[0m00:31:11.383551 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_id as from_field
    from "jaffle_platform"."main"."orders"
    where store_id is not null
),

parent as (
    select store_id as to_field
    from "jaffle_platform"."main"."stg_stores"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:31:11.385994 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:31:11.386733 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c: ROLLBACK
[0m00:31:11.386974 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c'
[0m00:31:11.387121 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c: Close
[0m00:31:11.387356 [info ] [Thread-1 (]: 79 of 96 PASS relationships_orders_store_id__store_id__ref_stg_stores_ ......... [[32mPASS[0m in 0.01s]
[0m00:31:11.387584 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c
[0m00:31:11.387748 [debug] [Thread-1 (]: Began running node test.jaffle_platform.unique_orders_order_id.fed79b3a6e
[0m00:31:11.387927 [info ] [Thread-1 (]: 80 of 96 START test unique_orders_order_id ..................................... [RUN]
[0m00:31:11.388116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c, now test.jaffle_platform.unique_orders_order_id.fed79b3a6e)
[0m00:31:11.388323 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.unique_orders_order_id.fed79b3a6e
[0m00:31:11.390109 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.unique_orders_order_id.fed79b3a6e"
[0m00:31:11.390409 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.unique_orders_order_id.fed79b3a6e
[0m00:31:11.391373 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.unique_orders_order_id.fed79b3a6e"
[0m00:31:11.391621 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_orders_order_id.fed79b3a6e"
[0m00:31:11.391756 [debug] [Thread-1 (]: On test.jaffle_platform.unique_orders_order_id.fed79b3a6e: BEGIN
[0m00:31:11.391875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.392087 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.392213 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_orders_order_id.fed79b3a6e"
[0m00:31:11.392347 [debug] [Thread-1 (]: On test.jaffle_platform.unique_orders_order_id.fed79b3a6e: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.unique_orders_order_id.fed79b3a6e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:11.405592 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m00:31:11.406476 [debug] [Thread-1 (]: On test.jaffle_platform.unique_orders_order_id.fed79b3a6e: ROLLBACK
[0m00:31:11.406739 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.unique_orders_order_id.fed79b3a6e'
[0m00:31:11.406892 [debug] [Thread-1 (]: On test.jaffle_platform.unique_orders_order_id.fed79b3a6e: Close
[0m00:31:11.407151 [info ] [Thread-1 (]: 80 of 96 PASS unique_orders_order_id ........................................... [[32mPASS[0m in 0.02s]
[0m00:31:11.407389 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.unique_orders_order_id.fed79b3a6e
[0m00:31:11.407799 [debug] [Thread-1 (]: Began running node model.jaffle_platform.customers
[0m00:31:11.408190 [info ] [Thread-1 (]: 81 of 96 START sql table model main.customers .................................. [RUN]
[0m00:31:11.408483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.unique_orders_order_id.fed79b3a6e, now model.jaffle_platform.customers)
[0m00:31:11.408686 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.customers
[0m00:31:11.411072 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.customers"
[0m00:31:11.411424 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.customers
[0m00:31:11.412821 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.customers"
[0m00:31:11.413111 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.customers"
[0m00:31:11.413245 [debug] [Thread-1 (]: On model.jaffle_platform.customers: BEGIN
[0m00:31:11.413367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.413633 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.413761 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.customers"
[0m00:31:11.413952 [debug] [Thread-1 (]: On model.jaffle_platform.customers: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.customers"} */

  
    
    

    create  table
      "jaffle_platform"."main"."customers__dbt_tmp"
  
    as (
      with customers as (

    select * from "jaffle_platform"."main"."stg_customers"

),

orders as (

    select * from "jaffle_platform"."main"."orders"

),

customer_orders as (

    select
        customer_id,
        
        min(order_date) as first_order_at,
        max(order_date) as most_recent_order_at,
        count(*) as number_of_orders,

        sum(food_items_count) as total_food_items,
        sum(drink_items_count) as total_drink_items,
        sum(total_items_count) as total_items,

        
    round(1.0 * sum(food_revenue * 100) / 100, 2)
 as total_food_revenue,
        
    round(1.0 * sum(drink_revenue * 100) / 100, 2)
 as total_drink_revenue,
        
    round(1.0 * sum(total_revenue * 100) / 100, 2)
 as total_revenue,

        
    round(1.0 * sum(food_cost * 100) / 100, 2)
 as total_food_cost,
        
    round(1.0 * sum(drink_cost * 100) / 100, 2)
 as total_drink_cost,
        
    round(1.0 * sum(total_cost * 100) / 100, 2)
 as total_cost,

        
    round(1.0 * sum(food_profit * 100) / 100, 2)
 as total_food_profit,
        
    round(1.0 * sum(drink_profit * 100) / 100, 2)
 as total_drink_profit,
        
    round(1.0 * sum(total_profit * 100) / 100, 2)
 as total_profit,

        
    round(1.0 * sum(total_revenue * 100) / nullif(count(*), 0) / 100, 2)
 as avg_order_value,
        
    round(1.0 * sum(total_profit * 100) / nullif(count(*), 0) / 100, 2)
 as avg_order_profit

    from orders
    group by 1

),

joined as (

    select
        customers.customer_id,
        customers.customer_name,

        customer_orders.first_order_at,
        customer_orders.most_recent_order_at,
        customer_orders.number_of_orders,

        customer_orders.total_food_items,
        customer_orders.total_drink_items,
        customer_orders.total_items,

        customer_orders.total_food_revenue,
        customer_orders.total_drink_revenue,
        customer_orders.total_revenue,

        customer_orders.total_food_cost,
        customer_orders.total_drink_cost,
        customer_orders.total_cost,

        customer_orders.total_food_profit,
        customer_orders.total_drink_profit,
        customer_orders.total_profit,

        customer_orders.avg_order_value,
        customer_orders.avg_order_profit

    from customers

    left join customer_orders using (customer_id)

)

select * from joined
    );
  
  
[0m00:31:11.424364 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m00:31:11.425890 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.customers"
[0m00:31:11.426082 [debug] [Thread-1 (]: On model.jaffle_platform.customers: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.customers"} */
alter table "jaffle_platform"."main"."customers" rename to "customers__dbt_backup"
[0m00:31:11.426376 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.427535 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.customers"
[0m00:31:11.427673 [debug] [Thread-1 (]: On model.jaffle_platform.customers: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.customers"} */
alter table "jaffle_platform"."main"."customers__dbt_tmp" rename to "customers"
[0m00:31:11.427911 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.428359 [debug] [Thread-1 (]: On model.jaffle_platform.customers: COMMIT
[0m00:31:11.428492 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.customers"
[0m00:31:11.428612 [debug] [Thread-1 (]: On model.jaffle_platform.customers: COMMIT
[0m00:31:11.429849 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:11.432333 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.customers"
[0m00:31:11.432517 [debug] [Thread-1 (]: On model.jaffle_platform.customers: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.customers"} */
drop table if exists "jaffle_platform"."main"."customers__dbt_backup" cascade
[0m00:31:11.432955 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.433511 [debug] [Thread-1 (]: On model.jaffle_platform.customers: Close
[0m00:31:11.433760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4c09fe-f0c2-47a7-a9a1-3d30f6984019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ccdd0>]}
[0m00:31:11.434016 [info ] [Thread-1 (]: 81 of 96 OK created sql table model main.customers ............................. [[32mOK[0m in 0.03s]
[0m00:31:11.434238 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.customers
[0m00:31:11.434614 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c
[0m00:31:11.434780 [info ] [Thread-1 (]: 82 of 96 START test dbt_utils_accepted_range_customers_avg_order_value__0 ...... [RUN]
[0m00:31:11.434949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.customers, now test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c)
[0m00:31:11.435093 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c
[0m00:31:11.436958 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c"
[0m00:31:11.437411 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c
[0m00:31:11.438433 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c"
[0m00:31:11.438793 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c"
[0m00:31:11.438939 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c: BEGIN
[0m00:31:11.439076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.439331 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.439475 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c"
[0m00:31:11.439630 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_order_value >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:11.440342 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:11.441029 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c: ROLLBACK
[0m00:31:11.441279 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c'
[0m00:31:11.441417 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c: Close
[0m00:31:11.441648 [info ] [Thread-1 (]: 82 of 96 PASS dbt_utils_accepted_range_customers_avg_order_value__0 ............ [[32mPASS[0m in 0.01s]
[0m00:31:11.441861 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c
[0m00:31:11.442023 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b
[0m00:31:11.442177 [info ] [Thread-1 (]: 83 of 96 START test dbt_utils_accepted_range_customers_number_of_orders__0 ..... [RUN]
[0m00:31:11.442467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c, now test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b)
[0m00:31:11.442683 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b
[0m00:31:11.444495 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b"
[0m00:31:11.444805 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b
[0m00:31:11.445765 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b"
[0m00:31:11.446057 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b"
[0m00:31:11.446202 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b: BEGIN
[0m00:31:11.446335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.446570 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.446705 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b"
[0m00:31:11.446860 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not number_of_orders >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:11.447625 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:11.448286 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b: ROLLBACK
[0m00:31:11.448521 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b'
[0m00:31:11.448663 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b: Close
[0m00:31:11.449012 [info ] [Thread-1 (]: 83 of 96 PASS dbt_utils_accepted_range_customers_number_of_orders__0 ........... [[32mPASS[0m in 0.01s]
[0m00:31:11.449238 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b
[0m00:31:11.449398 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a
[0m00:31:11.449628 [info ] [Thread-1 (]: 84 of 96 START test dbt_utils_accepted_range_customers_total_cost__0 ........... [RUN]
[0m00:31:11.449870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a)
[0m00:31:11.450037 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a
[0m00:31:11.451985 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a"
[0m00:31:11.452356 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a
[0m00:31:11.453432 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a"
[0m00:31:11.453702 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a"
[0m00:31:11.453840 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a: BEGIN
[0m00:31:11.453966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.454196 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.454358 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a"
[0m00:31:11.454519 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_cost >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:11.455162 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.455868 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a: ROLLBACK
[0m00:31:11.456098 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a'
[0m00:31:11.456228 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a: Close
[0m00:31:11.456426 [info ] [Thread-1 (]: 84 of 96 PASS dbt_utils_accepted_range_customers_total_cost__0 ................. [[32mPASS[0m in 0.01s]
[0m00:31:11.456630 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a
[0m00:31:11.456777 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f
[0m00:31:11.456987 [info ] [Thread-1 (]: 85 of 96 START test dbt_utils_accepted_range_customers_total_drink_cost__0 ..... [RUN]
[0m00:31:11.457209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f)
[0m00:31:11.457379 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f
[0m00:31:11.459238 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f"
[0m00:31:11.459533 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f
[0m00:31:11.461512 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f"
[0m00:31:11.461766 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f"
[0m00:31:11.461906 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f: BEGIN
[0m00:31:11.462035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.462316 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.462522 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f"
[0m00:31:11.462693 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_drink_cost >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:11.463452 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:11.464087 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f: ROLLBACK
[0m00:31:11.464348 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f'
[0m00:31:11.464501 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f: Close
[0m00:31:11.464746 [info ] [Thread-1 (]: 85 of 96 PASS dbt_utils_accepted_range_customers_total_drink_cost__0 ........... [[32mPASS[0m in 0.01s]
[0m00:31:11.464972 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f
[0m00:31:11.465151 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335
[0m00:31:11.465321 [info ] [Thread-1 (]: 86 of 96 START test dbt_utils_accepted_range_customers_total_drink_items__0 .... [RUN]
[0m00:31:11.465488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335)
[0m00:31:11.465706 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335
[0m00:31:11.467365 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335"
[0m00:31:11.467666 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335
[0m00:31:11.468679 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335"
[0m00:31:11.468951 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335"
[0m00:31:11.469086 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335: BEGIN
[0m00:31:11.469211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.469469 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.469664 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335"
[0m00:31:11.469824 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_drink_items >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:11.470467 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.471100 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335: ROLLBACK
[0m00:31:11.471323 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335'
[0m00:31:11.471457 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335: Close
[0m00:31:11.471679 [info ] [Thread-1 (]: 86 of 96 PASS dbt_utils_accepted_range_customers_total_drink_items__0 .......... [[32mPASS[0m in 0.01s]
[0m00:31:11.471875 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335
[0m00:31:11.472020 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4
[0m00:31:11.472205 [info ] [Thread-1 (]: 87 of 96 START test dbt_utils_accepted_range_customers_total_drink_revenue__0 .. [RUN]
[0m00:31:11.472432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4)
[0m00:31:11.472609 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4
[0m00:31:11.474605 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4"
[0m00:31:11.474866 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4
[0m00:31:11.475938 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4"
[0m00:31:11.476192 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4"
[0m00:31:11.476328 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4: BEGIN
[0m00:31:11.476451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.476664 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.476793 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4"
[0m00:31:11.476937 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_drink_revenue >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:11.477738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:11.478436 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4: ROLLBACK
[0m00:31:11.478677 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4'
[0m00:31:11.478836 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4: Close
[0m00:31:11.479106 [info ] [Thread-1 (]: 87 of 96 PASS dbt_utils_accepted_range_customers_total_drink_revenue__0 ........ [[32mPASS[0m in 0.01s]
[0m00:31:11.479347 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4
[0m00:31:11.479525 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802
[0m00:31:11.479717 [info ] [Thread-1 (]: 88 of 96 START test dbt_utils_accepted_range_customers_total_food_cost__0 ...... [RUN]
[0m00:31:11.479916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802)
[0m00:31:11.480077 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802
[0m00:31:11.481982 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802"
[0m00:31:11.482306 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802
[0m00:31:11.483619 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802"
[0m00:31:11.483885 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802"
[0m00:31:11.484018 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802: BEGIN
[0m00:31:11.484141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.484407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.484601 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802"
[0m00:31:11.484771 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_food_cost >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:11.485518 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:11.486104 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802: ROLLBACK
[0m00:31:11.486368 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802'
[0m00:31:11.486519 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802: Close
[0m00:31:11.486748 [info ] [Thread-1 (]: 88 of 96 PASS dbt_utils_accepted_range_customers_total_food_cost__0 ............ [[32mPASS[0m in 0.01s]
[0m00:31:11.486950 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802
[0m00:31:11.487091 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc
[0m00:31:11.487284 [info ] [Thread-1 (]: 89 of 96 START test dbt_utils_accepted_range_customers_total_food_items__0 ..... [RUN]
[0m00:31:11.487500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc)
[0m00:31:11.487654 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc
[0m00:31:11.489461 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc"
[0m00:31:11.489839 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc
[0m00:31:11.490811 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc"
[0m00:31:11.491172 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc"
[0m00:31:11.491356 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc: BEGIN
[0m00:31:11.491479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.491677 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.492979 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc"
[0m00:31:11.493126 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_food_items >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:11.493817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:11.494465 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc: ROLLBACK
[0m00:31:11.494698 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc'
[0m00:31:11.494853 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc: Close
[0m00:31:11.495093 [info ] [Thread-1 (]: 89 of 96 PASS dbt_utils_accepted_range_customers_total_food_items__0 ........... [[32mPASS[0m in 0.01s]
[0m00:31:11.495312 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc
[0m00:31:11.495468 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11
[0m00:31:11.495629 [info ] [Thread-1 (]: 90 of 96 START test dbt_utils_accepted_range_customers_total_food_revenue__0 ... [RUN]
[0m00:31:11.495791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11)
[0m00:31:11.495935 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11
[0m00:31:11.497628 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11"
[0m00:31:11.497989 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11
[0m00:31:11.499079 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11"
[0m00:31:11.499433 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11"
[0m00:31:11.499613 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11: BEGIN
[0m00:31:11.499741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.499941 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.500067 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11"
[0m00:31:11.500214 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_food_revenue >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:11.500793 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.501408 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11: ROLLBACK
[0m00:31:11.501632 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11'
[0m00:31:11.501776 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11: Close
[0m00:31:11.502007 [info ] [Thread-1 (]: 90 of 96 PASS dbt_utils_accepted_range_customers_total_food_revenue__0 ......... [[32mPASS[0m in 0.01s]
[0m00:31:11.502278 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11
[0m00:31:11.502431 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a
[0m00:31:11.502626 [info ] [Thread-1 (]: 91 of 96 START test dbt_utils_accepted_range_customers_total_items__0 .......... [RUN]
[0m00:31:11.502825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a)
[0m00:31:11.502983 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a
[0m00:31:11.504716 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a"
[0m00:31:11.505028 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a
[0m00:31:11.506071 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a"
[0m00:31:11.506358 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a"
[0m00:31:11.506501 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a: BEGIN
[0m00:31:11.506629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.506906 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.507045 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a"
[0m00:31:11.507197 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_items >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:11.507929 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:11.508575 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a: ROLLBACK
[0m00:31:11.508803 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a'
[0m00:31:11.508954 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a: Close
[0m00:31:11.509191 [info ] [Thread-1 (]: 91 of 96 PASS dbt_utils_accepted_range_customers_total_items__0 ................ [[32mPASS[0m in 0.01s]
[0m00:31:11.509410 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a
[0m00:31:11.509573 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785
[0m00:31:11.509789 [info ] [Thread-1 (]: 92 of 96 START test dbt_utils_accepted_range_customers_total_revenue__0 ........ [RUN]
[0m00:31:11.510055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785)
[0m00:31:11.510215 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785
[0m00:31:11.512105 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785"
[0m00:31:11.512441 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785
[0m00:31:11.513459 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785"
[0m00:31:11.513739 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785"
[0m00:31:11.513883 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785: BEGIN
[0m00:31:11.514007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.514236 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.514378 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785"
[0m00:31:11.514528 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_revenue >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:31:11.515153 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.515710 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785: ROLLBACK
[0m00:31:11.515927 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785'
[0m00:31:11.516073 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785: Close
[0m00:31:11.516293 [info ] [Thread-1 (]: 92 of 96 PASS dbt_utils_accepted_range_customers_total_revenue__0 .............. [[32mPASS[0m in 0.01s]
[0m00:31:11.516503 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785
[0m00:31:11.516654 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d
[0m00:31:11.516878 [info ] [Thread-1 (]: 93 of 96 START test not_null_customers_customer_id ............................. [RUN]
[0m00:31:11.517131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785, now test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d)
[0m00:31:11.517301 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d
[0m00:31:11.519215 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d"
[0m00:31:11.519537 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d
[0m00:31:11.520496 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d"
[0m00:31:11.520773 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d"
[0m00:31:11.520910 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d: BEGIN
[0m00:31:11.521038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.521307 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.521442 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d"
[0m00:31:11.521579 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "jaffle_platform"."main"."customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m00:31:11.522014 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.522568 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
[0m00:31:11.522769 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d'
[0m00:31:11.522901 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d: Close
[0m00:31:11.523098 [info ] [Thread-1 (]: 93 of 96 PASS not_null_customers_customer_id ................................... [[32mPASS[0m in 0.01s]
[0m00:31:11.523284 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d
[0m00:31:11.523419 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065
[0m00:31:11.523689 [info ] [Thread-1 (]: 94 of 96 START test not_null_customers_customer_name ........................... [RUN]
[0m00:31:11.523967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d, now test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065)
[0m00:31:11.524124 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065
[0m00:31:11.527100 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065"
[0m00:31:11.527451 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065
[0m00:31:11.528391 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065"
[0m00:31:11.528654 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065"
[0m00:31:11.528786 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065: BEGIN
[0m00:31:11.528920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.529156 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.529280 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065"
[0m00:31:11.529411 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_name
from "jaffle_platform"."main"."customers"
where customer_name is null



  
  
      
    ) dbt_internal_test
[0m00:31:11.529842 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.530532 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065: ROLLBACK
[0m00:31:11.530776 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065'
[0m00:31:11.530929 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065: Close
[0m00:31:11.531144 [info ] [Thread-1 (]: 94 of 96 PASS not_null_customers_customer_name ................................. [[32mPASS[0m in 0.01s]
[0m00:31:11.531345 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065
[0m00:31:11.531490 [debug] [Thread-1 (]: Began running node test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:31:11.531689 [info ] [Thread-1 (]: 95 of 96 START test relationships_orders_customer_id__customer_id__ref_customers_  [RUN]
[0m00:31:11.531931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065, now test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2)
[0m00:31:11.532126 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:31:11.534021 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:31:11.534292 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:31:11.535223 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:31:11.535488 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:31:11.535625 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: BEGIN
[0m00:31:11.535751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.536011 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.536224 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:31:11.536449 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "jaffle_platform"."main"."orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "jaffle_platform"."main"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:31:11.539438 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:31:11.540146 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: ROLLBACK
[0m00:31:11.540414 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2'
[0m00:31:11.540568 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: Close
[0m00:31:11.540814 [info ] [Thread-1 (]: 95 of 96 PASS relationships_orders_customer_id__customer_id__ref_customers_ .... [[32mPASS[0m in 0.01s]
[0m00:31:11.541059 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:31:11.541283 [debug] [Thread-1 (]: Began running node test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1
[0m00:31:11.541514 [info ] [Thread-1 (]: 96 of 96 START test unique_customers_customer_id ............................... [RUN]
[0m00:31:11.541760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2, now test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1)
[0m00:31:11.541931 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1
[0m00:31:11.543543 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1"
[0m00:31:11.543824 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1
[0m00:31:11.544777 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1"
[0m00:31:11.545027 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1"
[0m00:31:11.545157 [debug] [Thread-1 (]: On test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1: BEGIN
[0m00:31:11.545275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:11.545490 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:31:11.545613 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1"
[0m00:31:11.545746 [debug] [Thread-1 (]: On test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.9.8", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:31:11.546695 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:31:11.547291 [debug] [Thread-1 (]: On test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
[0m00:31:11.547499 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1'
[0m00:31:11.547633 [debug] [Thread-1 (]: On test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1: Close
[0m00:31:11.547831 [info ] [Thread-1 (]: 96 of 96 PASS unique_customers_customer_id ..................................... [[32mPASS[0m in 0.01s]
[0m00:31:11.548021 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1
[0m00:31:11.548624 [debug] [MainThread]: Using duckdb connection "master"
[0m00:31:11.548822 [debug] [MainThread]: On master: BEGIN
[0m00:31:11.548937 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:11.549187 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:31:11.549366 [debug] [MainThread]: On master: COMMIT
[0m00:31:11.549498 [debug] [MainThread]: Using duckdb connection "master"
[0m00:31:11.549605 [debug] [MainThread]: On master: COMMIT
[0m00:31:11.549799 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:31:11.549913 [debug] [MainThread]: On master: Close
[0m00:31:11.550067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:11.550172 [debug] [MainThread]: Connection 'test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m00:31:11.550361 [info ] [MainThread]: 
[0m00:31:11.550484 [info ] [MainThread]: Finished running 5 table models, 85 data tests, 6 view models in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m00:31:11.554275 [debug] [MainThread]: Command end result
[0m00:31:11.577543 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/thomastrividic/code/python/jaffle-platform/dbt/target/manifest.json
[0m00:31:11.578649 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/thomastrividic/code/python/jaffle-platform/dbt/target/semantic_manifest.json
[0m00:31:11.583067 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/thomastrividic/code/python/jaffle-platform/dbt/target/run_results.json
[0m00:31:11.583249 [info ] [MainThread]: 
[0m00:31:11.583422 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:11.583586 [info ] [MainThread]: 
[0m00:31:11.583722 [info ] [MainThread]: Done. PASS=96 WARN=0 ERROR=0 SKIP=0 TOTAL=96
[0m00:31:11.584086 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.1387067, "process_in_blocks": "0", "process_kernel_time": 0.645475, "process_mem_max_rss": "829014016", "process_out_blocks": "0", "process_user_time": 6.292984}
[0m00:31:11.584257 [debug] [MainThread]: Command `dbt build` succeeded at 00:31:11.584227 after 4.14 seconds
[0m00:31:11.584426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f729d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008b44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10072afd0>]}
[0m00:31:11.584584 [debug] [MainThread]: Flushing usage events
[0m00:31:11.997734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:34:08.171296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109322910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109322750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936dc10>]}


============================== 00:34:08.174102 | 9eb34dba-d935-4823-9de8-e70432cbbf81 ==============================
[0m00:34:08.174102 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:34:08.174408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/thomastrividic/code/python/jaffle-platform/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/thomastrividic/code/python/jaffle-platform/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m00:34:08.305918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703cbd0>]}
[0m00:34:08.338154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd1910>]}
[0m00:34:08.345605 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:34:08.420486 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:34:08.468008 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:34:08.468315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ab7d0>]}
[0m00:34:09.333405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109811310>]}
[0m00:34:09.376191 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/thomastrividic/code/python/jaffle-platform/dbt/target/manifest.json
[0m00:34:09.378015 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/thomastrividic/code/python/jaffle-platform/dbt/target/semantic_manifest.json
[0m00:34:09.415550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb7d50>]}
[0m00:34:09.415822 [info ] [MainThread]: Found 11 models, 85 data tests, 6 sources, 736 macros
[0m00:34:09.418835 [info ] [MainThread]: 
[0m00:34:09.419018 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:34:09.419149 [info ] [MainThread]: 
[0m00:34:09.419372 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:34:09.421669 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_platform'
[0m00:34:09.472771 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_platform"
[0m00:34:09.472981 [debug] [ThreadPool]: On list_jaffle_platform: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "connection_name": "list_jaffle_platform"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_platform"'
    
  
  
[0m00:34:09.473123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:09.521786 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m00:34:09.522398 [debug] [ThreadPool]: On list_jaffle_platform: Close
[0m00:34:09.522695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_platform, now create_jaffle_platform_main)
[0m00:34:09.522912 [debug] [ThreadPool]: Creating schema "database: "jaffle_platform"
schema: "main"
"
[0m00:34:09.526019 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_platform_main"
[0m00:34:09.526181 [debug] [ThreadPool]: On create_jaffle_platform_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "connection_name": "create_jaffle_platform_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_platform'
        and type='sqlite'
    
  
[0m00:34:09.526303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:34:09.526867 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:34:09.527395 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_platform_main"
[0m00:34:09.527517 [debug] [ThreadPool]: On create_jaffle_platform_main: BEGIN
[0m00:34:09.527705 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:09.527822 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_platform_main"
[0m00:34:09.527939 [debug] [ThreadPool]: On create_jaffle_platform_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "connection_name": "create_jaffle_platform_main"} */

    
    
        create schema if not exists "jaffle_platform"."main"
    
[0m00:34:09.528535 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:09.528933 [debug] [ThreadPool]: On create_jaffle_platform_main: COMMIT
[0m00:34:09.529083 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_platform_main"
[0m00:34:09.529206 [debug] [ThreadPool]: On create_jaffle_platform_main: COMMIT
[0m00:34:09.529399 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:09.529522 [debug] [ThreadPool]: On create_jaffle_platform_main: Close
[0m00:34:09.530249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_platform_main, now list_jaffle_platform_main)
[0m00:34:09.532527 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_platform_main"
[0m00:34:09.532660 [debug] [ThreadPool]: On list_jaffle_platform_main: BEGIN
[0m00:34:09.532770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:34:09.532962 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:09.533079 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_platform_main"
[0m00:34:09.533205 [debug] [ThreadPool]: On list_jaffle_platform_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "connection_name": "list_jaffle_platform_main"} */
select
      'jaffle_platform' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_platform'
  
[0m00:34:09.540280 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m00:34:09.541018 [debug] [ThreadPool]: On list_jaffle_platform_main: ROLLBACK
[0m00:34:09.541674 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_platform_main'
[0m00:34:09.541821 [debug] [ThreadPool]: On list_jaffle_platform_main: Close
[0m00:34:09.542977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d78450>]}
[0m00:34:09.543195 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:09.543313 [debug] [MainThread]: On master: BEGIN
[0m00:34:09.543422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:34:09.543628 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:34:09.543747 [debug] [MainThread]: On master: COMMIT
[0m00:34:09.543860 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:09.543970 [debug] [MainThread]: On master: COMMIT
[0m00:34:09.544160 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:34:09.544307 [debug] [MainThread]: On master: Close
[0m00:34:09.545469 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed
[0m00:34:09.545643 [info ] [Thread-1 (]: 1 of 96 START test source_not_null_main_raw_customers_id ....................... [RUN]
[0m00:34:09.545826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_platform_main, now test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed)
[0m00:34:09.545981 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed
[0m00:34:09.551605 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed"
[0m00:34:09.552092 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed
[0m00:34:09.559405 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed"
[0m00:34:09.559757 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed"
[0m00:34:09.559914 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed: BEGIN
[0m00:34:09.560052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.560334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.560465 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed"
[0m00:34:09.560603 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "jaffle_platform"."main"."raw_customers"
where id is null



  
  
      
    ) dbt_internal_test
[0m00:34:09.561734 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:09.563710 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed: ROLLBACK
[0m00:34:09.563988 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed'
[0m00:34:09.564127 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed: Close
[0m00:34:09.564367 [info ] [Thread-1 (]: 1 of 96 PASS source_not_null_main_raw_customers_id ............................. [[32mPASS[0m in 0.02s]
[0m00:34:09.564744 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed
[0m00:34:09.564947 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168
[0m00:34:09.565148 [info ] [Thread-1 (]: 2 of 96 START test source_not_null_main_raw_items_id ........................... [RUN]
[0m00:34:09.565382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_not_null_main_raw_customers_id.fd630b40ed, now test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168)
[0m00:34:09.565534 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168
[0m00:34:09.567522 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168"
[0m00:34:09.567866 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168
[0m00:34:09.568868 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168"
[0m00:34:09.569165 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168"
[0m00:34:09.569308 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168: BEGIN
[0m00:34:09.569438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.569710 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.569847 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168"
[0m00:34:09.569991 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "jaffle_platform"."main"."raw_items"
where id is null



  
  
      
    ) dbt_internal_test
[0m00:34:09.570480 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.571232 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168: ROLLBACK
[0m00:34:09.571461 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168'
[0m00:34:09.571592 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168: Close
[0m00:34:09.571806 [info ] [Thread-1 (]: 2 of 96 PASS source_not_null_main_raw_items_id ................................. [[32mPASS[0m in 0.01s]
[0m00:34:09.572014 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168
[0m00:34:09.572163 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515
[0m00:34:09.572399 [info ] [Thread-1 (]: 3 of 96 START test source_not_null_main_raw_orders_id .......................... [RUN]
[0m00:34:09.572699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_not_null_main_raw_items_id.ba04a3f168, now test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515)
[0m00:34:09.572884 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515
[0m00:34:09.574795 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515"
[0m00:34:09.575145 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515
[0m00:34:09.576136 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515"
[0m00:34:09.576434 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515"
[0m00:34:09.576576 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515: BEGIN
[0m00:34:09.576704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.576976 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.577117 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515"
[0m00:34:09.577262 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "jaffle_platform"."main"."raw_orders"
where id is null



  
  
      
    ) dbt_internal_test
[0m00:34:09.577718 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.578441 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515: ROLLBACK
[0m00:34:09.578719 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515'
[0m00:34:09.578871 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515: Close
[0m00:34:09.579115 [info ] [Thread-1 (]: 3 of 96 PASS source_not_null_main_raw_orders_id ................................ [[32mPASS[0m in 0.01s]
[0m00:34:09.579340 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515
[0m00:34:09.579527 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121
[0m00:34:09.579788 [info ] [Thread-1 (]: 4 of 96 START test source_not_null_main_raw_products_sku ....................... [RUN]
[0m00:34:09.579984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_not_null_main_raw_orders_id.8d0b417515, now test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121)
[0m00:34:09.580135 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121
[0m00:34:09.581819 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121"
[0m00:34:09.582123 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121
[0m00:34:09.583915 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121"
[0m00:34:09.584192 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121"
[0m00:34:09.584332 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121: BEGIN
[0m00:34:09.584457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.584689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.584818 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121"
[0m00:34:09.584958 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sku
from "jaffle_platform"."main"."raw_products"
where sku is null



  
  
      
    ) dbt_internal_test
[0m00:34:09.585334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.585895 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121: ROLLBACK
[0m00:34:09.586098 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121'
[0m00:34:09.586226 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121: Close
[0m00:34:09.586429 [info ] [Thread-1 (]: 4 of 96 PASS source_not_null_main_raw_products_sku ............................. [[32mPASS[0m in 0.01s]
[0m00:34:09.586623 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121
[0m00:34:09.586766 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c
[0m00:34:09.587001 [info ] [Thread-1 (]: 5 of 96 START test source_not_null_main_raw_stores_id .......................... [RUN]
[0m00:34:09.587320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_not_null_main_raw_products_sku.9ea5f86121, now test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c)
[0m00:34:09.587489 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c
[0m00:34:09.589173 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c"
[0m00:34:09.589439 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c
[0m00:34:09.590351 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c"
[0m00:34:09.590598 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c"
[0m00:34:09.590731 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c: BEGIN
[0m00:34:09.590853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.591066 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.591205 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c"
[0m00:34:09.591349 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "jaffle_platform"."main"."raw_stores"
where id is null



  
  
      
    ) dbt_internal_test
[0m00:34:09.591689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.592191 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c: ROLLBACK
[0m00:34:09.592381 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c'
[0m00:34:09.592515 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c: Close
[0m00:34:09.592722 [info ] [Thread-1 (]: 5 of 96 PASS source_not_null_main_raw_stores_id ................................ [[32mPASS[0m in 0.01s]
[0m00:34:09.592921 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c
[0m00:34:09.593062 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5
[0m00:34:09.593286 [info ] [Thread-1 (]: 6 of 96 START test source_not_null_main_raw_supplies_id ........................ [RUN]
[0m00:34:09.593570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_not_null_main_raw_stores_id.bf84e62e4c, now test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5)
[0m00:34:09.593751 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5
[0m00:34:09.595848 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5"
[0m00:34:09.596268 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5
[0m00:34:09.597370 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5"
[0m00:34:09.600762 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5"
[0m00:34:09.601016 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5: BEGIN
[0m00:34:09.601180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.601508 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.601659 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5"
[0m00:34:09.601810 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "jaffle_platform"."main"."raw_supplies"
where id is null



  
  
      
    ) dbt_internal_test
[0m00:34:09.602287 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.602934 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5: ROLLBACK
[0m00:34:09.603181 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5'
[0m00:34:09.603316 [debug] [Thread-1 (]: On test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5: Close
[0m00:34:09.603565 [info ] [Thread-1 (]: 6 of 96 PASS source_not_null_main_raw_supplies_id .............................. [[32mPASS[0m in 0.01s]
[0m00:34:09.603814 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5
[0m00:34:09.604033 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b
[0m00:34:09.604262 [info ] [Thread-1 (]: 7 of 96 START test source_unique_main_raw_customers_id ......................... [RUN]
[0m00:34:09.604564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_not_null_main_raw_supplies_id.fe2c38d6d5, now test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b)
[0m00:34:09.604717 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b
[0m00:34:09.607354 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b"
[0m00:34:09.607650 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b
[0m00:34:09.608594 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b"
[0m00:34:09.608865 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b"
[0m00:34:09.609010 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b: BEGIN
[0m00:34:09.609138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.609366 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.609496 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b"
[0m00:34:09.609649 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."raw_customers"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:34:09.613440 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:34:09.614144 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b: ROLLBACK
[0m00:34:09.614404 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b'
[0m00:34:09.614555 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b: Close
[0m00:34:09.614780 [info ] [Thread-1 (]: 7 of 96 PASS source_unique_main_raw_customers_id ............................... [[32mPASS[0m in 0.01s]
[0m00:34:09.614990 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b
[0m00:34:09.615144 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588
[0m00:34:09.615405 [info ] [Thread-1 (]: 8 of 96 START test source_unique_main_raw_items_id ............................. [RUN]
[0m00:34:09.615612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_unique_main_raw_customers_id.42581a7c1b, now test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588)
[0m00:34:09.615765 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588
[0m00:34:09.617426 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588"
[0m00:34:09.617684 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588
[0m00:34:09.619524 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588"
[0m00:34:09.619779 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588"
[0m00:34:09.619923 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588: BEGIN
[0m00:34:09.620059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.620371 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.620634 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588"
[0m00:34:09.620857 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."raw_items"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:34:09.668110 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m00:34:09.669039 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588: ROLLBACK
[0m00:34:09.669312 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588'
[0m00:34:09.669458 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588: Close
[0m00:34:09.669716 [info ] [Thread-1 (]: 8 of 96 PASS source_unique_main_raw_items_id ................................... [[32mPASS[0m in 0.05s]
[0m00:34:09.669960 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588
[0m00:34:09.670130 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7
[0m00:34:09.670408 [info ] [Thread-1 (]: 9 of 96 START test source_unique_main_raw_orders_id ............................ [RUN]
[0m00:34:09.670630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_unique_main_raw_items_id.9fb85e5588, now test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7)
[0m00:34:09.670781 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7
[0m00:34:09.672709 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7"
[0m00:34:09.673107 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7
[0m00:34:09.674172 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7"
[0m00:34:09.674474 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7"
[0m00:34:09.674608 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7: BEGIN
[0m00:34:09.674734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.675023 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.675152 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7"
[0m00:34:09.675290 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."raw_orders"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:34:09.696465 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m00:34:09.697308 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7: ROLLBACK
[0m00:34:09.697583 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7'
[0m00:34:09.697741 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7: Close
[0m00:34:09.698006 [info ] [Thread-1 (]: 9 of 96 PASS source_unique_main_raw_orders_id .................................. [[32mPASS[0m in 0.03s]
[0m00:34:09.698241 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7
[0m00:34:09.698411 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94
[0m00:34:09.698654 [info ] [Thread-1 (]: 10 of 96 START test source_unique_main_raw_products_sku ........................ [RUN]
[0m00:34:09.698878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_unique_main_raw_orders_id.fd49aea3d7, now test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94)
[0m00:34:09.699047 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94
[0m00:34:09.700915 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94"
[0m00:34:09.701258 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94
[0m00:34:09.702281 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94"
[0m00:34:09.702587 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94"
[0m00:34:09.702729 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94: BEGIN
[0m00:34:09.702864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.703154 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.703281 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94"
[0m00:34:09.703425 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    sku as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."raw_products"
where sku is not null
group by sku
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:34:09.704800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:09.705580 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94: ROLLBACK
[0m00:34:09.705908 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94'
[0m00:34:09.706068 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94: Close
[0m00:34:09.706343 [info ] [Thread-1 (]: 10 of 96 PASS source_unique_main_raw_products_sku .............................. [[32mPASS[0m in 0.01s]
[0m00:34:09.706576 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94
[0m00:34:09.706740 [debug] [Thread-1 (]: Began running node test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6
[0m00:34:09.706974 [info ] [Thread-1 (]: 11 of 96 START test source_unique_main_raw_stores_id ........................... [RUN]
[0m00:34:09.707182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_unique_main_raw_products_sku.7677d51e94, now test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6)
[0m00:34:09.707333 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6
[0m00:34:09.709185 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6"
[0m00:34:09.709555 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6
[0m00:34:09.710612 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6"
[0m00:34:09.710897 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6"
[0m00:34:09.711034 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6: BEGIN
[0m00:34:09.711170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.711439 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.711571 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6"
[0m00:34:09.711714 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."raw_stores"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:34:09.712833 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:09.713503 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6: ROLLBACK
[0m00:34:09.713749 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6'
[0m00:34:09.713890 [debug] [Thread-1 (]: On test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6: Close
[0m00:34:09.714096 [info ] [Thread-1 (]: 11 of 96 PASS source_unique_main_raw_stores_id ................................. [[32mPASS[0m in 0.01s]
[0m00:34:09.714297 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6
[0m00:34:09.714455 [debug] [Thread-1 (]: Began running node model.jaffle_platform.stg_supplies
[0m00:34:09.714743 [info ] [Thread-1 (]: 12 of 96 START sql view model main.stg_supplies ................................ [RUN]
[0m00:34:09.714970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.source_unique_main_raw_stores_id.067b11d4e6, now model.jaffle_platform.stg_supplies)
[0m00:34:09.715132 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.stg_supplies
[0m00:34:09.716563 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.stg_supplies"
[0m00:34:09.716873 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.stg_supplies
[0m00:34:09.730361 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.stg_supplies"
[0m00:34:09.730731 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_supplies"
[0m00:34:09.730882 [debug] [Thread-1 (]: On model.jaffle_platform.stg_supplies: BEGIN
[0m00:34:09.731015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.731253 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.731383 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_supplies"
[0m00:34:09.731523 [debug] [Thread-1 (]: On model.jaffle_platform.stg_supplies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_supplies"} */

  
  create view "jaffle_platform"."main"."stg_supplies__dbt_tmp" as (
    with source as (

    select * from "jaffle_platform"."main"."raw_supplies"

),

renamed as (

    select
        ----------  ids
        id as supply_id,
        sku as product_id,

        ----------  strings
        name as supply_name,

        ----------  numerics
        cost as supply_cost,

        ----------  booleans
        perishable

    from source

)

select * from renamed
  );

[0m00:34:09.731896 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.734441 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_supplies"
[0m00:34:09.734625 [debug] [Thread-1 (]: On model.jaffle_platform.stg_supplies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_supplies"} */
alter view "jaffle_platform"."main"."stg_supplies" rename to "stg_supplies__dbt_backup"
[0m00:34:09.735174 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.736714 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_supplies"
[0m00:34:09.736890 [debug] [Thread-1 (]: On model.jaffle_platform.stg_supplies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_supplies"} */
alter view "jaffle_platform"."main"."stg_supplies__dbt_tmp" rename to "stg_supplies"
[0m00:34:09.737160 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.741599 [debug] [Thread-1 (]: On model.jaffle_platform.stg_supplies: COMMIT
[0m00:34:09.741801 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_supplies"
[0m00:34:09.741947 [debug] [Thread-1 (]: On model.jaffle_platform.stg_supplies: COMMIT
[0m00:34:09.742445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.744656 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_supplies"
[0m00:34:09.744831 [debug] [Thread-1 (]: On model.jaffle_platform.stg_supplies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_supplies"} */
drop view if exists "jaffle_platform"."main"."stg_supplies__dbt_backup" cascade
[0m00:34:09.745177 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.745699 [debug] [Thread-1 (]: On model.jaffle_platform.stg_supplies: Close
[0m00:34:09.746885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098ec790>]}
[0m00:34:09.747186 [info ] [Thread-1 (]: 12 of 96 OK created sql view model main.stg_supplies ........................... [[32mOK[0m in 0.03s]
[0m00:34:09.747427 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.stg_supplies
[0m00:34:09.747603 [debug] [Thread-1 (]: Began running node model.jaffle_platform.stg_customers
[0m00:34:09.747879 [info ] [Thread-1 (]: 13 of 96 START sql view model main.stg_customers ............................... [RUN]
[0m00:34:09.748056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.stg_supplies, now model.jaffle_platform.stg_customers)
[0m00:34:09.748202 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.stg_customers
[0m00:34:09.749460 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.stg_customers"
[0m00:34:09.749766 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.stg_customers
[0m00:34:09.751167 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.stg_customers"
[0m00:34:09.751430 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_customers"
[0m00:34:09.751566 [debug] [Thread-1 (]: On model.jaffle_platform.stg_customers: BEGIN
[0m00:34:09.751699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.751938 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.752073 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_customers"
[0m00:34:09.752207 [debug] [Thread-1 (]: On model.jaffle_platform.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_customers"} */

  
  create view "jaffle_platform"."main"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "jaffle_platform"."main"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        name as customer_name

    from source

)

select * from renamed
  );

[0m00:34:09.752527 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.753918 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_customers"
[0m00:34:09.754094 [debug] [Thread-1 (]: On model.jaffle_platform.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_customers"} */
alter view "jaffle_platform"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m00:34:09.754338 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.756407 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_customers"
[0m00:34:09.756570 [debug] [Thread-1 (]: On model.jaffle_platform.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_customers"} */
alter view "jaffle_platform"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m00:34:09.756793 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.757230 [debug] [Thread-1 (]: On model.jaffle_platform.stg_customers: COMMIT
[0m00:34:09.757375 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_customers"
[0m00:34:09.757505 [debug] [Thread-1 (]: On model.jaffle_platform.stg_customers: COMMIT
[0m00:34:09.757834 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.759076 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_customers"
[0m00:34:09.759250 [debug] [Thread-1 (]: On model.jaffle_platform.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_customers"} */
drop view if exists "jaffle_platform"."main"."stg_customers__dbt_backup" cascade
[0m00:34:09.759617 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.760172 [debug] [Thread-1 (]: On model.jaffle_platform.stg_customers: Close
[0m00:34:09.760429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a247e90>]}
[0m00:34:09.760740 [info ] [Thread-1 (]: 13 of 96 OK created sql view model main.stg_customers .......................... [[32mOK[0m in 0.01s]
[0m00:34:09.760962 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.stg_customers
[0m00:34:09.761112 [debug] [Thread-1 (]: Began running node model.jaffle_platform.stg_order_items
[0m00:34:09.761380 [info ] [Thread-1 (]: 14 of 96 START sql view model main.stg_order_items ............................. [RUN]
[0m00:34:09.761612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.stg_customers, now model.jaffle_platform.stg_order_items)
[0m00:34:09.761776 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.stg_order_items
[0m00:34:09.763242 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.stg_order_items"
[0m00:34:09.763521 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.stg_order_items
[0m00:34:09.764941 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.stg_order_items"
[0m00:34:09.765303 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_order_items"
[0m00:34:09.765476 [debug] [Thread-1 (]: On model.jaffle_platform.stg_order_items: BEGIN
[0m00:34:09.765615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.765902 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.766041 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_order_items"
[0m00:34:09.766179 [debug] [Thread-1 (]: On model.jaffle_platform.stg_order_items: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_order_items"} */

  
  create view "jaffle_platform"."main"."stg_order_items__dbt_tmp" as (
    with source as (

    select * from "jaffle_platform"."main"."raw_items"

),

renamed as (

    select
        ----------  ids
        id as order_item_id,
        order_id,
        sku as product_id

    from source

)

select * from renamed
  );

[0m00:34:09.766624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.767952 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_order_items"
[0m00:34:09.768097 [debug] [Thread-1 (]: On model.jaffle_platform.stg_order_items: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_order_items"} */
alter view "jaffle_platform"."main"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m00:34:09.768387 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.769862 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_order_items"
[0m00:34:09.770022 [debug] [Thread-1 (]: On model.jaffle_platform.stg_order_items: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_order_items"} */
alter view "jaffle_platform"."main"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m00:34:09.770280 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.770734 [debug] [Thread-1 (]: On model.jaffle_platform.stg_order_items: COMMIT
[0m00:34:09.770870 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_order_items"
[0m00:34:09.770996 [debug] [Thread-1 (]: On model.jaffle_platform.stg_order_items: COMMIT
[0m00:34:09.771333 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.772447 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_order_items"
[0m00:34:09.772594 [debug] [Thread-1 (]: On model.jaffle_platform.stg_order_items: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_order_items"} */
drop view if exists "jaffle_platform"."main"."stg_order_items__dbt_backup" cascade
[0m00:34:09.772891 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.773449 [debug] [Thread-1 (]: On model.jaffle_platform.stg_order_items: Close
[0m00:34:09.773671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f9690>]}
[0m00:34:09.773936 [info ] [Thread-1 (]: 14 of 96 OK created sql view model main.stg_order_items ........................ [[32mOK[0m in 0.01s]
[0m00:34:09.774166 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.stg_order_items
[0m00:34:09.774328 [debug] [Thread-1 (]: Began running node model.jaffle_platform.stg_orders
[0m00:34:09.774584 [info ] [Thread-1 (]: 15 of 96 START sql view model main.stg_orders .................................. [RUN]
[0m00:34:09.774756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.stg_order_items, now model.jaffle_platform.stg_orders)
[0m00:34:09.774904 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.stg_orders
[0m00:34:09.776262 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.stg_orders"
[0m00:34:09.776563 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.stg_orders
[0m00:34:09.778937 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.stg_orders"
[0m00:34:09.779217 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_orders"
[0m00:34:09.779350 [debug] [Thread-1 (]: On model.jaffle_platform.stg_orders: BEGIN
[0m00:34:09.779560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.779834 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.779982 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_orders"
[0m00:34:09.780140 [debug] [Thread-1 (]: On model.jaffle_platform.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_orders"} */

  
  create view "jaffle_platform"."main"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "jaffle_platform"."main"."raw_orders"

),

renamed as (

    select
        id as order_id,
        customer as customer_id,
        ordered_at as order_date,
        store_id,
        subtotal,
        tax_paid,
        order_total,
        'completed' as status  -- Assuming all orders are completed since we don't have status in raw data

    from source

)

select * from renamed
  );

[0m00:34:09.780492 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.815025 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_orders"
[0m00:34:09.815312 [debug] [Thread-1 (]: On model.jaffle_platform.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_orders"} */
alter view "jaffle_platform"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m00:34:09.815699 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.817172 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_orders"
[0m00:34:09.817356 [debug] [Thread-1 (]: On model.jaffle_platform.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_orders"} */
alter view "jaffle_platform"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m00:34:09.817613 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.818108 [debug] [Thread-1 (]: On model.jaffle_platform.stg_orders: COMMIT
[0m00:34:09.818253 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_orders"
[0m00:34:09.818388 [debug] [Thread-1 (]: On model.jaffle_platform.stg_orders: COMMIT
[0m00:34:09.818794 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.819847 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_orders"
[0m00:34:09.819988 [debug] [Thread-1 (]: On model.jaffle_platform.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_orders"} */
drop view if exists "jaffle_platform"."main"."stg_orders__dbt_backup" cascade
[0m00:34:09.820519 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.820998 [debug] [Thread-1 (]: On model.jaffle_platform.stg_orders: Close
[0m00:34:09.821274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10989d210>]}
[0m00:34:09.821544 [info ] [Thread-1 (]: 15 of 96 OK created sql view model main.stg_orders ............................. [[32mOK[0m in 0.05s]
[0m00:34:09.821784 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.stg_orders
[0m00:34:09.821948 [debug] [Thread-1 (]: Began running node model.jaffle_platform.stg_products
[0m00:34:09.822200 [info ] [Thread-1 (]: 16 of 96 START sql view model main.stg_products ................................ [RUN]
[0m00:34:09.822399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.stg_orders, now model.jaffle_platform.stg_products)
[0m00:34:09.822541 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.stg_products
[0m00:34:09.823858 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.stg_products"
[0m00:34:09.824182 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.stg_products
[0m00:34:09.825621 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.stg_products"
[0m00:34:09.825905 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_products"
[0m00:34:09.826039 [debug] [Thread-1 (]: On model.jaffle_platform.stg_products: BEGIN
[0m00:34:09.826169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.826416 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.826565 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_products"
[0m00:34:09.826722 [debug] [Thread-1 (]: On model.jaffle_platform.stg_products: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_products"} */

  
  create view "jaffle_platform"."main"."stg_products__dbt_tmp" as (
    with source as (

    select * from "jaffle_platform"."main"."raw_products"

),

renamed as (

    select
        ----------  ids
        sku as product_id,

        ----------  strings
        name as product_name,
        type as product_type,
        description,

        ----------  numerics
        price as product_price,

        ----------  booleans
        type = 'food' as is_food_item,
        type = 'drink' as is_drink_item

    from source

)

select * from renamed
  );

[0m00:34:09.827097 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.828340 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_products"
[0m00:34:09.828489 [debug] [Thread-1 (]: On model.jaffle_platform.stg_products: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_products"} */
alter view "jaffle_platform"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m00:34:09.828842 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.830307 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_products"
[0m00:34:09.830473 [debug] [Thread-1 (]: On model.jaffle_platform.stg_products: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_products"} */
alter view "jaffle_platform"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m00:34:09.830754 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.831205 [debug] [Thread-1 (]: On model.jaffle_platform.stg_products: COMMIT
[0m00:34:09.831362 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_products"
[0m00:34:09.831488 [debug] [Thread-1 (]: On model.jaffle_platform.stg_products: COMMIT
[0m00:34:09.831818 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.833016 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_products"
[0m00:34:09.833168 [debug] [Thread-1 (]: On model.jaffle_platform.stg_products: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_products"} */
drop view if exists "jaffle_platform"."main"."stg_products__dbt_backup" cascade
[0m00:34:09.833469 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.833997 [debug] [Thread-1 (]: On model.jaffle_platform.stg_products: Close
[0m00:34:09.834221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a430cd0>]}
[0m00:34:09.834475 [info ] [Thread-1 (]: 16 of 96 OK created sql view model main.stg_products ........................... [[32mOK[0m in 0.01s]
[0m00:34:09.834691 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.stg_products
[0m00:34:09.834890 [debug] [Thread-1 (]: Began running node model.jaffle_platform.stg_stores
[0m00:34:09.835195 [info ] [Thread-1 (]: 17 of 96 START sql view model main.stg_stores .................................. [RUN]
[0m00:34:09.835380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.stg_products, now model.jaffle_platform.stg_stores)
[0m00:34:09.835523 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.stg_stores
[0m00:34:09.837842 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.stg_stores"
[0m00:34:09.838205 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.stg_stores
[0m00:34:09.839752 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.stg_stores"
[0m00:34:09.840064 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_stores"
[0m00:34:09.840197 [debug] [Thread-1 (]: On model.jaffle_platform.stg_stores: BEGIN
[0m00:34:09.840322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.840544 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.840669 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_stores"
[0m00:34:09.840804 [debug] [Thread-1 (]: On model.jaffle_platform.stg_stores: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_stores"} */

  
  create view "jaffle_platform"."main"."stg_stores__dbt_tmp" as (
    with source as (

    select * from "jaffle_platform"."main"."raw_stores"

),

renamed as (

    select
        ----------  ids
        id as store_id,

        ----------  strings
        name as store_name,

        ----------  timestamps
        opened_at as opened_at,

        ----------  numerics
        tax_rate

    from source

)

select * from renamed
  );

[0m00:34:09.841159 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.842413 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_stores"
[0m00:34:09.842557 [debug] [Thread-1 (]: On model.jaffle_platform.stg_stores: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_stores"} */
alter view "jaffle_platform"."main"."stg_stores" rename to "stg_stores__dbt_backup"
[0m00:34:09.842777 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.843904 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_stores"
[0m00:34:09.844047 [debug] [Thread-1 (]: On model.jaffle_platform.stg_stores: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_stores"} */
alter view "jaffle_platform"."main"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m00:34:09.844258 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.844692 [debug] [Thread-1 (]: On model.jaffle_platform.stg_stores: COMMIT
[0m00:34:09.844828 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_stores"
[0m00:34:09.844950 [debug] [Thread-1 (]: On model.jaffle_platform.stg_stores: COMMIT
[0m00:34:09.845291 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.846608 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.stg_stores"
[0m00:34:09.846775 [debug] [Thread-1 (]: On model.jaffle_platform.stg_stores: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.stg_stores"} */
drop view if exists "jaffle_platform"."main"."stg_stores__dbt_backup" cascade
[0m00:34:09.847087 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.847713 [debug] [Thread-1 (]: On model.jaffle_platform.stg_stores: Close
[0m00:34:09.847983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10984c390>]}
[0m00:34:09.848280 [info ] [Thread-1 (]: 17 of 96 OK created sql view model main.stg_stores ............................. [[32mOK[0m in 0.01s]
[0m00:34:09.848511 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.stg_stores
[0m00:34:09.848682 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2
[0m00:34:09.848976 [info ] [Thread-1 (]: 18 of 96 START test dbt_utils_accepted_range_stg_supplies_supply_cost__0 ....... [RUN]
[0m00:34:09.849195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.stg_stores, now test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2)
[0m00:34:09.849347 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2
[0m00:34:09.851102 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2"
[0m00:34:09.851405 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2
[0m00:34:09.852434 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2"
[0m00:34:09.852709 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2"
[0m00:34:09.852846 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2: BEGIN
[0m00:34:09.852972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.853242 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.853456 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2"
[0m00:34:09.853641 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."stg_supplies"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not supply_cost >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:09.854388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:09.855030 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2: ROLLBACK
[0m00:34:09.855288 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2'
[0m00:34:09.855427 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2: Close
[0m00:34:09.855650 [info ] [Thread-1 (]: 18 of 96 PASS dbt_utils_accepted_range_stg_supplies_supply_cost__0 ............. [[32mPASS[0m in 0.01s]
[0m00:34:09.855853 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2
[0m00:34:09.856001 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801
[0m00:34:09.856218 [info ] [Thread-1 (]: 19 of 96 START test not_null_stg_supplies_perishable ........................... [RUN]
[0m00:34:09.856451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_stg_supplies_supply_cost__0.56f9d0fff2, now test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801)
[0m00:34:09.856613 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801
[0m00:34:09.858474 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801"
[0m00:34:09.859004 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801
[0m00:34:09.861292 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801"
[0m00:34:09.861706 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801"
[0m00:34:09.861880 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801: BEGIN
[0m00:34:09.862032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.862327 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.862465 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801"
[0m00:34:09.862609 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select perishable
from "jaffle_platform"."main"."stg_supplies"
where perishable is null



  
  
      
    ) dbt_internal_test
[0m00:34:09.863193 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.863892 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801: ROLLBACK
[0m00:34:09.864100 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801'
[0m00:34:09.864231 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801: Close
[0m00:34:09.864444 [info ] [Thread-1 (]: 19 of 96 PASS not_null_stg_supplies_perishable ................................. [[32mPASS[0m in 0.01s]
[0m00:34:09.864643 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801
[0m00:34:09.864787 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471
[0m00:34:09.865008 [info ] [Thread-1 (]: 20 of 96 START test not_null_stg_supplies_product_id ........................... [RUN]
[0m00:34:09.865249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_supplies_perishable.b0ad96f801, now test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471)
[0m00:34:09.865411 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471
[0m00:34:09.867196 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471"
[0m00:34:09.867515 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471
[0m00:34:09.868677 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471"
[0m00:34:09.869012 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471"
[0m00:34:09.869168 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471: BEGIN
[0m00:34:09.869309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.869601 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.869744 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471"
[0m00:34:09.869897 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "jaffle_platform"."main"."stg_supplies"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m00:34:09.870423 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.871030 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471: ROLLBACK
[0m00:34:09.871363 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471'
[0m00:34:09.871537 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471: Close
[0m00:34:09.871771 [info ] [Thread-1 (]: 20 of 96 PASS not_null_stg_supplies_product_id ................................. [[32mPASS[0m in 0.01s]
[0m00:34:09.871966 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471
[0m00:34:09.872110 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d
[0m00:34:09.872314 [info ] [Thread-1 (]: 21 of 96 START test not_null_stg_supplies_supply_cost .......................... [RUN]
[0m00:34:09.872543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_supplies_product_id.ecc7615471, now test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d)
[0m00:34:09.872701 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d
[0m00:34:09.874332 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d"
[0m00:34:09.874620 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d
[0m00:34:09.875587 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d"
[0m00:34:09.875869 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d"
[0m00:34:09.876059 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d: BEGIN
[0m00:34:09.876189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.876430 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.876564 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d"
[0m00:34:09.876707 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supply_cost
from "jaffle_platform"."main"."stg_supplies"
where supply_cost is null



  
  
      
    ) dbt_internal_test
[0m00:34:09.877216 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.877796 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d: ROLLBACK
[0m00:34:09.877991 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d'
[0m00:34:09.878131 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d: Close
[0m00:34:09.878341 [info ] [Thread-1 (]: 21 of 96 PASS not_null_stg_supplies_supply_cost ................................ [[32mPASS[0m in 0.01s]
[0m00:34:09.878530 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d
[0m00:34:09.878668 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962
[0m00:34:09.878869 [info ] [Thread-1 (]: 22 of 96 START test not_null_stg_supplies_supply_id ............................ [RUN]
[0m00:34:09.879105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_supplies_supply_cost.5de3da4f1d, now test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962)
[0m00:34:09.879288 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962
[0m00:34:09.880991 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962"
[0m00:34:09.881271 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962
[0m00:34:09.882229 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962"
[0m00:34:09.882479 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962"
[0m00:34:09.882610 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962: BEGIN
[0m00:34:09.882728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.882941 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.883067 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962"
[0m00:34:09.883200 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supply_id
from "jaffle_platform"."main"."stg_supplies"
where supply_id is null



  
  
      
    ) dbt_internal_test
[0m00:34:09.883646 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.884410 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962: ROLLBACK
[0m00:34:09.884646 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962'
[0m00:34:09.884801 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962: Close
[0m00:34:09.885048 [info ] [Thread-1 (]: 22 of 96 PASS not_null_stg_supplies_supply_id .................................. [[32mPASS[0m in 0.01s]
[0m00:34:09.885327 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962
[0m00:34:09.885484 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2
[0m00:34:09.885684 [info ] [Thread-1 (]: 23 of 96 START test not_null_stg_supplies_supply_name .......................... [RUN]
[0m00:34:09.885895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_supplies_supply_id.2638ae6962, now test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2)
[0m00:34:09.886051 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2
[0m00:34:09.887828 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2"
[0m00:34:09.888136 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2
[0m00:34:09.890388 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2"
[0m00:34:09.890667 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2"
[0m00:34:09.890805 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2: BEGIN
[0m00:34:09.890937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.891153 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.891285 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2"
[0m00:34:09.891425 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supply_name
from "jaffle_platform"."main"."stg_supplies"
where supply_name is null



  
  
      
    ) dbt_internal_test
[0m00:34:09.891896 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.892664 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2: ROLLBACK
[0m00:34:09.892892 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2'
[0m00:34:09.893026 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2: Close
[0m00:34:09.893261 [info ] [Thread-1 (]: 23 of 96 PASS not_null_stg_supplies_supply_name ................................ [[32mPASS[0m in 0.01s]
[0m00:34:09.893481 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2
[0m00:34:09.893643 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96
[0m00:34:09.893849 [info ] [Thread-1 (]: 24 of 96 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m00:34:09.894016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_supplies_supply_name.cc30977dd2, now test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96)
[0m00:34:09.894159 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96
[0m00:34:09.895919 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96"
[0m00:34:09.896383 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96
[0m00:34:09.897670 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96"
[0m00:34:09.897993 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96"
[0m00:34:09.898142 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m00:34:09.898275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.898513 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.898650 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96"
[0m00:34:09.898792 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "jaffle_platform"."main"."stg_order_items"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m00:34:09.899244 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.899935 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m00:34:09.900170 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96'
[0m00:34:09.900310 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96: Close
[0m00:34:09.900530 [info ] [Thread-1 (]: 24 of 96 PASS not_null_stg_order_items_order_id ................................ [[32mPASS[0m in 0.01s]
[0m00:34:09.900746 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96
[0m00:34:09.900898 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m00:34:09.901121 [info ] [Thread-1 (]: 25 of 96 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m00:34:09.901366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_order_items_order_id.2063801f96, now test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m00:34:09.901540 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m00:34:09.903343 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m00:34:09.903708 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m00:34:09.904826 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m00:34:09.905125 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m00:34:09.905264 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m00:34:09.905386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.905661 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.905898 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m00:34:09.906077 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from "jaffle_platform"."main"."stg_order_items"
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m00:34:09.906732 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.907410 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m00:34:09.907628 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m00:34:09.907770 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m00:34:09.907986 [info ] [Thread-1 (]: 25 of 96 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.01s]
[0m00:34:09.908188 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m00:34:09.908332 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6
[0m00:34:09.908476 [info ] [Thread-1 (]: 26 of 96 START test not_null_stg_order_items_product_id ........................ [RUN]
[0m00:34:09.908757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6)
[0m00:34:09.908950 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6
[0m00:34:09.910723 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6"
[0m00:34:09.911071 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6
[0m00:34:09.912106 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6"
[0m00:34:09.912558 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6"
[0m00:34:09.912706 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6: BEGIN
[0m00:34:09.912937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.913191 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.913331 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6"
[0m00:34:09.913473 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "jaffle_platform"."main"."stg_order_items"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m00:34:09.913944 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.914716 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6: ROLLBACK
[0m00:34:09.914967 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6'
[0m00:34:09.915125 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6: Close
[0m00:34:09.915379 [info ] [Thread-1 (]: 26 of 96 PASS not_null_stg_order_items_product_id .............................. [[32mPASS[0m in 0.01s]
[0m00:34:09.915616 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6
[0m00:34:09.915783 [debug] [Thread-1 (]: Began running node test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108
[0m00:34:09.915971 [info ] [Thread-1 (]: 27 of 96 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m00:34:09.916177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_order_items_product_id.5154a8a6f6, now test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108)
[0m00:34:09.916331 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108
[0m00:34:09.917944 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108"
[0m00:34:09.918249 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108
[0m00:34:09.920352 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108"
[0m00:34:09.920708 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108"
[0m00:34:09.920879 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108: BEGIN
[0m00:34:09.921010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.921221 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.921353 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108"
[0m00:34:09.921489 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."stg_order_items"
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:34:09.943406 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m00:34:09.944263 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108: ROLLBACK
[0m00:34:09.944525 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108'
[0m00:34:09.944671 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108: Close
[0m00:34:09.944930 [info ] [Thread-1 (]: 27 of 96 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 0.03s]
[0m00:34:09.945179 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108
[0m00:34:09.945347 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64
[0m00:34:09.945547 [info ] [Thread-1 (]: 28 of 96 START test not_null_stg_orders_order_id ............................... [RUN]
[0m00:34:09.945778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.unique_stg_order_items_order_item_id.90e333a108, now test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64)
[0m00:34:09.945964 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64
[0m00:34:09.948059 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:34:09.948426 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64
[0m00:34:09.949407 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:34:09.949703 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:34:09.949838 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m00:34:09.949969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.950245 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.950373 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:34:09.950507 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "jaffle_platform"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m00:34:09.951202 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:09.951935 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m00:34:09.952174 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64'
[0m00:34:09.952313 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m00:34:09.952545 [info ] [Thread-1 (]: 28 of 96 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.01s]
[0m00:34:09.952752 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64
[0m00:34:09.952905 [debug] [Thread-1 (]: Began running node test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m00:34:09.953113 [info ] [Thread-1 (]: 29 of 96 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m00:34:09.953322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m00:34:09.953479 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m00:34:09.955733 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m00:34:09.956092 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m00:34:09.957168 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m00:34:09.957455 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m00:34:09.957595 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m00:34:09.957722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:09.957968 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.958101 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m00:34:09.958250 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "jaffle_platform"."main"."stg_order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "jaffle_platform"."main"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:34:09.997766 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m00:34:10.000011 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m00:34:10.000297 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m00:34:10.000452 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m00:34:10.000715 [info ] [Thread-1 (]: 29 of 96 PASS relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.05s]
[0m00:34:10.000940 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m00:34:10.001103 [debug] [Thread-1 (]: Began running node test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a
[0m00:34:10.001262 [info ] [Thread-1 (]: 30 of 96 START test unique_stg_orders_order_id ................................. [RUN]
[0m00:34:10.001564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a)
[0m00:34:10.001838 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a
[0m00:34:10.003860 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a"
[0m00:34:10.004270 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a
[0m00:34:10.005315 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a"
[0m00:34:10.005635 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a"
[0m00:34:10.005772 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m00:34:10.005897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.006191 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.006322 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a"
[0m00:34:10.006461 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:34:10.020767 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m00:34:10.021636 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m00:34:10.021893 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a'
[0m00:34:10.022039 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a: Close
[0m00:34:10.022306 [info ] [Thread-1 (]: 30 of 96 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m00:34:10.022553 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a
[0m00:34:10.022721 [debug] [Thread-1 (]: Began running node test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e
[0m00:34:10.022930 [info ] [Thread-1 (]: 31 of 96 START test accepted_values_stg_products_product_type__beverage__jaffle  [RUN]
[0m00:34:10.023154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.unique_stg_orders_order_id.e3b841c71a, now test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e)
[0m00:34:10.023309 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e
[0m00:34:10.025220 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e"
[0m00:34:10.025580 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e
[0m00:34:10.027691 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e"
[0m00:34:10.028011 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e"
[0m00:34:10.028160 [debug] [Thread-1 (]: On test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e: BEGIN
[0m00:34:10.028308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.028574 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.028713 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e"
[0m00:34:10.028868 [debug] [Thread-1 (]: On test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        product_type as value_field,
        count(*) as n_records

    from "jaffle_platform"."main"."stg_products"
    group by product_type

)

select *
from all_values
where value_field not in (
    'beverage','jaffle'
)



  
  
      
    ) dbt_internal_test
[0m00:34:10.030214 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:10.030891 [debug] [Thread-1 (]: On test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e: ROLLBACK
[0m00:34:10.031131 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e'
[0m00:34:10.031273 [debug] [Thread-1 (]: On test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e: Close
[0m00:34:10.031508 [info ] [Thread-1 (]: 31 of 96 PASS accepted_values_stg_products_product_type__beverage__jaffle ...... [[32mPASS[0m in 0.01s]
[0m00:34:10.031716 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e
[0m00:34:10.031866 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2
[0m00:34:10.032080 [info ] [Thread-1 (]: 32 of 96 START test dbt_utils_accepted_range_stg_products_product_price__0 ..... [RUN]
[0m00:34:10.032324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.accepted_values_stg_products_product_type__beverage__jaffle.a9aed4257e, now test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2)
[0m00:34:10.032487 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2
[0m00:34:10.034331 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2"
[0m00:34:10.034868 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2
[0m00:34:10.036269 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2"
[0m00:34:10.036632 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2"
[0m00:34:10.036800 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2: BEGIN
[0m00:34:10.036935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.037207 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.037351 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2"
[0m00:34:10.037505 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."stg_products"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not product_price >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:10.038240 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:10.038934 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2: ROLLBACK
[0m00:34:10.039169 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2'
[0m00:34:10.039313 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2: Close
[0m00:34:10.039553 [info ] [Thread-1 (]: 32 of 96 PASS dbt_utils_accepted_range_stg_products_product_price__0 ........... [[32mPASS[0m in 0.01s]
[0m00:34:10.039761 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2
[0m00:34:10.039910 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d
[0m00:34:10.040122 [info ] [Thread-1 (]: 33 of 96 START test not_null_stg_products_is_drink_item ........................ [RUN]
[0m00:34:10.040340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_stg_products_product_price__0.d7d70a9cd2, now test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d)
[0m00:34:10.040498 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d
[0m00:34:10.042257 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d"
[0m00:34:10.042550 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d
[0m00:34:10.043581 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d"
[0m00:34:10.043837 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d"
[0m00:34:10.043986 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d: BEGIN
[0m00:34:10.044115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.044352 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.044493 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d"
[0m00:34:10.044664 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_drink_item
from "jaffle_platform"."main"."stg_products"
where is_drink_item is null



  
  
      
    ) dbt_internal_test
[0m00:34:10.045244 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.045860 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d: ROLLBACK
[0m00:34:10.046113 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d'
[0m00:34:10.046257 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d: Close
[0m00:34:10.046487 [info ] [Thread-1 (]: 33 of 96 PASS not_null_stg_products_is_drink_item .............................. [[32mPASS[0m in 0.01s]
[0m00:34:10.046745 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d
[0m00:34:10.046905 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1
[0m00:34:10.047070 [info ] [Thread-1 (]: 34 of 96 START test not_null_stg_products_is_food_item ......................... [RUN]
[0m00:34:10.047321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_products_is_drink_item.339e87c30d, now test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1)
[0m00:34:10.047464 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1
[0m00:34:10.049112 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1"
[0m00:34:10.049421 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1
[0m00:34:10.050458 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1"
[0m00:34:10.050725 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1"
[0m00:34:10.050859 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1: BEGIN
[0m00:34:10.050985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.051225 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.051351 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1"
[0m00:34:10.051485 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_food_item
from "jaffle_platform"."main"."stg_products"
where is_food_item is null



  
  
      
    ) dbt_internal_test
[0m00:34:10.052053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.052760 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1: ROLLBACK
[0m00:34:10.052983 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1'
[0m00:34:10.053118 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1: Close
[0m00:34:10.053324 [info ] [Thread-1 (]: 34 of 96 PASS not_null_stg_products_is_food_item ............................... [[32mPASS[0m in 0.01s]
[0m00:34:10.053520 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1
[0m00:34:10.053662 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3
[0m00:34:10.053860 [info ] [Thread-1 (]: 35 of 96 START test not_null_stg_products_product_id ........................... [RUN]
[0m00:34:10.054074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_products_is_food_item.8e5e6fcdb1, now test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3)
[0m00:34:10.054227 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3
[0m00:34:10.056087 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3"
[0m00:34:10.056368 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3
[0m00:34:10.058547 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3"
[0m00:34:10.058825 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3"
[0m00:34:10.058961 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m00:34:10.059088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.059361 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.059549 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3"
[0m00:34:10.059701 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "jaffle_platform"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m00:34:10.060261 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.060810 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m00:34:10.061007 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3'
[0m00:34:10.061136 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3: Close
[0m00:34:10.061346 [info ] [Thread-1 (]: 35 of 96 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.01s]
[0m00:34:10.061559 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3
[0m00:34:10.061700 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939
[0m00:34:10.061896 [info ] [Thread-1 (]: 36 of 96 START test not_null_stg_products_product_name ......................... [RUN]
[0m00:34:10.062143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_products_product_id.6373b0acf3, now test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939)
[0m00:34:10.062312 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939
[0m00:34:10.064377 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939"
[0m00:34:10.064748 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939
[0m00:34:10.065880 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939"
[0m00:34:10.066211 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939"
[0m00:34:10.066360 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939: BEGIN
[0m00:34:10.066495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.066812 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.066956 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939"
[0m00:34:10.067102 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "jaffle_platform"."main"."stg_products"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m00:34:10.067621 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.068240 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939: ROLLBACK
[0m00:34:10.068503 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939'
[0m00:34:10.068652 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939: Close
[0m00:34:10.068904 [info ] [Thread-1 (]: 36 of 96 PASS not_null_stg_products_product_name ............................... [[32mPASS[0m in 0.01s]
[0m00:34:10.069149 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939
[0m00:34:10.069314 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e
[0m00:34:10.069480 [info ] [Thread-1 (]: 37 of 96 START test not_null_stg_products_product_price ........................ [RUN]
[0m00:34:10.069646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_products_product_name.0b59e4b939, now test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e)
[0m00:34:10.069800 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e
[0m00:34:10.071512 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e"
[0m00:34:10.071831 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e
[0m00:34:10.073021 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e"
[0m00:34:10.073313 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e"
[0m00:34:10.073454 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e: BEGIN
[0m00:34:10.073586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.073812 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.073938 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e"
[0m00:34:10.074074 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_price
from "jaffle_platform"."main"."stg_products"
where product_price is null



  
  
      
    ) dbt_internal_test
[0m00:34:10.074618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.075261 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e: ROLLBACK
[0m00:34:10.075473 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e'
[0m00:34:10.075609 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e: Close
[0m00:34:10.075812 [info ] [Thread-1 (]: 37 of 96 PASS not_null_stg_products_product_price .............................. [[32mPASS[0m in 0.01s]
[0m00:34:10.076012 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e
[0m00:34:10.076156 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8
[0m00:34:10.076351 [info ] [Thread-1 (]: 38 of 96 START test not_null_stg_products_product_type ......................... [RUN]
[0m00:34:10.076593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_products_product_price.d96fdc5e1e, now test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8)
[0m00:34:10.076763 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8
[0m00:34:10.078492 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8"
[0m00:34:10.078823 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8
[0m00:34:10.079917 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8"
[0m00:34:10.080282 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8"
[0m00:34:10.080511 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8: BEGIN
[0m00:34:10.080657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.080906 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.081105 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8"
[0m00:34:10.081255 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_type
from "jaffle_platform"."main"."stg_products"
where product_type is null



  
  
      
    ) dbt_internal_test
[0m00:34:10.081894 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.082614 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8: ROLLBACK
[0m00:34:10.082842 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8'
[0m00:34:10.082986 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8: Close
[0m00:34:10.083221 [info ] [Thread-1 (]: 38 of 96 PASS not_null_stg_products_product_type ............................... [[32mPASS[0m in 0.01s]
[0m00:34:10.083445 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8
[0m00:34:10.083609 [debug] [Thread-1 (]: Began running node test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m00:34:10.083777 [info ] [Thread-1 (]: 39 of 96 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m00:34:10.083944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_products_product_type.7dbdaaf4d8, now test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m00:34:10.084097 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m00:34:10.086113 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m00:34:10.086411 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m00:34:10.087451 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m00:34:10.087778 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m00:34:10.087935 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: BEGIN
[0m00:34:10.088084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.088342 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.088488 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m00:34:10.088691 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "jaffle_platform"."main"."stg_order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "jaffle_platform"."main"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:34:10.091645 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:34:10.093518 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: ROLLBACK
[0m00:34:10.093747 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c'
[0m00:34:10.093881 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: Close
[0m00:34:10.094105 [info ] [Thread-1 (]: 39 of 96 PASS relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.01s]
[0m00:34:10.094309 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m00:34:10.094459 [debug] [Thread-1 (]: Began running node test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a
[0m00:34:10.094713 [info ] [Thread-1 (]: 40 of 96 START test relationships_stg_supplies_product_id__product_id__ref_stg_products_  [RUN]
[0m00:34:10.094979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a)
[0m00:34:10.095167 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a
[0m00:34:10.097663 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a"
[0m00:34:10.097972 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a
[0m00:34:10.099073 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a"
[0m00:34:10.099348 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a"
[0m00:34:10.099488 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a: BEGIN
[0m00:34:10.099617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.099839 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.099986 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a"
[0m00:34:10.100149 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "jaffle_platform"."main"."stg_supplies"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "jaffle_platform"."main"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:34:10.101398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:10.102260 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a: ROLLBACK
[0m00:34:10.102528 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a'
[0m00:34:10.102687 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a: Close
[0m00:34:10.102931 [info ] [Thread-1 (]: 40 of 96 PASS relationships_stg_supplies_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.01s]
[0m00:34:10.103174 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a
[0m00:34:10.103334 [debug] [Thread-1 (]: Began running node test.jaffle_platform.unique_stg_products_product_id.7d950a1467
[0m00:34:10.103499 [info ] [Thread-1 (]: 41 of 96 START test unique_stg_products_product_id ............................. [RUN]
[0m00:34:10.103669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.relationships_stg_supplies_product_id__product_id__ref_stg_products_.b24247ed0a, now test.jaffle_platform.unique_stg_products_product_id.7d950a1467)
[0m00:34:10.103813 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.unique_stg_products_product_id.7d950a1467
[0m00:34:10.105752 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.unique_stg_products_product_id.7d950a1467"
[0m00:34:10.106030 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.unique_stg_products_product_id.7d950a1467
[0m00:34:10.107118 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.unique_stg_products_product_id.7d950a1467"
[0m00:34:10.107390 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_stg_products_product_id.7d950a1467"
[0m00:34:10.107519 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_products_product_id.7d950a1467: BEGIN
[0m00:34:10.107639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.107910 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.108133 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_stg_products_product_id.7d950a1467"
[0m00:34:10.108292 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:34:10.109447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:10.110135 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m00:34:10.110372 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.unique_stg_products_product_id.7d950a1467'
[0m00:34:10.110510 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_products_product_id.7d950a1467: Close
[0m00:34:10.110742 [info ] [Thread-1 (]: 41 of 96 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.01s]
[0m00:34:10.110974 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.unique_stg_products_product_id.7d950a1467
[0m00:34:10.111138 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520
[0m00:34:10.111385 [info ] [Thread-1 (]: 42 of 96 START test dbt_utils_accepted_range_stg_stores_tax_rate__1__0 ......... [RUN]
[0m00:34:10.111575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.unique_stg_products_product_id.7d950a1467, now test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520)
[0m00:34:10.111732 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520
[0m00:34:10.113803 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520"
[0m00:34:10.114083 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520
[0m00:34:10.115201 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520"
[0m00:34:10.115471 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520"
[0m00:34:10.115610 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520: BEGIN
[0m00:34:10.115743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.116000 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.116193 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520"
[0m00:34:10.116364 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."stg_stores"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not tax_rate >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not tax_rate <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:10.117300 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:10.117926 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520: ROLLBACK
[0m00:34:10.118177 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520'
[0m00:34:10.118336 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520: Close
[0m00:34:10.118573 [info ] [Thread-1 (]: 42 of 96 PASS dbt_utils_accepted_range_stg_stores_tax_rate__1__0 ............... [[32mPASS[0m in 0.01s]
[0m00:34:10.118813 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520
[0m00:34:10.118970 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64
[0m00:34:10.119129 [info ] [Thread-1 (]: 43 of 96 START test not_null_stg_stores_opened_at .............................. [RUN]
[0m00:34:10.119309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_stg_stores_tax_rate__1__0.4b4a0f1520, now test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64)
[0m00:34:10.119455 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64
[0m00:34:10.121373 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64"
[0m00:34:10.121625 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64
[0m00:34:10.122719 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64"
[0m00:34:10.122961 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64"
[0m00:34:10.123090 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64: BEGIN
[0m00:34:10.123207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.123441 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.123589 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64"
[0m00:34:10.123726 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select opened_at
from "jaffle_platform"."main"."stg_stores"
where opened_at is null



  
  
      
    ) dbt_internal_test
[0m00:34:10.124164 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.124703 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64: ROLLBACK
[0m00:34:10.124908 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64'
[0m00:34:10.125034 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64: Close
[0m00:34:10.125252 [info ] [Thread-1 (]: 43 of 96 PASS not_null_stg_stores_opened_at .................................... [[32mPASS[0m in 0.01s]
[0m00:34:10.125448 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64
[0m00:34:10.125590 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6
[0m00:34:10.125790 [info ] [Thread-1 (]: 44 of 96 START test not_null_stg_stores_store_id ............................... [RUN]
[0m00:34:10.126041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_stores_opened_at.7656b80b64, now test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6)
[0m00:34:10.126203 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6
[0m00:34:10.129301 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6"
[0m00:34:10.129700 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6
[0m00:34:10.130857 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6"
[0m00:34:10.131204 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6"
[0m00:34:10.131354 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6: BEGIN
[0m00:34:10.131486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.131724 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.131862 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6"
[0m00:34:10.132005 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "jaffle_platform"."main"."stg_stores"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m00:34:10.132453 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.133021 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6: ROLLBACK
[0m00:34:10.133226 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6'
[0m00:34:10.133362 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6: Close
[0m00:34:10.133571 [info ] [Thread-1 (]: 44 of 96 PASS not_null_stg_stores_store_id ..................................... [[32mPASS[0m in 0.01s]
[0m00:34:10.133772 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6
[0m00:34:10.133918 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7
[0m00:34:10.134123 [info ] [Thread-1 (]: 45 of 96 START test not_null_stg_stores_store_name ............................. [RUN]
[0m00:34:10.134362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_stores_store_id.ebecf07ec6, now test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7)
[0m00:34:10.134528 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7
[0m00:34:10.136343 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7"
[0m00:34:10.136668 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7
[0m00:34:10.137752 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7"
[0m00:34:10.138130 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7"
[0m00:34:10.138290 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7: BEGIN
[0m00:34:10.138437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.138707 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.138863 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7"
[0m00:34:10.139005 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "jaffle_platform"."main"."stg_stores"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m00:34:10.139448 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.139994 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7: ROLLBACK
[0m00:34:10.140194 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7'
[0m00:34:10.140333 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7: Close
[0m00:34:10.140539 [info ] [Thread-1 (]: 45 of 96 PASS not_null_stg_stores_store_name ................................... [[32mPASS[0m in 0.01s]
[0m00:34:10.140742 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7
[0m00:34:10.140890 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6
[0m00:34:10.141088 [info ] [Thread-1 (]: 46 of 96 START test not_null_stg_stores_tax_rate ............................... [RUN]
[0m00:34:10.141328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_stores_store_name.a23576c3a7, now test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6)
[0m00:34:10.141504 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6
[0m00:34:10.143287 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6"
[0m00:34:10.143591 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6
[0m00:34:10.144553 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6"
[0m00:34:10.144815 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6"
[0m00:34:10.144956 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6: BEGIN
[0m00:34:10.145086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.145381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.145514 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6"
[0m00:34:10.145653 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tax_rate
from "jaffle_platform"."main"."stg_stores"
where tax_rate is null



  
  
      
    ) dbt_internal_test
[0m00:34:10.146219 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.146783 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6: ROLLBACK
[0m00:34:10.147001 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6'
[0m00:34:10.147137 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6: Close
[0m00:34:10.147351 [info ] [Thread-1 (]: 46 of 96 PASS not_null_stg_stores_tax_rate ..................................... [[32mPASS[0m in 0.01s]
[0m00:34:10.147560 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6
[0m00:34:10.147713 [debug] [Thread-1 (]: Began running node test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2
[0m00:34:10.147915 [info ] [Thread-1 (]: 47 of 96 START test unique_stg_stores_store_id ................................. [RUN]
[0m00:34:10.148164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_stg_stores_tax_rate.b05a8726c6, now test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2)
[0m00:34:10.148316 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2
[0m00:34:10.150067 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2"
[0m00:34:10.150344 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2
[0m00:34:10.151307 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2"
[0m00:34:10.151563 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2"
[0m00:34:10.151698 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2: BEGIN
[0m00:34:10.151826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.152067 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.152202 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2"
[0m00:34:10.152344 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    store_id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."stg_stores"
where store_id is not null
group by store_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:34:10.153213 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:10.153923 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2: ROLLBACK
[0m00:34:10.154169 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2'
[0m00:34:10.154316 [debug] [Thread-1 (]: On test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2: Close
[0m00:34:10.154647 [info ] [Thread-1 (]: 47 of 96 PASS unique_stg_stores_store_id ....................................... [[32mPASS[0m in 0.01s]
[0m00:34:10.154861 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2
[0m00:34:10.155020 [debug] [Thread-1 (]: Began running node model.jaffle_platform.supplies
[0m00:34:10.155293 [info ] [Thread-1 (]: 48 of 96 START sql table model main.supplies ................................... [RUN]
[0m00:34:10.155506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.unique_stg_stores_store_id.2e80d074c2, now model.jaffle_platform.supplies)
[0m00:34:10.155649 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.supplies
[0m00:34:10.158171 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.supplies"
[0m00:34:10.158488 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.supplies
[0m00:34:10.166569 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.supplies"
[0m00:34:10.166990 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.supplies"
[0m00:34:10.167151 [debug] [Thread-1 (]: On model.jaffle_platform.supplies: BEGIN
[0m00:34:10.167293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.167550 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.167691 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.supplies"
[0m00:34:10.167831 [debug] [Thread-1 (]: On model.jaffle_platform.supplies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.supplies"} */

  
    
    

    create  table
      "jaffle_platform"."main"."supplies__dbt_tmp"
  
    as (
      select * from "jaffle_platform"."main"."stg_supplies"
    );
  
  
[0m00:34:10.169472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:10.170911 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.supplies"
[0m00:34:10.171095 [debug] [Thread-1 (]: On model.jaffle_platform.supplies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.supplies"} */
alter table "jaffle_platform"."main"."supplies" rename to "supplies__dbt_backup"
[0m00:34:10.171422 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.172769 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.supplies"
[0m00:34:10.172929 [debug] [Thread-1 (]: On model.jaffle_platform.supplies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.supplies"} */
alter table "jaffle_platform"."main"."supplies__dbt_tmp" rename to "supplies"
[0m00:34:10.173190 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.175000 [debug] [Thread-1 (]: On model.jaffle_platform.supplies: COMMIT
[0m00:34:10.175160 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.supplies"
[0m00:34:10.175295 [debug] [Thread-1 (]: On model.jaffle_platform.supplies: COMMIT
[0m00:34:10.175676 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.176866 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.supplies"
[0m00:34:10.177009 [debug] [Thread-1 (]: On model.jaffle_platform.supplies: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.supplies"} */
drop table if exists "jaffle_platform"."main"."supplies__dbt_backup" cascade
[0m00:34:10.177349 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.177874 [debug] [Thread-1 (]: On model.jaffle_platform.supplies: Close
[0m00:34:10.178118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10984c950>]}
[0m00:34:10.178392 [info ] [Thread-1 (]: 48 of 96 OK created sql table model main.supplies .............................. [[32mOK[0m in 0.02s]
[0m00:34:10.178652 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.supplies
[0m00:34:10.178838 [debug] [Thread-1 (]: Began running node model.jaffle_platform.order_items
[0m00:34:10.179056 [info ] [Thread-1 (]: 49 of 96 START sql table model main.order_items ................................ [RUN]
[0m00:34:10.179241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.supplies, now model.jaffle_platform.order_items)
[0m00:34:10.179397 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.order_items
[0m00:34:10.181309 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.order_items"
[0m00:34:10.181610 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.order_items
[0m00:34:10.183095 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.order_items"
[0m00:34:10.183367 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.order_items"
[0m00:34:10.183505 [debug] [Thread-1 (]: On model.jaffle_platform.order_items: BEGIN
[0m00:34:10.183633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:10.183864 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.184003 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.order_items"
[0m00:34:10.184170 [debug] [Thread-1 (]: On model.jaffle_platform.order_items: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.order_items"} */

  
    
    

    create  table
      "jaffle_platform"."main"."order_items__dbt_tmp"
  
    as (
      with order_items as (

    select * from "jaffle_platform"."main"."stg_order_items"

),

orders as (

    select * from "jaffle_platform"."main"."stg_orders"

),

products as (

    select * from "jaffle_platform"."main"."stg_products"

),

supplies as (

    select * from "jaffle_platform"."main"."stg_supplies"

),

order_supplies_summary as (

    select
        product_id,
        sum(supply_cost) as supply_cost
    from supplies
    group by 1

),

joined as (

    select
        order_items.*,

        orders.order_date,
        orders.store_id,

        products.product_name,
        
    round(1.0 * products.product_price / 100, 2)
 as product_price,
        products.is_food_item,
        products.is_drink_item,

        
    round(1.0 * order_supplies_summary.supply_cost / 100, 2)
 as supply_cost,

        -- calculated fields
        
    round(1.0 * products.product_price - coalesce(order_supplies_summary.supply_cost, 0) / 100, 2)
 as gross_profit_per_item

    from order_items

    left join orders on order_items.order_id = orders.order_id

    left join products on order_items.product_id = products.product_id

    left join order_supplies_summary
        on order_items.product_id = order_supplies_summary.product_id

)

select * from joined
    );
  
  
[0m00:34:10.946566 [debug] [Thread-1 (]: SQL status: OK in 0.762 seconds
[0m00:34:10.949335 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.order_items"
[0m00:34:10.949521 [debug] [Thread-1 (]: On model.jaffle_platform.order_items: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.order_items"} */
alter table "jaffle_platform"."main"."order_items" rename to "order_items__dbt_backup"
[0m00:34:10.949862 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.951059 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.order_items"
[0m00:34:10.951212 [debug] [Thread-1 (]: On model.jaffle_platform.order_items: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.order_items"} */
alter table "jaffle_platform"."main"."order_items__dbt_tmp" rename to "order_items"
[0m00:34:10.951453 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:10.951943 [debug] [Thread-1 (]: On model.jaffle_platform.order_items: COMMIT
[0m00:34:10.952082 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.order_items"
[0m00:34:10.952215 [debug] [Thread-1 (]: On model.jaffle_platform.order_items: COMMIT
[0m00:34:11.056137 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m00:34:11.057600 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.order_items"
[0m00:34:11.057775 [debug] [Thread-1 (]: On model.jaffle_platform.order_items: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.order_items"} */
drop table if exists "jaffle_platform"."main"."order_items__dbt_backup" cascade
[0m00:34:11.058389 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.058977 [debug] [Thread-1 (]: On model.jaffle_platform.order_items: Close
[0m00:34:11.059247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109851810>]}
[0m00:34:11.059529 [info ] [Thread-1 (]: 49 of 96 OK created sql table model main.order_items ........................... [[32mOK[0m in 0.88s]
[0m00:34:11.059763 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.order_items
[0m00:34:11.059925 [debug] [Thread-1 (]: Began running node model.jaffle_platform.products
[0m00:34:11.060344 [info ] [Thread-1 (]: 50 of 96 START sql table model main.products ................................... [RUN]
[0m00:34:11.060528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.order_items, now model.jaffle_platform.products)
[0m00:34:11.060679 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.products
[0m00:34:11.061931 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.products"
[0m00:34:11.062224 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.products
[0m00:34:11.063708 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.products"
[0m00:34:11.064011 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.products"
[0m00:34:11.064153 [debug] [Thread-1 (]: On model.jaffle_platform.products: BEGIN
[0m00:34:11.064292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.064531 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.064671 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.products"
[0m00:34:11.064812 [debug] [Thread-1 (]: On model.jaffle_platform.products: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.products"} */

  
    
    

    create  table
      "jaffle_platform"."main"."products__dbt_tmp"
  
    as (
      select * from "jaffle_platform"."main"."stg_products"
    );
  
  
[0m00:34:11.065451 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.066971 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.products"
[0m00:34:11.067191 [debug] [Thread-1 (]: On model.jaffle_platform.products: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.products"} */
alter table "jaffle_platform"."main"."products" rename to "products__dbt_backup"
[0m00:34:11.067649 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.069048 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.products"
[0m00:34:11.069220 [debug] [Thread-1 (]: On model.jaffle_platform.products: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.products"} */
alter table "jaffle_platform"."main"."products__dbt_tmp" rename to "products"
[0m00:34:11.069495 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.070044 [debug] [Thread-1 (]: On model.jaffle_platform.products: COMMIT
[0m00:34:11.070185 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.products"
[0m00:34:11.070355 [debug] [Thread-1 (]: On model.jaffle_platform.products: COMMIT
[0m00:34:11.070817 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.072120 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.products"
[0m00:34:11.072295 [debug] [Thread-1 (]: On model.jaffle_platform.products: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.products"} */
drop table if exists "jaffle_platform"."main"."products__dbt_backup" cascade
[0m00:34:11.072612 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.073166 [debug] [Thread-1 (]: On model.jaffle_platform.products: Close
[0m00:34:11.073409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ae4650>]}
[0m00:34:11.073670 [info ] [Thread-1 (]: 50 of 96 OK created sql table model main.products .............................. [[32mOK[0m in 0.01s]
[0m00:34:11.073894 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.products
[0m00:34:11.074063 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39
[0m00:34:11.074242 [info ] [Thread-1 (]: 51 of 96 START test dbt_utils_accepted_range_order_items_product_price__0 ...... [RUN]
[0m00:34:11.074416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.products, now test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39)
[0m00:34:11.074565 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39
[0m00:34:11.076285 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39"
[0m00:34:11.076589 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39
[0m00:34:11.078973 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39"
[0m00:34:11.079256 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39"
[0m00:34:11.079400 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39: BEGIN
[0m00:34:11.079570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.079845 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.080055 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39"
[0m00:34:11.080248 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."order_items"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not product_price >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:11.080908 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.081563 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39: ROLLBACK
[0m00:34:11.081826 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39'
[0m00:34:11.081975 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39: Close
[0m00:34:11.082201 [info ] [Thread-1 (]: 51 of 96 PASS dbt_utils_accepted_range_order_items_product_price__0 ............ [[32mPASS[0m in 0.01s]
[0m00:34:11.082441 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39
[0m00:34:11.082597 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26
[0m00:34:11.082760 [info ] [Thread-1 (]: 52 of 96 START test dbt_utils_accepted_range_order_items_supply_cost__0 ........ [RUN]
[0m00:34:11.082920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_order_items_product_price__0.43ad7e7f39, now test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26)
[0m00:34:11.083062 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26
[0m00:34:11.084628 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26"
[0m00:34:11.084900 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26
[0m00:34:11.085918 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26"
[0m00:34:11.086189 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26"
[0m00:34:11.086378 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26: BEGIN
[0m00:34:11.086520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.086743 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.086900 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26"
[0m00:34:11.087070 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."order_items"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not supply_cost >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:11.087694 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.088372 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26: ROLLBACK
[0m00:34:11.088614 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26'
[0m00:34:11.088763 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26: Close
[0m00:34:11.088994 [info ] [Thread-1 (]: 52 of 96 PASS dbt_utils_accepted_range_order_items_supply_cost__0 .............. [[32mPASS[0m in 0.01s]
[0m00:34:11.089211 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26
[0m00:34:11.089361 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b
[0m00:34:11.089573 [info ] [Thread-1 (]: 53 of 96 START test not_null_order_items_gross_profit_per_item ................. [RUN]
[0m00:34:11.089801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_order_items_supply_cost__0.840b4d2b26, now test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b)
[0m00:34:11.089955 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b
[0m00:34:11.091627 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b"
[0m00:34:11.091913 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b
[0m00:34:11.092947 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b"
[0m00:34:11.093205 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b"
[0m00:34:11.093345 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b: BEGIN
[0m00:34:11.093475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.093720 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.093859 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b"
[0m00:34:11.094012 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gross_profit_per_item
from "jaffle_platform"."main"."order_items"
where gross_profit_per_item is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.094420 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.095100 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b: ROLLBACK
[0m00:34:11.095339 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b'
[0m00:34:11.095469 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b: Close
[0m00:34:11.095703 [info ] [Thread-1 (]: 53 of 96 PASS not_null_order_items_gross_profit_per_item ....................... [[32mPASS[0m in 0.01s]
[0m00:34:11.095898 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b
[0m00:34:11.096042 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a
[0m00:34:11.096189 [info ] [Thread-1 (]: 54 of 96 START test not_null_order_items_is_drink_item ......................... [RUN]
[0m00:34:11.096380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_gross_profit_per_item.48da24203b, now test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a)
[0m00:34:11.096521 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a
[0m00:34:11.098232 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a"
[0m00:34:11.098539 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a
[0m00:34:11.099531 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a"
[0m00:34:11.099803 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a"
[0m00:34:11.099991 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a: BEGIN
[0m00:34:11.100116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.100347 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.100471 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a"
[0m00:34:11.100605 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_drink_item
from "jaffle_platform"."main"."order_items"
where is_drink_item is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.101024 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.101695 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a: ROLLBACK
[0m00:34:11.101934 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a'
[0m00:34:11.102078 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a: Close
[0m00:34:11.102326 [info ] [Thread-1 (]: 54 of 96 PASS not_null_order_items_is_drink_item ............................... [[32mPASS[0m in 0.01s]
[0m00:34:11.102592 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a
[0m00:34:11.102780 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725
[0m00:34:11.102976 [info ] [Thread-1 (]: 55 of 96 START test not_null_order_items_is_food_item .......................... [RUN]
[0m00:34:11.103178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_is_drink_item.6bb8231b5a, now test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725)
[0m00:34:11.103346 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725
[0m00:34:11.105216 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725"
[0m00:34:11.105524 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725
[0m00:34:11.107730 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725"
[0m00:34:11.107999 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725"
[0m00:34:11.108136 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725: BEGIN
[0m00:34:11.108262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.108500 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.108638 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725"
[0m00:34:11.108777 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_food_item
from "jaffle_platform"."main"."order_items"
where is_food_item is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.109116 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.109721 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725: ROLLBACK
[0m00:34:11.109928 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725'
[0m00:34:11.110055 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725: Close
[0m00:34:11.110262 [info ] [Thread-1 (]: 55 of 96 PASS not_null_order_items_is_food_item ................................ [[32mPASS[0m in 0.01s]
[0m00:34:11.110456 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725
[0m00:34:11.110600 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_order_date.287d23d5d3
[0m00:34:11.110815 [info ] [Thread-1 (]: 56 of 96 START test not_null_order_items_order_date ............................ [RUN]
[0m00:34:11.111062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_is_food_item.c5a4aa0725, now test.jaffle_platform.not_null_order_items_order_date.287d23d5d3)
[0m00:34:11.111226 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_order_date.287d23d5d3
[0m00:34:11.113041 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_order_date.287d23d5d3"
[0m00:34:11.113494 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_order_date.287d23d5d3
[0m00:34:11.114687 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_order_date.287d23d5d3"
[0m00:34:11.114984 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_order_date.287d23d5d3"
[0m00:34:11.115118 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_date.287d23d5d3: BEGIN
[0m00:34:11.115241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.115474 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.115615 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_order_date.287d23d5d3"
[0m00:34:11.115754 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_date.287d23d5d3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_order_date.287d23d5d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "jaffle_platform"."main"."order_items"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.116152 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.116986 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_date.287d23d5d3: ROLLBACK
[0m00:34:11.117232 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_order_date.287d23d5d3'
[0m00:34:11.117374 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_date.287d23d5d3: Close
[0m00:34:11.117615 [info ] [Thread-1 (]: 56 of 96 PASS not_null_order_items_order_date .................................. [[32mPASS[0m in 0.01s]
[0m00:34:11.117858 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_order_date.287d23d5d3
[0m00:34:11.118096 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_order_id.0207cf2b74
[0m00:34:11.118260 [info ] [Thread-1 (]: 57 of 96 START test not_null_order_items_order_id .............................. [RUN]
[0m00:34:11.118432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_order_date.287d23d5d3, now test.jaffle_platform.not_null_order_items_order_id.0207cf2b74)
[0m00:34:11.118580 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_order_id.0207cf2b74
[0m00:34:11.120354 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_order_id.0207cf2b74"
[0m00:34:11.120673 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_order_id.0207cf2b74
[0m00:34:11.121834 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_order_id.0207cf2b74"
[0m00:34:11.122198 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_order_id.0207cf2b74"
[0m00:34:11.122367 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_id.0207cf2b74: BEGIN
[0m00:34:11.122513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.122790 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.122972 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_order_id.0207cf2b74"
[0m00:34:11.123143 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_id.0207cf2b74: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_order_id.0207cf2b74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "jaffle_platform"."main"."order_items"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.123652 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.124343 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_id.0207cf2b74: ROLLBACK
[0m00:34:11.124562 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_order_id.0207cf2b74'
[0m00:34:11.124694 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_id.0207cf2b74: Close
[0m00:34:11.124926 [info ] [Thread-1 (]: 57 of 96 PASS not_null_order_items_order_id .................................... [[32mPASS[0m in 0.01s]
[0m00:34:11.125128 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_order_id.0207cf2b74
[0m00:34:11.125274 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd
[0m00:34:11.125474 [info ] [Thread-1 (]: 58 of 96 START test not_null_order_items_order_item_id ......................... [RUN]
[0m00:34:11.125691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_order_id.0207cf2b74, now test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd)
[0m00:34:11.125843 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd
[0m00:34:11.127578 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd"
[0m00:34:11.127882 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd
[0m00:34:11.128916 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd"
[0m00:34:11.129184 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd"
[0m00:34:11.129326 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd: BEGIN
[0m00:34:11.129481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.129731 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.129864 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd"
[0m00:34:11.130009 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from "jaffle_platform"."main"."order_items"
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.130472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.131174 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd: ROLLBACK
[0m00:34:11.131395 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd'
[0m00:34:11.131538 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd: Close
[0m00:34:11.131754 [info ] [Thread-1 (]: 58 of 96 PASS not_null_order_items_order_item_id ............................... [[32mPASS[0m in 0.01s]
[0m00:34:11.131955 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd
[0m00:34:11.132121 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32
[0m00:34:11.132341 [info ] [Thread-1 (]: 59 of 96 START test not_null_order_items_product_id ............................ [RUN]
[0m00:34:11.132568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_order_item_id.c6fda366bd, now test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32)
[0m00:34:11.132723 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32
[0m00:34:11.134397 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32"
[0m00:34:11.134700 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32
[0m00:34:11.136984 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32"
[0m00:34:11.137382 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32"
[0m00:34:11.137566 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32: BEGIN
[0m00:34:11.137762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.137990 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.138131 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32"
[0m00:34:11.138270 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "jaffle_platform"."main"."order_items"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.138709 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.139476 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32: ROLLBACK
[0m00:34:11.139727 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32'
[0m00:34:11.139867 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32: Close
[0m00:34:11.140126 [info ] [Thread-1 (]: 59 of 96 PASS not_null_order_items_product_id .................................. [[32mPASS[0m in 0.01s]
[0m00:34:11.140360 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32
[0m00:34:11.140524 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d
[0m00:34:11.140695 [info ] [Thread-1 (]: 60 of 96 START test not_null_order_items_product_name .......................... [RUN]
[0m00:34:11.140864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_product_id.d5e49d7c32, now test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d)
[0m00:34:11.141011 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d
[0m00:34:11.142637 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d"
[0m00:34:11.142934 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d
[0m00:34:11.143943 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d"
[0m00:34:11.144228 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d"
[0m00:34:11.144376 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d: BEGIN
[0m00:34:11.144521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.144828 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.144977 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d"
[0m00:34:11.145134 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "jaffle_platform"."main"."order_items"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.145570 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.146252 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d: ROLLBACK
[0m00:34:11.146485 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d'
[0m00:34:11.146629 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d: Close
[0m00:34:11.146844 [info ] [Thread-1 (]: 60 of 96 PASS not_null_order_items_product_name ................................ [[32mPASS[0m in 0.01s]
[0m00:34:11.147099 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d
[0m00:34:11.147289 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_product_price.9e29b4995d
[0m00:34:11.147503 [info ] [Thread-1 (]: 61 of 96 START test not_null_order_items_product_price ......................... [RUN]
[0m00:34:11.147732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_product_name.86cd0cf29d, now test.jaffle_platform.not_null_order_items_product_price.9e29b4995d)
[0m00:34:11.147903 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_product_price.9e29b4995d
[0m00:34:11.149567 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_product_price.9e29b4995d"
[0m00:34:11.149865 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_product_price.9e29b4995d
[0m00:34:11.150860 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_product_price.9e29b4995d"
[0m00:34:11.151296 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_product_price.9e29b4995d"
[0m00:34:11.151444 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_price.9e29b4995d: BEGIN
[0m00:34:11.151571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.151801 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.151942 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_product_price.9e29b4995d"
[0m00:34:11.152092 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_price.9e29b4995d: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_product_price.9e29b4995d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_price
from "jaffle_platform"."main"."order_items"
where product_price is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.152539 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.153236 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_price.9e29b4995d: ROLLBACK
[0m00:34:11.153441 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_product_price.9e29b4995d'
[0m00:34:11.153648 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_product_price.9e29b4995d: Close
[0m00:34:11.153911 [info ] [Thread-1 (]: 61 of 96 PASS not_null_order_items_product_price ............................... [[32mPASS[0m in 0.01s]
[0m00:34:11.154131 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_product_price.9e29b4995d
[0m00:34:11.154290 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_order_items_store_id.dcf872af5c
[0m00:34:11.154457 [info ] [Thread-1 (]: 62 of 96 START test not_null_order_items_store_id .............................. [RUN]
[0m00:34:11.154623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_product_price.9e29b4995d, now test.jaffle_platform.not_null_order_items_store_id.dcf872af5c)
[0m00:34:11.154764 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_order_items_store_id.dcf872af5c
[0m00:34:11.156545 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_order_items_store_id.dcf872af5c"
[0m00:34:11.156845 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_order_items_store_id.dcf872af5c
[0m00:34:11.157889 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_order_items_store_id.dcf872af5c"
[0m00:34:11.158153 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_store_id.dcf872af5c"
[0m00:34:11.158286 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_store_id.dcf872af5c: BEGIN
[0m00:34:11.158409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.158631 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.158760 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_order_items_store_id.dcf872af5c"
[0m00:34:11.158895 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_store_id.dcf872af5c: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_order_items_store_id.dcf872af5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "jaffle_platform"."main"."order_items"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.159247 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.159828 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_store_id.dcf872af5c: ROLLBACK
[0m00:34:11.160025 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_order_items_store_id.dcf872af5c'
[0m00:34:11.160159 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_order_items_store_id.dcf872af5c: Close
[0m00:34:11.160369 [info ] [Thread-1 (]: 62 of 96 PASS not_null_order_items_store_id .................................... [[32mPASS[0m in 0.01s]
[0m00:34:11.160567 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_order_items_store_id.dcf872af5c
[0m00:34:11.160715 [debug] [Thread-1 (]: Began running node test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221
[0m00:34:11.160927 [info ] [Thread-1 (]: 63 of 96 START test relationships_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m00:34:11.161156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_order_items_store_id.dcf872af5c, now test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221)
[0m00:34:11.161318 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221
[0m00:34:11.163615 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221"
[0m00:34:11.164048 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221
[0m00:34:11.166262 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221"
[0m00:34:11.166576 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221"
[0m00:34:11.166730 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221: BEGIN
[0m00:34:11.166863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.167108 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.167245 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221"
[0m00:34:11.167403 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "jaffle_platform"."main"."order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "jaffle_platform"."main"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.170296 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:34:11.171208 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221: ROLLBACK
[0m00:34:11.171479 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221'
[0m00:34:11.171644 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221: Close
[0m00:34:11.171929 [info ] [Thread-1 (]: 63 of 96 PASS relationships_order_items_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.01s]
[0m00:34:11.172193 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221
[0m00:34:11.172361 [debug] [Thread-1 (]: Began running node test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d
[0m00:34:11.172585 [info ] [Thread-1 (]: 64 of 96 START test relationships_order_items_store_id__store_id__ref_stg_stores_  [RUN]
[0m00:34:11.172818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.relationships_order_items_product_id__product_id__ref_stg_products_.32c12f5221, now test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d)
[0m00:34:11.172987 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d
[0m00:34:11.175157 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d"
[0m00:34:11.175543 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d
[0m00:34:11.176612 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d"
[0m00:34:11.176923 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d"
[0m00:34:11.177073 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d: BEGIN
[0m00:34:11.177208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.177532 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.177707 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d"
[0m00:34:11.177870 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_id as from_field
    from "jaffle_platform"."main"."order_items"
    where store_id is not null
),

parent as (
    select store_id as to_field
    from "jaffle_platform"."main"."stg_stores"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.181219 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:34:11.182008 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d: ROLLBACK
[0m00:34:11.182242 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d'
[0m00:34:11.182385 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d: Close
[0m00:34:11.182630 [info ] [Thread-1 (]: 64 of 96 PASS relationships_order_items_store_id__store_id__ref_stg_stores_ .... [[32mPASS[0m in 0.01s]
[0m00:34:11.182855 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d
[0m00:34:11.183024 [debug] [Thread-1 (]: Began running node test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a
[0m00:34:11.183229 [info ] [Thread-1 (]: 65 of 96 START test unique_order_items_order_item_id ........................... [RUN]
[0m00:34:11.183415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.relationships_order_items_store_id__store_id__ref_stg_stores_.3506d5359d, now test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a)
[0m00:34:11.183567 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a
[0m00:34:11.185218 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a"
[0m00:34:11.185510 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a
[0m00:34:11.186507 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a"
[0m00:34:11.186773 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a"
[0m00:34:11.186907 [debug] [Thread-1 (]: On test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a: BEGIN
[0m00:34:11.187037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.187278 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.187423 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a"
[0m00:34:11.187572 [debug] [Thread-1 (]: On test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."order_items"
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:34:11.207375 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m00:34:11.208242 [debug] [Thread-1 (]: On test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a: ROLLBACK
[0m00:34:11.208504 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a'
[0m00:34:11.208650 [debug] [Thread-1 (]: On test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a: Close
[0m00:34:11.208914 [info ] [Thread-1 (]: 65 of 96 PASS unique_order_items_order_item_id ................................. [[32mPASS[0m in 0.03s]
[0m00:34:11.209154 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a
[0m00:34:11.209500 [debug] [Thread-1 (]: Began running node model.jaffle_platform.orders
[0m00:34:11.209888 [info ] [Thread-1 (]: 66 of 96 START sql table model main.orders ..................................... [RUN]
[0m00:34:11.210164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.unique_order_items_order_item_id.7d0a7e900a, now model.jaffle_platform.orders)
[0m00:34:11.210346 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.orders
[0m00:34:11.212735 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.orders"
[0m00:34:11.213174 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.orders
[0m00:34:11.214738 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.orders"
[0m00:34:11.215048 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.orders"
[0m00:34:11.215191 [debug] [Thread-1 (]: On model.jaffle_platform.orders: BEGIN
[0m00:34:11.215398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.215737 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.215881 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.orders"
[0m00:34:11.216087 [debug] [Thread-1 (]: On model.jaffle_platform.orders: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.orders"} */

  
    
    

    create  table
      "jaffle_platform"."main"."orders__dbt_tmp"
  
    as (
      with orders as (

    select * from "jaffle_platform"."main"."stg_orders"

),

order_items as (

    select * from "jaffle_platform"."main"."order_items"

),

order_items_summary as (

    select
        order_id,
        
        sum(case when is_food_item then 1 else 0 end) as food_items_count,
        sum(case when is_drink_item then 1 else 0 end) as drink_items_count,
        count(*) as total_items_count,

        
    round(1.0 * sum(case when is_food_item then product_price * 100 else 0 end) / 100, 2)
 as food_revenue,
        
    round(1.0 * sum(case when is_drink_item then product_price * 100 else 0 end) / 100, 2)
 as drink_revenue,
        
    round(1.0 * sum(product_price * 100) / 100, 2)
 as total_revenue,

        
    round(1.0 * sum(case when is_food_item then supply_cost * 100 else 0 end) / 100, 2)
 as food_cost,
        
    round(1.0 * sum(case when is_drink_item then supply_cost * 100 else 0 end) / 100, 2)
 as drink_cost,
        
    round(1.0 * sum(supply_cost * 100) / 100, 2)
 as total_cost,

        
    round(1.0 * sum(case when is_food_item then gross_profit_per_item * 100 else 0 end) / 100, 2)
 as food_profit,
        
    round(1.0 * sum(case when is_drink_item then gross_profit_per_item * 100 else 0 end) / 100, 2)
 as drink_profit,
        
    round(1.0 * sum(gross_profit_per_item * 100) / 100, 2)
 as total_profit

    from order_items
    group by 1

),

joined as (

    select
        orders.order_id,
        orders.customer_id,
        orders.store_id,
        orders.order_date,
        orders.status,

        order_items_summary.food_items_count,
        order_items_summary.drink_items_count,
        order_items_summary.total_items_count,

        order_items_summary.food_revenue,
        order_items_summary.drink_revenue,
        order_items_summary.total_revenue,

        order_items_summary.food_cost,
        order_items_summary.drink_cost,
        order_items_summary.total_cost,

        order_items_summary.food_profit,
        order_items_summary.drink_profit,
        order_items_summary.total_profit

    from orders

    inner join order_items_summary using (order_id)

)

select * from joined
    );
  
  
[0m00:34:11.793602 [debug] [Thread-1 (]: SQL status: OK in 0.577 seconds
[0m00:34:11.795148 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.orders"
[0m00:34:11.795320 [debug] [Thread-1 (]: On model.jaffle_platform.orders: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.orders"} */
alter table "jaffle_platform"."main"."orders" rename to "orders__dbt_backup"
[0m00:34:11.795623 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.797869 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.orders"
[0m00:34:11.798015 [debug] [Thread-1 (]: On model.jaffle_platform.orders: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.orders"} */
alter table "jaffle_platform"."main"."orders__dbt_tmp" rename to "orders"
[0m00:34:11.798245 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.798765 [debug] [Thread-1 (]: On model.jaffle_platform.orders: COMMIT
[0m00:34:11.798899 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.orders"
[0m00:34:11.799021 [debug] [Thread-1 (]: On model.jaffle_platform.orders: COMMIT
[0m00:34:11.846435 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m00:34:11.847859 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.orders"
[0m00:34:11.848032 [debug] [Thread-1 (]: On model.jaffle_platform.orders: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.orders"} */
drop table if exists "jaffle_platform"."main"."orders__dbt_backup" cascade
[0m00:34:11.848596 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.849180 [debug] [Thread-1 (]: On model.jaffle_platform.orders: Close
[0m00:34:11.849445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a346f50>]}
[0m00:34:11.849743 [info ] [Thread-1 (]: 66 of 96 OK created sql table model main.orders ................................ [[32mOK[0m in 0.64s]
[0m00:34:11.849970 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.orders
[0m00:34:11.850405 [debug] [Thread-1 (]: Began running node test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484
[0m00:34:11.850635 [info ] [Thread-1 (]: 67 of 96 START test accepted_values_orders_status__completed ................... [RUN]
[0m00:34:11.850815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.orders, now test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484)
[0m00:34:11.850969 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484
[0m00:34:11.852819 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484"
[0m00:34:11.853376 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484
[0m00:34:11.854476 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484"
[0m00:34:11.854794 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484"
[0m00:34:11.854960 [debug] [Thread-1 (]: On test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484: BEGIN
[0m00:34:11.855095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.855341 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.855496 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484"
[0m00:34:11.855649 [debug] [Thread-1 (]: On test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "jaffle_platform"."main"."orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed'
)



  
  
      
    ) dbt_internal_test
[0m00:34:11.856888 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:11.857576 [debug] [Thread-1 (]: On test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484: ROLLBACK
[0m00:34:11.857858 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484'
[0m00:34:11.858006 [debug] [Thread-1 (]: On test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484: Close
[0m00:34:11.858242 [info ] [Thread-1 (]: 67 of 96 PASS accepted_values_orders_status__completed ......................... [[32mPASS[0m in 0.01s]
[0m00:34:11.858464 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484
[0m00:34:11.858628 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd
[0m00:34:11.858862 [info ] [Thread-1 (]: 68 of 96 START test dbt_utils_accepted_range_orders_total_cost__0 .............. [RUN]
[0m00:34:11.859129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.accepted_values_orders_status__completed.9c0d503484, now test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd)
[0m00:34:11.859304 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd
[0m00:34:11.861145 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd"
[0m00:34:11.861463 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd
[0m00:34:11.862453 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd"
[0m00:34:11.862741 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd"
[0m00:34:11.862888 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd: BEGIN
[0m00:34:11.863018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.863325 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.863547 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd"
[0m00:34:11.863720 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_cost >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:11.864436 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:11.865018 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd: ROLLBACK
[0m00:34:11.865227 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd'
[0m00:34:11.865366 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd: Close
[0m00:34:11.865574 [info ] [Thread-1 (]: 68 of 96 PASS dbt_utils_accepted_range_orders_total_cost__0 .................... [[32mPASS[0m in 0.01s]
[0m00:34:11.865772 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd
[0m00:34:11.865919 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7
[0m00:34:11.866149 [info ] [Thread-1 (]: 69 of 96 START test dbt_utils_accepted_range_orders_total_items_count__1 ....... [RUN]
[0m00:34:11.866409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_orders_total_cost__0.0da53292dd, now test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7)
[0m00:34:11.866582 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7
[0m00:34:11.868602 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7"
[0m00:34:11.868937 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7
[0m00:34:11.870046 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7"
[0m00:34:11.870526 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7"
[0m00:34:11.870682 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7: BEGIN
[0m00:34:11.870818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.871066 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.871246 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7"
[0m00:34:11.871469 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_items_count >= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:11.872255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:11.872921 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7: ROLLBACK
[0m00:34:11.873140 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7'
[0m00:34:11.873277 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7: Close
[0m00:34:11.873499 [info ] [Thread-1 (]: 69 of 96 PASS dbt_utils_accepted_range_orders_total_items_count__1 ............. [[32mPASS[0m in 0.01s]
[0m00:34:11.873711 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7
[0m00:34:11.873870 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca
[0m00:34:11.874088 [info ] [Thread-1 (]: 70 of 96 START test dbt_utils_accepted_range_orders_total_revenue__0 ........... [RUN]
[0m00:34:11.874329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_orders_total_items_count__1.34dc2443a7, now test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca)
[0m00:34:11.874491 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca
[0m00:34:11.877550 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca"
[0m00:34:11.877892 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca
[0m00:34:11.879129 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca"
[0m00:34:11.879685 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca"
[0m00:34:11.879884 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca: BEGIN
[0m00:34:11.880046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.880325 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.880476 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca"
[0m00:34:11.880638 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_revenue >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:11.881312 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:11.881882 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca: ROLLBACK
[0m00:34:11.882109 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca'
[0m00:34:11.882245 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca: Close
[0m00:34:11.882464 [info ] [Thread-1 (]: 70 of 96 PASS dbt_utils_accepted_range_orders_total_revenue__0 ................. [[32mPASS[0m in 0.01s]
[0m00:34:11.882667 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca
[0m00:34:11.882818 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_orders_customer_id.c5f02694af
[0m00:34:11.883046 [info ] [Thread-1 (]: 71 of 96 START test not_null_orders_customer_id ................................ [RUN]
[0m00:34:11.883299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_orders_total_revenue__0.232d3c7cca, now test.jaffle_platform.not_null_orders_customer_id.c5f02694af)
[0m00:34:11.883472 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_orders_customer_id.c5f02694af
[0m00:34:11.885313 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_orders_customer_id.c5f02694af"
[0m00:34:11.885654 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_orders_customer_id.c5f02694af
[0m00:34:11.886816 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_orders_customer_id.c5f02694af"
[0m00:34:11.887100 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_customer_id.c5f02694af"
[0m00:34:11.887245 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_customer_id.c5f02694af: BEGIN
[0m00:34:11.887377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.887674 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.887916 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_customer_id.c5f02694af"
[0m00:34:11.888103 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_customer_id.c5f02694af: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_orders_customer_id.c5f02694af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "jaffle_platform"."main"."orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.888606 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.889225 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_customer_id.c5f02694af: ROLLBACK
[0m00:34:11.889468 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_orders_customer_id.c5f02694af'
[0m00:34:11.889617 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_customer_id.c5f02694af: Close
[0m00:34:11.889849 [info ] [Thread-1 (]: 71 of 96 PASS not_null_orders_customer_id ...................................... [[32mPASS[0m in 0.01s]
[0m00:34:11.890055 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_orders_customer_id.c5f02694af
[0m00:34:11.890206 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_orders_order_date.6910a855fe
[0m00:34:11.890418 [info ] [Thread-1 (]: 72 of 96 START test not_null_orders_order_date ................................. [RUN]
[0m00:34:11.890645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_orders_customer_id.c5f02694af, now test.jaffle_platform.not_null_orders_order_date.6910a855fe)
[0m00:34:11.890804 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_orders_order_date.6910a855fe
[0m00:34:11.892784 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_orders_order_date.6910a855fe"
[0m00:34:11.893337 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_orders_order_date.6910a855fe
[0m00:34:11.894585 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_orders_order_date.6910a855fe"
[0m00:34:11.894912 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_order_date.6910a855fe"
[0m00:34:11.895062 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_order_date.6910a855fe: BEGIN
[0m00:34:11.895202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.895510 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.895753 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_order_date.6910a855fe"
[0m00:34:11.895945 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_order_date.6910a855fe: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_orders_order_date.6910a855fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "jaffle_platform"."main"."orders"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.896403 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.897013 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_order_date.6910a855fe: ROLLBACK
[0m00:34:11.897249 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_orders_order_date.6910a855fe'
[0m00:34:11.897395 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_order_date.6910a855fe: Close
[0m00:34:11.897644 [info ] [Thread-1 (]: 72 of 96 PASS not_null_orders_order_date ....................................... [[32mPASS[0m in 0.01s]
[0m00:34:11.897869 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_orders_order_date.6910a855fe
[0m00:34:11.898033 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_orders_order_id.cf6c17daed
[0m00:34:11.898228 [info ] [Thread-1 (]: 73 of 96 START test not_null_orders_order_id ................................... [RUN]
[0m00:34:11.898395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_orders_order_date.6910a855fe, now test.jaffle_platform.not_null_orders_order_id.cf6c17daed)
[0m00:34:11.898526 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_orders_order_id.cf6c17daed
[0m00:34:11.900296 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_orders_order_id.cf6c17daed"
[0m00:34:11.900651 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_orders_order_id.cf6c17daed
[0m00:34:11.901952 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_orders_order_id.cf6c17daed"
[0m00:34:11.902375 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_order_id.cf6c17daed"
[0m00:34:11.902552 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_order_id.cf6c17daed: BEGIN
[0m00:34:11.902698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.902974 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.903115 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_order_id.cf6c17daed"
[0m00:34:11.903260 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_order_id.cf6c17daed: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_orders_order_id.cf6c17daed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "jaffle_platform"."main"."orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.903720 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.904373 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_order_id.cf6c17daed: ROLLBACK
[0m00:34:11.904644 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_orders_order_id.cf6c17daed'
[0m00:34:11.904795 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_order_id.cf6c17daed: Close
[0m00:34:11.905015 [info ] [Thread-1 (]: 73 of 96 PASS not_null_orders_order_id ......................................... [[32mPASS[0m in 0.01s]
[0m00:34:11.905403 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_orders_order_id.cf6c17daed
[0m00:34:11.905575 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_orders_status.8a27272c0a
[0m00:34:11.905787 [info ] [Thread-1 (]: 74 of 96 START test not_null_orders_status ..................................... [RUN]
[0m00:34:11.906026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_orders_order_id.cf6c17daed, now test.jaffle_platform.not_null_orders_status.8a27272c0a)
[0m00:34:11.906203 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_orders_status.8a27272c0a
[0m00:34:11.909263 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_orders_status.8a27272c0a"
[0m00:34:11.909582 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_orders_status.8a27272c0a
[0m00:34:11.910572 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_orders_status.8a27272c0a"
[0m00:34:11.910849 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_status.8a27272c0a"
[0m00:34:11.910998 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_status.8a27272c0a: BEGIN
[0m00:34:11.911296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.911522 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.911660 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_status.8a27272c0a"
[0m00:34:11.911796 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_status.8a27272c0a: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_orders_status.8a27272c0a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "jaffle_platform"."main"."orders"
where status is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.912192 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.912838 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_status.8a27272c0a: ROLLBACK
[0m00:34:11.913064 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_orders_status.8a27272c0a'
[0m00:34:11.913205 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_status.8a27272c0a: Close
[0m00:34:11.913437 [info ] [Thread-1 (]: 74 of 96 PASS not_null_orders_status ........................................... [[32mPASS[0m in 0.01s]
[0m00:34:11.913708 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_orders_status.8a27272c0a
[0m00:34:11.913896 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04
[0m00:34:11.914116 [info ] [Thread-1 (]: 75 of 96 START test not_null_orders_store_id ................................... [RUN]
[0m00:34:11.914367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_orders_status.8a27272c0a, now test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04)
[0m00:34:11.914532 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04
[0m00:34:11.916246 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04"
[0m00:34:11.916584 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04
[0m00:34:11.917778 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04"
[0m00:34:11.918097 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04"
[0m00:34:11.918236 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04: BEGIN
[0m00:34:11.918365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.918620 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.918801 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04"
[0m00:34:11.918956 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "jaffle_platform"."main"."orders"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.919430 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.920160 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04: ROLLBACK
[0m00:34:11.920411 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04'
[0m00:34:11.920555 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04: Close
[0m00:34:11.920817 [info ] [Thread-1 (]: 75 of 96 PASS not_null_orders_store_id ......................................... [[32mPASS[0m in 0.01s]
[0m00:34:11.921017 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04
[0m00:34:11.921160 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_orders_total_items_count.553bda7b77
[0m00:34:11.921362 [info ] [Thread-1 (]: 76 of 96 START test not_null_orders_total_items_count .......................... [RUN]
[0m00:34:11.921601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_orders_store_id.2bcd3b4d04, now test.jaffle_platform.not_null_orders_total_items_count.553bda7b77)
[0m00:34:11.921765 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_orders_total_items_count.553bda7b77
[0m00:34:11.923530 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_orders_total_items_count.553bda7b77"
[0m00:34:11.923826 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_orders_total_items_count.553bda7b77
[0m00:34:11.924840 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_orders_total_items_count.553bda7b77"
[0m00:34:11.925108 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_total_items_count.553bda7b77"
[0m00:34:11.925248 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_items_count.553bda7b77: BEGIN
[0m00:34:11.925385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.925627 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.925763 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_total_items_count.553bda7b77"
[0m00:34:11.925907 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_items_count.553bda7b77: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_orders_total_items_count.553bda7b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_items_count
from "jaffle_platform"."main"."orders"
where total_items_count is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.926293 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.927035 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_items_count.553bda7b77: ROLLBACK
[0m00:34:11.927251 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_orders_total_items_count.553bda7b77'
[0m00:34:11.927388 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_items_count.553bda7b77: Close
[0m00:34:11.927599 [info ] [Thread-1 (]: 76 of 96 PASS not_null_orders_total_items_count ................................ [[32mPASS[0m in 0.01s]
[0m00:34:11.927793 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_orders_total_items_count.553bda7b77
[0m00:34:11.927937 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60
[0m00:34:11.928136 [info ] [Thread-1 (]: 77 of 96 START test not_null_orders_total_profit ............................... [RUN]
[0m00:34:11.928369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_orders_total_items_count.553bda7b77, now test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60)
[0m00:34:11.928533 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60
[0m00:34:11.930224 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60"
[0m00:34:11.930641 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60
[0m00:34:11.931732 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60"
[0m00:34:11.932040 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60"
[0m00:34:11.932226 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60: BEGIN
[0m00:34:11.932363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.932621 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.932758 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60"
[0m00:34:11.932909 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_profit
from "jaffle_platform"."main"."orders"
where total_profit is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.933297 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.933963 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60: ROLLBACK
[0m00:34:11.934181 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60'
[0m00:34:11.934314 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60: Close
[0m00:34:11.934524 [info ] [Thread-1 (]: 77 of 96 PASS not_null_orders_total_profit ..................................... [[32mPASS[0m in 0.01s]
[0m00:34:11.934741 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60
[0m00:34:11.934906 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_orders_total_revenue.280ed887b4
[0m00:34:11.935093 [info ] [Thread-1 (]: 78 of 96 START test not_null_orders_total_revenue .............................. [RUN]
[0m00:34:11.935286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_orders_total_profit.b2d3d6fa60, now test.jaffle_platform.not_null_orders_total_revenue.280ed887b4)
[0m00:34:11.935437 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_orders_total_revenue.280ed887b4
[0m00:34:11.938195 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_orders_total_revenue.280ed887b4"
[0m00:34:11.938520 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_orders_total_revenue.280ed887b4
[0m00:34:11.939688 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_orders_total_revenue.280ed887b4"
[0m00:34:11.939956 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_total_revenue.280ed887b4"
[0m00:34:11.940091 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_revenue.280ed887b4: BEGIN
[0m00:34:11.940214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.940431 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.940564 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_orders_total_revenue.280ed887b4"
[0m00:34:11.940699 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_revenue.280ed887b4: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_orders_total_revenue.280ed887b4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from "jaffle_platform"."main"."orders"
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.941096 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.941901 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_revenue.280ed887b4: ROLLBACK
[0m00:34:11.942128 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_orders_total_revenue.280ed887b4'
[0m00:34:11.942261 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_orders_total_revenue.280ed887b4: Close
[0m00:34:11.942471 [info ] [Thread-1 (]: 78 of 96 PASS not_null_orders_total_revenue .................................... [[32mPASS[0m in 0.01s]
[0m00:34:11.942668 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_orders_total_revenue.280ed887b4
[0m00:34:11.942813 [debug] [Thread-1 (]: Began running node test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c
[0m00:34:11.943019 [info ] [Thread-1 (]: 79 of 96 START test relationships_orders_store_id__store_id__ref_stg_stores_ ... [RUN]
[0m00:34:11.943274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_orders_total_revenue.280ed887b4, now test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c)
[0m00:34:11.943446 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c
[0m00:34:11.945497 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c"
[0m00:34:11.945818 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c
[0m00:34:11.946981 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c"
[0m00:34:11.947298 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c"
[0m00:34:11.947439 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c: BEGIN
[0m00:34:11.947569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.947796 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.947929 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c"
[0m00:34:11.948075 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select store_id as from_field
    from "jaffle_platform"."main"."orders"
    where store_id is not null
),

parent as (
    select store_id as to_field
    from "jaffle_platform"."main"."stg_stores"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:34:11.950595 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:34:11.951397 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c: ROLLBACK
[0m00:34:11.951637 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c'
[0m00:34:11.951776 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c: Close
[0m00:34:11.952009 [info ] [Thread-1 (]: 79 of 96 PASS relationships_orders_store_id__store_id__ref_stg_stores_ ......... [[32mPASS[0m in 0.01s]
[0m00:34:11.952240 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c
[0m00:34:11.952400 [debug] [Thread-1 (]: Began running node test.jaffle_platform.unique_orders_order_id.fed79b3a6e
[0m00:34:11.952593 [info ] [Thread-1 (]: 80 of 96 START test unique_orders_order_id ..................................... [RUN]
[0m00:34:11.952799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.relationships_orders_store_id__store_id__ref_stg_stores_.9afa770d8c, now test.jaffle_platform.unique_orders_order_id.fed79b3a6e)
[0m00:34:11.952956 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.unique_orders_order_id.fed79b3a6e
[0m00:34:11.954662 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.unique_orders_order_id.fed79b3a6e"
[0m00:34:11.954987 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.unique_orders_order_id.fed79b3a6e
[0m00:34:11.956172 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.unique_orders_order_id.fed79b3a6e"
[0m00:34:11.956483 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_orders_order_id.fed79b3a6e"
[0m00:34:11.956621 [debug] [Thread-1 (]: On test.jaffle_platform.unique_orders_order_id.fed79b3a6e: BEGIN
[0m00:34:11.956755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.956973 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.957106 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_orders_order_id.fed79b3a6e"
[0m00:34:11.957242 [debug] [Thread-1 (]: On test.jaffle_platform.unique_orders_order_id.fed79b3a6e: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.unique_orders_order_id.fed79b3a6e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:34:11.969751 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m00:34:11.970556 [debug] [Thread-1 (]: On test.jaffle_platform.unique_orders_order_id.fed79b3a6e: ROLLBACK
[0m00:34:11.970812 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.unique_orders_order_id.fed79b3a6e'
[0m00:34:11.970951 [debug] [Thread-1 (]: On test.jaffle_platform.unique_orders_order_id.fed79b3a6e: Close
[0m00:34:11.971268 [info ] [Thread-1 (]: 80 of 96 PASS unique_orders_order_id ........................................... [[32mPASS[0m in 0.02s]
[0m00:34:11.971550 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.unique_orders_order_id.fed79b3a6e
[0m00:34:11.971986 [debug] [Thread-1 (]: Began running node model.jaffle_platform.customers
[0m00:34:11.972255 [info ] [Thread-1 (]: 81 of 96 START sql table model main.customers .................................. [RUN]
[0m00:34:11.972488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.unique_orders_order_id.fed79b3a6e, now model.jaffle_platform.customers)
[0m00:34:11.972632 [debug] [Thread-1 (]: Began compiling node model.jaffle_platform.customers
[0m00:34:11.975074 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_platform.customers"
[0m00:34:11.975432 [debug] [Thread-1 (]: Began executing node model.jaffle_platform.customers
[0m00:34:11.976877 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_platform.customers"
[0m00:34:11.977264 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.customers"
[0m00:34:11.977462 [debug] [Thread-1 (]: On model.jaffle_platform.customers: BEGIN
[0m00:34:11.977597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:11.977903 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.978041 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.customers"
[0m00:34:11.978236 [debug] [Thread-1 (]: On model.jaffle_platform.customers: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.customers"} */

  
    
    

    create  table
      "jaffle_platform"."main"."customers__dbt_tmp"
  
    as (
      with customers as (

    select * from "jaffle_platform"."main"."stg_customers"

),

orders as (

    select * from "jaffle_platform"."main"."orders"

),

customer_orders as (

    select
        customer_id,
        
        min(order_date) as first_order_at,
        max(order_date) as most_recent_order_at,
        count(*) as number_of_orders,

        sum(food_items_count) as total_food_items,
        sum(drink_items_count) as total_drink_items,
        sum(total_items_count) as total_items,

        
    round(1.0 * sum(food_revenue * 100) / 100, 2)
 as total_food_revenue,
        
    round(1.0 * sum(drink_revenue * 100) / 100, 2)
 as total_drink_revenue,
        
    round(1.0 * sum(total_revenue * 100) / 100, 2)
 as total_revenue,

        
    round(1.0 * sum(food_cost * 100) / 100, 2)
 as total_food_cost,
        
    round(1.0 * sum(drink_cost * 100) / 100, 2)
 as total_drink_cost,
        
    round(1.0 * sum(total_cost * 100) / 100, 2)
 as total_cost,

        
    round(1.0 * sum(food_profit * 100) / 100, 2)
 as total_food_profit,
        
    round(1.0 * sum(drink_profit * 100) / 100, 2)
 as total_drink_profit,
        
    round(1.0 * sum(total_profit * 100) / 100, 2)
 as total_profit,

        
    round(1.0 * sum(total_revenue * 100) / nullif(count(*), 0) / 100, 2)
 as avg_order_value,
        
    round(1.0 * sum(total_profit * 100) / nullif(count(*), 0) / 100, 2)
 as avg_order_profit

    from orders
    group by 1

),

joined as (

    select
        customers.customer_id,
        customers.customer_name,

        customer_orders.first_order_at,
        customer_orders.most_recent_order_at,
        customer_orders.number_of_orders,

        customer_orders.total_food_items,
        customer_orders.total_drink_items,
        customer_orders.total_items,

        customer_orders.total_food_revenue,
        customer_orders.total_drink_revenue,
        customer_orders.total_revenue,

        customer_orders.total_food_cost,
        customer_orders.total_drink_cost,
        customer_orders.total_cost,

        customer_orders.total_food_profit,
        customer_orders.total_drink_profit,
        customer_orders.total_profit,

        customer_orders.avg_order_value,
        customer_orders.avg_order_profit

    from customers

    left join customer_orders using (customer_id)

)

select * from joined
    );
  
  
[0m00:34:11.988058 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m00:34:11.990751 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.customers"
[0m00:34:11.990923 [debug] [Thread-1 (]: On model.jaffle_platform.customers: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.customers"} */
alter table "jaffle_platform"."main"."customers" rename to "customers__dbt_backup"
[0m00:34:11.991219 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.992393 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.customers"
[0m00:34:11.992549 [debug] [Thread-1 (]: On model.jaffle_platform.customers: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.customers"} */
alter table "jaffle_platform"."main"."customers__dbt_tmp" rename to "customers"
[0m00:34:11.992773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.993251 [debug] [Thread-1 (]: On model.jaffle_platform.customers: COMMIT
[0m00:34:11.993389 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.customers"
[0m00:34:11.993514 [debug] [Thread-1 (]: On model.jaffle_platform.customers: COMMIT
[0m00:34:11.994557 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:11.995914 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_platform.customers"
[0m00:34:11.996124 [debug] [Thread-1 (]: On model.jaffle_platform.customers: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "model.jaffle_platform.customers"} */
drop table if exists "jaffle_platform"."main"."customers__dbt_backup" cascade
[0m00:34:11.996541 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:11.997100 [debug] [Thread-1 (]: On model.jaffle_platform.customers: Close
[0m00:34:11.997347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb34dba-d935-4823-9de8-e70432cbbf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a368250>]}
[0m00:34:11.997622 [info ] [Thread-1 (]: 81 of 96 OK created sql table model main.customers ............................. [[32mOK[0m in 0.02s]
[0m00:34:11.997852 [debug] [Thread-1 (]: Finished running node model.jaffle_platform.customers
[0m00:34:11.998257 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c
[0m00:34:11.998446 [info ] [Thread-1 (]: 82 of 96 START test dbt_utils_accepted_range_customers_avg_order_value__0 ...... [RUN]
[0m00:34:11.998631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_platform.customers, now test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c)
[0m00:34:11.998786 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c
[0m00:34:12.000601 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c"
[0m00:34:12.000954 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c
[0m00:34:12.001939 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c"
[0m00:34:12.002214 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c"
[0m00:34:12.002362 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c: BEGIN
[0m00:34:12.002495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:12.002721 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.002878 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c"
[0m00:34:12.003037 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_order_value >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:12.003806 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:12.004438 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c: ROLLBACK
[0m00:34:12.004770 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c'
[0m00:34:12.004978 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c: Close
[0m00:34:12.005238 [info ] [Thread-1 (]: 82 of 96 PASS dbt_utils_accepted_range_customers_avg_order_value__0 ............ [[32mPASS[0m in 0.01s]
[0m00:34:12.005450 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c
[0m00:34:12.005605 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b
[0m00:34:12.005824 [info ] [Thread-1 (]: 83 of 96 START test dbt_utils_accepted_range_customers_number_of_orders__0 ..... [RUN]
[0m00:34:12.006059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_avg_order_value__0.c1c1601f2c, now test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b)
[0m00:34:12.006218 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b
[0m00:34:12.008018 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b"
[0m00:34:12.008334 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b
[0m00:34:12.009320 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b"
[0m00:34:12.009602 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b"
[0m00:34:12.009747 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b: BEGIN
[0m00:34:12.009895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:12.010182 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.010322 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b"
[0m00:34:12.010478 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not number_of_orders >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:12.011213 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:12.011849 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b: ROLLBACK
[0m00:34:12.012086 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b'
[0m00:34:12.012231 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b: Close
[0m00:34:12.012497 [info ] [Thread-1 (]: 83 of 96 PASS dbt_utils_accepted_range_customers_number_of_orders__0 ........... [[32mPASS[0m in 0.01s]
[0m00:34:12.012794 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b
[0m00:34:12.012952 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a
[0m00:34:12.013165 [info ] [Thread-1 (]: 84 of 96 START test dbt_utils_accepted_range_customers_total_cost__0 ........... [RUN]
[0m00:34:12.013404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_number_of_orders__0.037b1dd78b, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a)
[0m00:34:12.013547 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a
[0m00:34:12.015327 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a"
[0m00:34:12.015632 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a
[0m00:34:12.017662 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a"
[0m00:34:12.017939 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a"
[0m00:34:12.018073 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a: BEGIN
[0m00:34:12.018199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:12.018429 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.018555 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a"
[0m00:34:12.018704 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_cost >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:12.019363 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.020077 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a: ROLLBACK
[0m00:34:12.020316 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a'
[0m00:34:12.020448 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a: Close
[0m00:34:12.020664 [info ] [Thread-1 (]: 84 of 96 PASS dbt_utils_accepted_range_customers_total_cost__0 ................. [[32mPASS[0m in 0.01s]
[0m00:34:12.020861 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a
[0m00:34:12.021008 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f
[0m00:34:12.021161 [info ] [Thread-1 (]: 85 of 96 START test dbt_utils_accepted_range_customers_total_drink_cost__0 ..... [RUN]
[0m00:34:12.021348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_cost__0.0a4e71d80a, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f)
[0m00:34:12.021495 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f
[0m00:34:12.023107 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f"
[0m00:34:12.023370 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f
[0m00:34:12.024300 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f"
[0m00:34:12.024551 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f"
[0m00:34:12.024691 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f: BEGIN
[0m00:34:12.024819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:12.025032 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.025163 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f"
[0m00:34:12.025313 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_drink_cost >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:12.025916 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.026432 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f: ROLLBACK
[0m00:34:12.026626 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f'
[0m00:34:12.026763 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f: Close
[0m00:34:12.026961 [info ] [Thread-1 (]: 85 of 96 PASS dbt_utils_accepted_range_customers_total_drink_cost__0 ........... [[32mPASS[0m in 0.01s]
[0m00:34:12.027164 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f
[0m00:34:12.027318 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335
[0m00:34:12.027540 [info ] [Thread-1 (]: 86 of 96 START test dbt_utils_accepted_range_customers_total_drink_items__0 .... [RUN]
[0m00:34:12.027792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_cost__0.fa5c6d903f, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335)
[0m00:34:12.027962 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335
[0m00:34:12.029977 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335"
[0m00:34:12.030253 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335
[0m00:34:12.031391 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335"
[0m00:34:12.031655 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335"
[0m00:34:12.031793 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335: BEGIN
[0m00:34:12.031921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:12.032183 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.032382 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335"
[0m00:34:12.032552 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_drink_items >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:12.033361 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:12.033939 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335: ROLLBACK
[0m00:34:12.034134 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335'
[0m00:34:12.034269 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335: Close
[0m00:34:12.034472 [info ] [Thread-1 (]: 86 of 96 PASS dbt_utils_accepted_range_customers_total_drink_items__0 .......... [[32mPASS[0m in 0.01s]
[0m00:34:12.034664 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335
[0m00:34:12.034809 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4
[0m00:34:12.035029 [info ] [Thread-1 (]: 87 of 96 START test dbt_utils_accepted_range_customers_total_drink_revenue__0 .. [RUN]
[0m00:34:12.035258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_items__0.9997c8c335, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4)
[0m00:34:12.035424 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4
[0m00:34:12.037261 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4"
[0m00:34:12.037618 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4
[0m00:34:12.039044 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4"
[0m00:34:12.039393 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4"
[0m00:34:12.039538 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4: BEGIN
[0m00:34:12.039669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:12.039919 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.040121 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4"
[0m00:34:12.040299 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_drink_revenue >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:12.041013 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:12.041722 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4: ROLLBACK
[0m00:34:12.042000 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4'
[0m00:34:12.042157 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4: Close
[0m00:34:12.042406 [info ] [Thread-1 (]: 87 of 96 PASS dbt_utils_accepted_range_customers_total_drink_revenue__0 ........ [[32mPASS[0m in 0.01s]
[0m00:34:12.042641 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4
[0m00:34:12.042810 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802
[0m00:34:12.042995 [info ] [Thread-1 (]: 88 of 96 START test dbt_utils_accepted_range_customers_total_food_cost__0 ...... [RUN]
[0m00:34:12.043188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_drink_revenue__0.b99e7e96c4, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802)
[0m00:34:12.043350 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802
[0m00:34:12.045150 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802"
[0m00:34:12.045477 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802
[0m00:34:12.047746 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802"
[0m00:34:12.048058 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802"
[0m00:34:12.048195 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802: BEGIN
[0m00:34:12.048327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:12.048560 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.048711 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802"
[0m00:34:12.048866 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_food_cost >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:12.049521 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.050077 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802: ROLLBACK
[0m00:34:12.050290 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802'
[0m00:34:12.050431 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802: Close
[0m00:34:12.050634 [info ] [Thread-1 (]: 88 of 96 PASS dbt_utils_accepted_range_customers_total_food_cost__0 ............ [[32mPASS[0m in 0.01s]
[0m00:34:12.050830 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802
[0m00:34:12.050975 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc
[0m00:34:12.051176 [info ] [Thread-1 (]: 89 of 96 START test dbt_utils_accepted_range_customers_total_food_items__0 ..... [RUN]
[0m00:34:12.051391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_cost__0.c65392d802, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc)
[0m00:34:12.051555 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc
[0m00:34:12.053257 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc"
[0m00:34:12.053582 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc
[0m00:34:12.054672 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc"
[0m00:34:12.054958 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc"
[0m00:34:12.055097 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc: BEGIN
[0m00:34:12.055230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:12.055442 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.055580 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc"
[0m00:34:12.055736 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_food_items >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:12.056391 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.057173 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc: ROLLBACK
[0m00:34:12.057415 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc'
[0m00:34:12.057565 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc: Close
[0m00:34:12.057852 [info ] [Thread-1 (]: 89 of 96 PASS dbt_utils_accepted_range_customers_total_food_items__0 ........... [[32mPASS[0m in 0.01s]
[0m00:34:12.058067 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc
[0m00:34:12.058220 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11
[0m00:34:12.058434 [info ] [Thread-1 (]: 90 of 96 START test dbt_utils_accepted_range_customers_total_food_revenue__0 ... [RUN]
[0m00:34:12.058683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_items__0.828da3e8bc, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11)
[0m00:34:12.058855 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11
[0m00:34:12.060506 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11"
[0m00:34:12.060827 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11
[0m00:34:12.061842 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11"
[0m00:34:12.062124 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11"
[0m00:34:12.062283 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11: BEGIN
[0m00:34:12.062415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:12.062693 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.062894 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11"
[0m00:34:12.063072 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_food_revenue >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:12.063789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:12.064391 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11: ROLLBACK
[0m00:34:12.064607 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11'
[0m00:34:12.064748 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11: Close
[0m00:34:12.064968 [info ] [Thread-1 (]: 90 of 96 PASS dbt_utils_accepted_range_customers_total_food_revenue__0 ......... [[32mPASS[0m in 0.01s]
[0m00:34:12.065170 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11
[0m00:34:12.065323 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a
[0m00:34:12.065541 [info ] [Thread-1 (]: 91 of 96 START test dbt_utils_accepted_range_customers_total_items__0 .......... [RUN]
[0m00:34:12.065763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_food_revenue__0.3e10988d11, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a)
[0m00:34:12.065927 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a
[0m00:34:12.067856 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a"
[0m00:34:12.068206 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a
[0m00:34:12.069290 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a"
[0m00:34:12.069630 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a"
[0m00:34:12.069805 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a: BEGIN
[0m00:34:12.069936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:12.070164 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.070299 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a"
[0m00:34:12.070465 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_items >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:12.071154 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.071780 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a: ROLLBACK
[0m00:34:12.072004 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a'
[0m00:34:12.072150 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a: Close
[0m00:34:12.072388 [info ] [Thread-1 (]: 91 of 96 PASS dbt_utils_accepted_range_customers_total_items__0 ................ [[32mPASS[0m in 0.01s]
[0m00:34:12.072605 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a
[0m00:34:12.072768 [debug] [Thread-1 (]: Began running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785
[0m00:34:12.073006 [info ] [Thread-1 (]: 92 of 96 START test dbt_utils_accepted_range_customers_total_revenue__0 ........ [RUN]
[0m00:34:12.073261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_items__0.3d7b0a080a, now test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785)
[0m00:34:12.073433 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785
[0m00:34:12.075188 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785"
[0m00:34:12.075490 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785
[0m00:34:12.076507 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785"
[0m00:34:12.076879 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785"
[0m00:34:12.077046 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785: BEGIN
[0m00:34:12.077172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:12.077403 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.077539 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785"
[0m00:34:12.077698 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "jaffle_platform"."main"."customers"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_revenue >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m00:34:12.078351 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.079091 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785: ROLLBACK
[0m00:34:12.079346 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785'
[0m00:34:12.079609 [debug] [Thread-1 (]: On test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785: Close
[0m00:34:12.079885 [info ] [Thread-1 (]: 92 of 96 PASS dbt_utils_accepted_range_customers_total_revenue__0 .............. [[32mPASS[0m in 0.01s]
[0m00:34:12.080105 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785
[0m00:34:12.080256 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d
[0m00:34:12.080455 [info ] [Thread-1 (]: 93 of 96 START test not_null_customers_customer_id ............................. [RUN]
[0m00:34:12.080685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.dbt_utils_accepted_range_customers_total_revenue__0.217c0fc785, now test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d)
[0m00:34:12.080846 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d
[0m00:34:12.083802 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d"
[0m00:34:12.084144 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d
[0m00:34:12.085148 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d"
[0m00:34:12.085457 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d"
[0m00:34:12.085629 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d: BEGIN
[0m00:34:12.085887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:12.086193 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.086338 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d"
[0m00:34:12.086478 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "jaffle_platform"."main"."customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m00:34:12.086927 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.087609 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
[0m00:34:12.087886 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d'
[0m00:34:12.088072 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d: Close
[0m00:34:12.088362 [info ] [Thread-1 (]: 93 of 96 PASS not_null_customers_customer_id ................................... [[32mPASS[0m in 0.01s]
[0m00:34:12.088594 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d
[0m00:34:12.088757 [debug] [Thread-1 (]: Began running node test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065
[0m00:34:12.088975 [info ] [Thread-1 (]: 94 of 96 START test not_null_customers_customer_name ........................... [RUN]
[0m00:34:12.089208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_customers_customer_id.5c9bf9911d, now test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065)
[0m00:34:12.089369 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065
[0m00:34:12.091067 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065"
[0m00:34:12.091365 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065
[0m00:34:12.092411 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065"
[0m00:34:12.092699 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065"
[0m00:34:12.092844 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065: BEGIN
[0m00:34:12.092974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:12.093214 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.093349 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065"
[0m00:34:12.093493 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_name
from "jaffle_platform"."main"."customers"
where customer_name is null



  
  
      
    ) dbt_internal_test
[0m00:34:12.094019 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.094613 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065: ROLLBACK
[0m00:34:12.094839 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065'
[0m00:34:12.094978 [debug] [Thread-1 (]: On test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065: Close
[0m00:34:12.095206 [info ] [Thread-1 (]: 94 of 96 PASS not_null_customers_customer_name ................................. [[32mPASS[0m in 0.01s]
[0m00:34:12.095419 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065
[0m00:34:12.095581 [debug] [Thread-1 (]: Began running node test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:34:12.095747 [info ] [Thread-1 (]: 95 of 96 START test relationships_orders_customer_id__customer_id__ref_customers_  [RUN]
[0m00:34:12.095948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.not_null_customers_customer_name.2bf8eaa065, now test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2)
[0m00:34:12.096149 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:34:12.098552 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:34:12.098874 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:34:12.099877 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:34:12.100156 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:34:12.100297 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: BEGIN
[0m00:34:12.100425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:12.100695 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.100838 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m00:34:12.100992 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "jaffle_platform"."main"."orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "jaffle_platform"."main"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:34:12.104352 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:34:12.104982 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: ROLLBACK
[0m00:34:12.105196 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2'
[0m00:34:12.105332 [debug] [Thread-1 (]: On test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: Close
[0m00:34:12.105547 [info ] [Thread-1 (]: 95 of 96 PASS relationships_orders_customer_id__customer_id__ref_customers_ .... [[32mPASS[0m in 0.01s]
[0m00:34:12.105759 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m00:34:12.105908 [debug] [Thread-1 (]: Began running node test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1
[0m00:34:12.106151 [info ] [Thread-1 (]: 96 of 96 START test unique_customers_customer_id ............................... [RUN]
[0m00:34:12.106441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_platform.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2, now test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1)
[0m00:34:12.106644 [debug] [Thread-1 (]: Began compiling node test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1
[0m00:34:12.108305 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1"
[0m00:34:12.108567 [debug] [Thread-1 (]: Began executing node test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1
[0m00:34:12.109560 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1"
[0m00:34:12.109812 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1"
[0m00:34:12.109946 [debug] [Thread-1 (]: On test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1: BEGIN
[0m00:34:12.110074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:12.110289 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:12.110419 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1"
[0m00:34:12.110567 [debug] [Thread-1 (]: On test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "local", "target_name": "prod", "node_id": "test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "jaffle_platform"."main"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:34:12.111458 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:12.112204 [debug] [Thread-1 (]: On test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
[0m00:34:12.112461 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1'
[0m00:34:12.112659 [debug] [Thread-1 (]: On test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1: Close
[0m00:34:12.113029 [info ] [Thread-1 (]: 96 of 96 PASS unique_customers_customer_id ..................................... [[32mPASS[0m in 0.01s]
[0m00:34:12.113270 [debug] [Thread-1 (]: Finished running node test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1
[0m00:34:12.113918 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:12.114081 [debug] [MainThread]: On master: BEGIN
[0m00:34:12.114201 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:34:12.114469 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:34:12.114601 [debug] [MainThread]: On master: COMMIT
[0m00:34:12.114718 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:12.114830 [debug] [MainThread]: On master: COMMIT
[0m00:34:12.114990 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:34:12.115102 [debug] [MainThread]: On master: Close
[0m00:34:12.115254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:12.115364 [debug] [MainThread]: Connection 'test.jaffle_platform.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m00:34:12.115549 [info ] [MainThread]: 
[0m00:34:12.115692 [info ] [MainThread]: Finished running 5 table models, 85 data tests, 6 view models in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m00:34:12.119679 [debug] [MainThread]: Command end result
[0m00:34:12.143954 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/thomastrividic/code/python/jaffle-platform/dbt/target/manifest.json
[0m00:34:12.144969 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/thomastrividic/code/python/jaffle-platform/dbt/target/semantic_manifest.json
[0m00:34:12.149185 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/thomastrividic/code/python/jaffle-platform/dbt/target/run_results.json
[0m00:34:12.149364 [info ] [MainThread]: 
[0m00:34:12.149543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:34:12.149712 [info ] [MainThread]: 
[0m00:34:12.149850 [info ] [MainThread]: Done. PASS=96 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=96
[0m00:34:12.150188 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.0185914, "process_in_blocks": "0", "process_kernel_time": 0.579908, "process_mem_max_rss": "814530560", "process_out_blocks": "0", "process_user_time": 5.717362}
[0m00:34:12.150381 [debug] [MainThread]: Command `dbt build` succeeded at 00:34:12.150348 after 4.02 seconds
[0m00:34:12.150537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109358f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109359c90>]}
[0m00:34:12.150695 [debug] [MainThread]: Flushing usage events
[0m00:34:12.593380 [debug] [MainThread]: An error was encountered while trying to flush usage events
